module.exports=[77156,a=>{"use strict";let b=(0,a.i(70106).default)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);a.s(["Eye",()=>b],77156)},87532,a=>{"use strict";let b=(0,a.i(70106).default)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]);a.s(["Search",()=>b],87532)},41710,a=>{"use strict";let b=(0,a.i(70106).default)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);a.s(["Clock",()=>b],41710)},90166,a=>{"use strict";let b=(0,a.i(70106).default)("dollar-sign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);a.s(["DollarSign",()=>b],90166)},16201,a=>{"use strict";let b=(0,a.i(70106).default)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);a.s(["CheckCircle",()=>b],16201)},62722,a=>{"use strict";let b=(0,a.i(70106).default)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);a.s(["XCircle",()=>b],62722)},33170,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(38246),e=a.i(90166),f=a.i(81010),g=a.i(48464),h=a.i(79161),i=a.i(83497),j=a.i(77156),k=a.i(87532),l=a.i(70106);let m=(0,l.default)("arrow-up-right",[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]]),n=(0,l.default)("arrow-down-right",[["path",{d:"m7 7 10 10",key:"1fmybs"}],["path",{d:"M17 7v10H7",key:"6fjiku"}]]);var o=a.i(16201),p=a.i(41710),q=a.i(62722);let r=(0,l.default)("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);var s=a.i(99570),t=a.i(91119),u=a.i(63672);function v(){let a,[l,v]=(0,c.useState)(null),[w,x]=(0,c.useState)([]),[y,z]=(0,c.useState)(!0),[A,B]=(0,c.useState)(""),[C,D]=(0,c.useState)("all"),[E,F]=(0,c.useState)("all");(0,c.useEffect)(()=>{G()},[]);let G=async()=>{try{let a=await (0,u.getCurrentUser)();if(!a){window.location.href="/auth/login";return}v(a);let{data:b,error:c}=await u.supabase.from("transactions").select(`
          *,
          listings(id, title, category),
          buyer:users!transactions_buyer_id_fkey(email, full_name),
          seller:users!transactions_seller_id_fkey(email, full_name)
        `).or(`buyer_id.eq.${a.id},seller_id.eq.${a.id}`).order("created_at",{ascending:!1});if(c)throw c;x(b||[])}catch(a){console.error("Error fetching transactions:",a)}finally{z(!1)}},H=w.filter(a=>{let b=a.listings?.title?.toLowerCase().includes(A.toLowerCase())||a.buyer?.full_name?.toLowerCase().includes(A.toLowerCase())||a.seller?.full_name?.toLowerCase().includes(A.toLowerCase()),c="all"===C||a.status===C,d=a.buyer_id===l?.id,e=a.seller_id===l?.id,f="all"===E||"buyer"===E&&d||"seller"===E&&e;return b&&c&&f}),{totalSpent:I,totalEarned:J}={totalSpent:(a=H.filter(a=>"completed"===a.status)).filter(a=>a.buyer_id===l?.id).reduce((a,b)=>a+b.amount,0),totalEarned:a.filter(a=>a.seller_id===l?.id).reduce((a,b)=>a+(b.amount-b.commission_amount),0)};return y?(0,b.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-red-600 mx-auto"}),(0,b.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading your transactions..."})]})}):(0,b.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,b.jsx)("div",{className:"bg-white border-b border-gray-200",children:(0,b.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:(0,b.jsx)("div",{className:"flex items-center justify-between",children:(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Transactions"}),(0,b.jsx)("p",{className:"text-gray-600 mt-1",children:"Track your buying and selling activities"})]})})})}),(0,b.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[(0,b.jsx)(t.Card,{children:(0,b.jsx)(t.CardContent,{className:"p-6",children:(0,b.jsxs)("div",{className:"flex items-center",children:[(0,b.jsx)("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:(0,b.jsx)(e.DollarSign,{className:"h-4 w-4 text-blue-600"})}),(0,b.jsxs)("div",{className:"ml-4",children:[(0,b.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Total Transactions"}),(0,b.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:H.length})]})]})})}),(0,b.jsx)(t.Card,{children:(0,b.jsx)(t.CardContent,{className:"p-6",children:(0,b.jsxs)("div",{className:"flex items-center",children:[(0,b.jsx)("div",{className:"w-8 h-8 bg-red-100 rounded-lg flex items-center justify-center",children:(0,b.jsx)(m,{className:"h-4 w-4 text-red-600"})}),(0,b.jsxs)("div",{className:"ml-4",children:[(0,b.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Total Spent"}),(0,b.jsxs)("p",{className:"text-2xl font-bold text-gray-900",children:["RWF ",I.toLocaleString()]})]})]})})}),(0,b.jsx)(t.Card,{children:(0,b.jsx)(t.CardContent,{className:"p-6",children:(0,b.jsxs)("div",{className:"flex items-center",children:[(0,b.jsx)("div",{className:"w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center",children:(0,b.jsx)(n,{className:"h-4 w-4 text-green-600"})}),(0,b.jsxs)("div",{className:"ml-4",children:[(0,b.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Total Earned"}),(0,b.jsxs)("p",{className:"text-2xl font-bold text-gray-900",children:["RWF ",J.toLocaleString()]})]})]})})})]}),(0,b.jsx)(t.Card,{className:"mb-6",children:(0,b.jsx)(t.CardContent,{className:"p-4",children:(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,b.jsx)("div",{className:"flex-1",children:(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(k.Search,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),(0,b.jsx)("input",{type:"text",placeholder:"Search transactions...",value:A,onChange:a=>B(a.target.value),className:"pl-10 w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500"})]})}),(0,b.jsxs)("select",{value:C,onChange:a=>D(a.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500","aria-label":"Filter by status",children:[(0,b.jsx)("option",{value:"all",children:"All Status"}),(0,b.jsx)("option",{value:"pending",children:"Pending"}),(0,b.jsx)("option",{value:"completed",children:"Completed"}),(0,b.jsx)("option",{value:"cancelled",children:"Cancelled"}),(0,b.jsx)("option",{value:"disputed",children:"Disputed"})]}),(0,b.jsxs)("select",{value:E,onChange:a=>F(a.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500","aria-label":"Filter by type",children:[(0,b.jsx)("option",{value:"all",children:"All Types"}),(0,b.jsx)("option",{value:"buyer",children:"As Buyer"}),(0,b.jsx)("option",{value:"seller",children:"As Seller"})]})]})})}),0===H.length?(0,b.jsx)(t.Card,{children:(0,b.jsxs)(t.CardContent,{className:"p-16 text-center",children:[(0,b.jsx)(e.DollarSign,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),(0,b.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:A||"all"!==C||"all"!==E?"No matching transactions":"No transactions yet"}),(0,b.jsx)("p",{className:"text-gray-600 mb-6",children:A||"all"!==C||"all"!==E?"Try adjusting your filters or search terms":"Your transaction history will appear here once you start buying or selling"}),!A&&"all"===C&&"all"===E&&(0,b.jsx)(d.default,{href:"/listings",children:(0,b.jsx)(s.Button,{className:"bg-red-600 hover:bg-red-700",children:"Browse Listings"})})]})}):(0,b.jsx)("div",{className:"space-y-4",children:H.map(a=>{let c=a.buyer_id===l?.id,e=a.seller_id===l?.id;return(0,b.jsx)(t.Card,{className:"hover:shadow-md transition-shadow",children:(0,b.jsxs)(t.CardContent,{className:"p-6",children:[(0,b.jsx)("div",{className:"flex items-start justify-between",children:(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsxs)("div",{className:"flex items-center mb-3",children:[(a=>{switch(a){case"houses":return(0,b.jsx)(f.Home,{className:"h-4 w-4"});case"cars":return(0,b.jsx)(g.Car,{className:"h-4 w-4"});case"land":return(0,b.jsx)(h.Trees,{className:"h-4 w-4"});default:return(0,b.jsx)(i.Package,{className:"h-4 w-4"})}})(a.listings?.category),(0,b.jsx)("span",{className:"ml-2 font-medium text-gray-900 text-lg",children:a.listings?.title||"Transaction"}),(0,b.jsxs)("span",{className:`ml-3 px-2 py-1 text-xs rounded-full flex items-center gap-1 ${(a=>{switch(a){case"completed":return"bg-green-100 text-green-800";case"pending":return"bg-yellow-100 text-yellow-800";case"cancelled":return"bg-red-100 text-red-800";case"disputed":return"bg-orange-100 text-orange-800";default:return"bg-gray-100 text-gray-800"}})(a.status)}`,children:[(a=>{switch(a){case"completed":return(0,b.jsx)(o.CheckCircle,{className:"h-4 w-4"});case"pending":default:return(0,b.jsx)(p.Clock,{className:"h-4 w-4"});case"cancelled":return(0,b.jsx)(q.XCircle,{className:"h-4 w-4"});case"disputed":return(0,b.jsx)(r,{className:"h-4 w-4"})}})(a.status),a.status]}),(0,b.jsx)("span",{className:`ml-2 px-2 py-1 text-xs rounded-full ${c?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"}`,children:c?"Buyer":"Seller"})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("p",{className:"text-sm text-gray-600 mb-1",children:[(0,b.jsx)("strong",{children:"Amount:"})," RWF ",a.amount.toLocaleString()]}),(0,b.jsxs)("p",{className:"text-sm text-gray-600",children:[(0,b.jsx)("strong",{children:"Commission:"})," RWF ",a.commission_amount.toLocaleString()]})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("p",{className:"text-sm text-gray-600 mb-1",children:[(0,b.jsxs)("strong",{children:[c?"Seller":"Buyer",":"]})," ",c?a.seller?.full_name||a.seller?.email:a.buyer?.full_name||a.buyer?.email]}),(0,b.jsxs)("p",{className:"text-sm text-gray-600",children:[(0,b.jsx)("strong",{children:"Date:"})," ",new Date(a.created_at).toLocaleDateString()]})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("p",{className:"text-sm text-gray-600 mb-1",children:[(0,b.jsx)("strong",{children:"Payment Method:"})," ",a.payment_method||"Not specified"]}),(0,b.jsxs)("p",{className:"text-sm text-gray-600",children:[(0,b.jsx)("strong",{children:"Transaction Date:"})," ",a.transaction_date?new Date(a.transaction_date).toLocaleDateString():"Not completed"]})]})]}),e&&(0,b.jsx)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3",children:(0,b.jsxs)("p",{className:"text-sm font-medium text-green-800",children:["You will receive: RWF ",(a.amount-a.commission_amount).toLocaleString()]})})]})}),(0,b.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,b.jsx)(d.default,{href:`/listings/${a.listings?.category}/${a.listings?.id}`,children:(0,b.jsxs)(s.Button,{size:"sm",variant:"outline",children:[(0,b.jsx)(j.Eye,{className:"h-4 w-4 mr-1"}),"View Listing"]})}),"pending"===a.status&&(0,b.jsxs)(s.Button,{size:"sm",className:"bg-yellow-600 hover:bg-yellow-700",children:[(0,b.jsx)(p.Clock,{className:"h-4 w-4 mr-1"}),"Complete Payment"]})]})]})},a.id)})})]})]})}a.s(["default",()=>v],33170)}];

//# sourceMappingURL=_843a5218._.js.map