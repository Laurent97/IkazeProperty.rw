module.exports=[56355,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(38246),e=a.i(87532),f=a.i(69012),g=a.i(24987),h=a.i(79161);let i=(0,a.i(70106).default)("ruler",[["path",{d:"M21.3 15.3a2.4 2.4 0 0 1 0 3.4l-2.6 2.6a2.4 2.4 0 0 1-3.4 0L2.7 8.7a2.41 2.41 0 0 1 0-3.4l2.6-2.6a2.41 2.41 0 0 1 3.4 0Z",key:"icamh8"}],["path",{d:"m14.5 12.5 2-2",key:"inckbg"}],["path",{d:"m11.5 9.5 2-2",key:"fmmyf7"}],["path",{d:"m8.5 6.5 2-2",key:"vc6u1g"}],["path",{d:"m17.5 15.5 2-2",key:"wo5hmg"}]]);var j=a.i(76472),k=a.i(77156),l=a.i(99570),m=a.i(91119),n=a.i(68982);function o(){let[o,p]=(0,c.useState)(""),[q,r]=(0,c.useState)({min:"",max:""}),[s,t]=(0,c.useState)({min:"",max:""}),[u,v]=(0,c.useState)(""),[w,x]=(0,c.useState)(""),[y,z]=(0,c.useState)([]),[A,B]=(0,c.useState)(!0),[C,D]=(0,c.useState)(""),E=async()=>{try{B(!0);let{supabaseClient:b}=await a.A(53215);console.log("Starting to fetch land listings...");let{data:c,error:d}=await b.from("listings").select("*").eq("category","land").eq("status","available").order("created_at",{ascending:!1}).limit(50);if(d){console.error("Error fetching basic listings:",d),D(`Failed to load listings: ${d.message}`);return}if(console.log(`Found ${c?.length||0} listings`),!c||0===c.length)return void z([]);let e=c.map(a=>a.id),[{data:f,error:g},{data:h,error:i},{data:j,error:k}]=await Promise.all([b.from("users").select("id, full_name, email, avatar_url, phone_number, verified").in("id",c.map(a=>a.seller_id)),b.from("listing_media").select("id, listing_id, url, public_id, media_type, order_index, is_primary").in("listing_id",e).order("order_index"),b.from("land_details").select("*").in("listing_id",e)]);g&&console.error("Error fetching sellers:",g),i&&console.error("Error fetching media:",i),k&&console.error("Error fetching land details:",k);let{data:l}=await b.from("listing_promotions").select("listing_id, status, expires_at").in("listing_id",e).eq("status","active").gt("expires_at",new Date().toISOString()),m=c.map(a=>{let b=f?.find(b=>b.id===a.seller_id),c=h?.filter(b=>b.listing_id===a.id)||[],d=j?.find(b=>b.listing_id===a.id),e=l?.some(b=>b.listing_id===a.id);return{...a,seller:b||null,media:c||[],land_details:d||void 0,promoted:e||a.promoted}});console.log("Successfully combined data for",m.length,"listings"),z(m)}catch(a){console.error("Error in fetchListings:",a),D(`Failed to load listings: ${a?.message||"Unknown error"}`)}finally{B(!1)}};(0,c.useEffect)(()=>{E()},[]);let F=a=>{if(!a)return"Location not specified";if("string"==typeof a)return a;if("object"==typeof a)try{"string"==typeof a&&(a=JSON.parse(a));let b=a;return b?.district||b?.sector||b?.cell||b?.village||b?.city||b?.province||b?.address||"Location not specified"}catch(a){console.log("Error parsing location:",a)}return"Location not specified"},G=y.filter(a=>{let b=a.title.toLowerCase().includes(o.toLowerCase())||F(a.location).toLowerCase().includes(o.toLowerCase()),c=a.price||0,d=parseInt(q.min)||0,e=parseInt(q.max)||1/0,f=(!q.min||c>=d)&&(!q.max||c<=e),g=a.land_details?.plot_size||0,h=parseInt(s.min)||0,i=parseInt(s.max)||1/0,j=(!s.min||g>=h)&&(!s.max||g<=i),k=!u||a.land_details?.plot_type===u,l=!w||a.land_details?.road_access===w;return b&&f&&j&&k&&l});return A?(0,b.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-red-600 mx-auto mb-4"}),(0,b.jsx)("p",{className:"text-gray-600",children:"Loading land listings..."})]})}):C?(0,b.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:"text-red-600 text-6xl mb-4",children:"⚠️"}),(0,b.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Unable to load listings"}),(0,b.jsx)("p",{className:"text-gray-600 mb-4",children:C}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("p",{className:"text-sm text-gray-500",children:"Common issues:"}),(0,b.jsxs)("ul",{className:"text-sm text-gray-500 list-disc list-inside",children:[(0,b.jsx)("li",{children:"Check your Supabase connection"}),(0,b.jsx)("li",{children:"Verify you have land listings in your database"}),(0,b.jsx)("li",{children:"Ensure RLS policies allow reading listings"})]})]}),(0,b.jsx)(l.Button,{onClick:E,className:"mt-4 bg-red-600 hover:bg-red-700",children:"Try Again"})]})}):(0,b.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,b.jsx)("div",{className:"bg-white border-b border-gray-200",children:(0,b.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("h1",{className:"text-3xl font-bold text-gray-900 flex items-center",children:[(0,b.jsx)(h.Trees,{className:"h-8 w-8 mr-3 text-red-600"}),"Land & Plots"]}),(0,b.jsxs)("p",{className:"text-gray-600 mt-2",children:["Find the perfect plot from ",y.length," available listings"]})]}),(0,b.jsx)(d.default,{href:"/create-listing?category=land",children:(0,b.jsx)(l.Button,{className:"bg-red-600 hover:bg-red-700",children:"List Your Land"})})]})})}),(0,b.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:(0,b.jsxs)("div",{className:"flex flex-col lg:flex-row gap-8",children:[(0,b.jsx)("div",{className:"lg:w-80",children:(0,b.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[(0,b.jsxs)("div",{className:"flex items-center mb-4",children:[(0,b.jsx)(f.Filter,{className:"h-5 w-5 mr-2 text-gray-600"}),(0,b.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Filters"})]}),(0,b.jsxs)("div",{className:"mb-6",children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Search"}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(e.Search,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),(0,b.jsx)("input",{type:"text",value:o,onChange:a=>p(a.target.value),placeholder:"Search by title or location...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500"})]})]}),(0,b.jsxs)("div",{className:"mb-6",children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Plot Type"}),(0,b.jsxs)("select",{value:u,onChange:a=>v(a.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500",children:[(0,b.jsx)("option",{value:"",children:"All Types"}),(0,b.jsx)("option",{value:"residential",children:"Residential"}),(0,b.jsx)("option",{value:"commercial",children:"Commercial"}),(0,b.jsx)("option",{value:"agricultural",children:"Agricultural"}),(0,b.jsx)("option",{value:"industrial",children:"Industrial"}),(0,b.jsx)("option",{value:"mixed_use",children:"Mixed Use"})]})]}),(0,b.jsxs)("div",{className:"mb-6",children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Price Range (RWF)"}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)("input",{type:"number",value:q.min,onChange:a=>r({...q,min:a.target.value}),placeholder:"Min",min:"0",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500"}),(0,b.jsx)("input",{type:"number",value:q.max,onChange:a=>r({...q,max:a.target.value}),placeholder:"Max",min:"0",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500"})]})]}),(0,b.jsxs)("div",{className:"mb-6",children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Size Range (m²)"}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)("input",{type:"number",value:s.min,onChange:a=>t({...s,min:a.target.value}),placeholder:"Min",min:"0",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500"}),(0,b.jsx)("input",{type:"number",value:s.max,onChange:a=>t({...s,max:a.target.value}),placeholder:"Max",min:"0",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500"})]})]}),(0,b.jsxs)("div",{className:"mb-6",children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Road Access"}),(0,b.jsxs)("select",{value:w,onChange:a=>x(a.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500",children:[(0,b.jsx)("option",{value:"",children:"Any Access"}),(0,b.jsx)("option",{value:"tarmac",children:"Tarmac"}),(0,b.jsx)("option",{value:"murram",children:"Murram"}),(0,b.jsx)("option",{value:"gravel",children:"Gravel"}),(0,b.jsx)("option",{value:"footpath",children:"Footpath"}),(0,b.jsx)("option",{value:"none",children:"None"})]})]}),(0,b.jsx)(l.Button,{variant:"outline",className:"w-full border-red-600 text-red-600 hover:bg-red-50",onClick:()=>{p(""),r({min:"",max:""}),t({min:"",max:""}),v(""),x("")},children:"Clear All Filters"})]})}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,b.jsxs)("p",{className:"text-gray-600",children:["Showing ",G.length," of ",y.length," plots"]}),(0,b.jsx)("div",{className:"text-sm text-gray-500",children:0===G.length?"No results found":"Sorted by: Newest"})]}),G.length>0?(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:G.map(a=>{var c,e,f;let o=(c=a.media)&&0!==c.length?c.find(a=>a.is_primary)||c[0]:null;return(0,b.jsxs)(m.Card,{className:"hover:shadow-lg transition-shadow group",children:[(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("div",{className:"w-full h-48 bg-gray-200 rounded-t-lg overflow-hidden",children:o?(0,b.jsx)("img",{src:o.url,alt:a.title,className:"w-full h-full object-cover transition-transform group-hover:scale-105",onError:a=>{a.target.src="https://via.placeholder.com/400x300/cccccc/969696?text=Land+Plot"}}):(0,b.jsx)("div",{className:"w-full h-full flex items-center justify-center bg-gradient-to-br from-gray-100 to-gray-200",children:(0,b.jsx)(h.Trees,{className:"h-16 w-16 text-gray-400"})})}),a.featured&&(0,b.jsx)("div",{className:"absolute top-2 left-2 bg-red-600 text-white px-2 py-1 rounded text-xs font-semibold",children:"FEATURED"}),a.promoted&&(0,b.jsx)("div",{className:"absolute top-2 right-2 bg-yellow-500 text-white px-2 py-1 rounded text-xs font-semibold",children:"PROMOTED"}),a.land_details?.plot_type&&(0,b.jsx)("div",{className:"absolute bottom-2 left-2 bg-white/90 backdrop-blur-sm px-2 py-1 rounded text-xs font-semibold capitalize",children:a.land_details.plot_type})]}),(0,b.jsxs)(m.CardContent,{className:"p-4",children:[(0,b.jsx)("h3",{className:"font-semibold text-gray-900 mb-2 line-clamp-2",children:a.title}),(0,b.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,b.jsxs)("span",{className:"text-2xl font-bold text-red-600",children:[a.currency," ",a.price?.toLocaleString()||"Price on request"]}),a.price_type&&"fixed"!==a.price_type&&(0,b.jsx)("span",{className:"text-sm text-gray-600 capitalize",children:a.price_type})]}),(0,b.jsxs)("p",{className:"text-gray-600 text-sm mb-3 flex items-center",children:[(0,b.jsx)(g.MapPin,{className:"h-4 w-4 mr-1 flex-shrink-0"}),(0,b.jsx)("span",{className:"truncate",children:F(a.location)})]}),(0,b.jsx)(n.default,{className:"mb-4"}),(0,b.jsxs)("div",{className:"flex items-center space-x-4 text-sm text-gray-600 mb-4",children:[(0,b.jsxs)("div",{className:"flex items-center",children:[(0,b.jsx)(i,{className:"h-4 w-4 mr-1"}),(e=a.land_details?.plot_size,f=a.land_details?.size_unit,e?"m²"===f&&e>=1e4?`${(e/1e4).toFixed(1)} hectares`:`${e.toLocaleString()} ${f||"m²"}`:"Size not specified")]}),a.land_details?.road_access&&(0,b.jsxs)("div",{className:"flex items-center",children:[(0,b.jsx)("span",{className:`w-2 h-2 rounded-full mr-1 ${"tarmac"===a.land_details.road_access?"bg-green-500":"murram"===a.land_details.road_access?"bg-yellow-500":"gravel"===a.land_details.road_access?"bg-amber-500":"bg-gray-500"}`}),(0,b.jsx)("span",{className:"capitalize",children:a.land_details.road_access})]})]}),(0,b.jsxs)("div",{className:"flex flex-wrap gap-2 mb-4",children:[a.land_details?.shape&&(0,b.jsx)("span",{className:"bg-gray-100 text-gray-800 text-xs px-2 py-1 rounded capitalize",children:a.land_details.shape}),a.land_details?.fenced&&(0,b.jsx)("span",{className:"bg-green-100 text-green-800 text-xs px-2 py-1 rounded",children:"Fenced"}),a.land_details?.surveyed&&(0,b.jsx)("span",{className:"bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded",children:"Surveyed"}),a.transaction_type&&(0,b.jsxs)("span",{className:"bg-amber-100 text-amber-800 text-xs px-2 py-1 rounded capitalize",children:["For ",a.transaction_type]})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between pt-4 border-t",children:[(0,b.jsxs)("div",{className:"flex items-center space-x-3 text-sm text-gray-500",children:[(0,b.jsxs)("span",{className:"flex items-center",children:[(0,b.jsx)(k.Eye,{className:"h-4 w-4 mr-1"}),a.views||0]}),(0,b.jsxs)("span",{className:"flex items-center",children:[(0,b.jsx)(j.Heart,{className:"h-4 w-4 mr-1"}),a.likes||0]}),(0,b.jsx)("span",{className:"text-xs text-gray-400",children:new Date(a.created_at).toLocaleDateString("en-US",{month:"short",day:"numeric"})})]}),(0,b.jsx)(d.default,{href:`/listings/land/${a.id}`,children:(0,b.jsx)(l.Button,{size:"sm",className:"bg-red-600 hover:bg-red-700",children:"View Details"})})]})]})]},a.id)})}):(0,b.jsxs)("div",{className:"text-center py-12",children:[(0,b.jsx)(h.Trees,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),(0,b.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:0===y.length?"No land listings yet":"No plots found matching your criteria"}),(0,b.jsx)("p",{className:"text-gray-600 mb-4",children:0===y.length?"Be the first to list your land property!":"Try adjusting your filters or search criteria"}),0===y.length?(0,b.jsx)(d.default,{href:"/create-listing?category=land",children:(0,b.jsx)(l.Button,{className:"bg-red-600 hover:bg-red-700",children:"List Your Land"})}):(0,b.jsx)(l.Button,{variant:"outline",className:"border-red-600 text-red-600 hover:bg-red-50",onClick:()=>{p(""),r({min:"",max:""}),t({min:"",max:""}),v(""),x("")},children:"Clear All Filters"})]})]})]})})]})}a.s(["default",()=>o],56355)}];

//# sourceMappingURL=src_app_%5Blocale%5D_listings_land_page_tsx_4feb3945._.js.map