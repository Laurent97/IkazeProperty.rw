module.exports=[77156,a=>{"use strict";let b=(0,a.i(70106).default)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);a.s(["Eye",()=>b],77156)},60246,a=>{"use strict";let b=(0,a.i(70106).default)("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]);a.s(["Users",()=>b],60246)},210,a=>{"use strict";let b=(0,a.i(70106).default)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);a.s(["ArrowLeft",()=>b],210)},63588,a=>{"use strict";let b=(0,a.i(70106).default)("message-square",[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]]);a.s(["MessageSquare",()=>b],63588)},68982,a=>{"use strict";var b=a.i(87924),c=a.i(63519),d=a.i(92258),e=a.i(24987),f=a.i(20997);function g({className:a=""}){let{getPlatformInfo:g}=(0,f.usePaymentMethods)(),h=g();return(0,b.jsxs)("div",{className:`text-xs text-gray-600 space-y-1 ${a}`,children:[(0,b.jsxs)("div",{className:"flex items-center",children:[(0,b.jsx)(c.Phone,{className:"h-3 w-3 mr-2 text-gray-500"}),(0,b.jsx)("span",{children:h.phone})]}),(0,b.jsxs)("div",{className:"flex items-center",children:[(0,b.jsx)(d.Mail,{className:"h-3 w-3 mr-2 text-gray-500"}),(0,b.jsx)("span",{children:h.email})]}),(0,b.jsxs)("div",{className:"flex items-center",children:[(0,b.jsx)(e.MapPin,{className:"h-3 w-3 mr-2 text-gray-500"}),(0,b.jsx)("span",{children:h.address})]})]})}a.s(["default",()=>g])},35800,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(76472),e=a.i(99570),f=a.i(63672);function g({listingId:a,className:g="",size:h="md",showText:i=!1}){let[j,k]=(0,c.useState)(!1),[l,m]=(0,c.useState)(!0),[n,o]=(0,c.useState)(null),[p,q]=(0,c.useState)(null),r={sm:"h-8 w-8",md:"h-10 w-10",lg:"h-12 w-12"},s={sm:"h-4 w-4",md:"h-5 w-5",lg:"h-6 w-6"};(0,c.useEffect)(()=>{(async()=>{try{let b=await (0,f.getCurrentUser)();if(!b)return void m(!1);o(b);let{data:c}=await f.supabase.from("listings").select("likes").eq("id",a).single();q(c);let{data:d,error:e}=await f.supabase.from("favorite_listings").select("*").eq("user_id",b.id).eq("listing_id",a).single();e&&"PGRST116"!==e.code?console.error("Error checking favorite status:",e):k(!!d)}catch(a){console.error("Error checking favorite status:",a)}finally{m(!1)}})()},[a]);let t=async()=>{if(!n)return void alert("Please login to favorite listings");try{if(j){let{error:b}=await f.supabase.from("favorite_listings").delete().eq("user_id",n.id).eq("listing_id",a);if(b)throw b;k(!1),await f.supabase.rpc("sql",{sql:`SELECT decrement_likes('${a}')`})}else{let{error:b}=await f.supabase.from("favorite_listings").insert({user_id:n.id,listing_id:a});if(b)throw b;k(!0),await f.supabase.rpc("sql",{sql:`SELECT increment_likes('${a}')`})}}catch(a){console.error("Error toggling favorite:",a),alert("Error updating favorites. Please try again.")}};return l?(0,b.jsx)(e.Button,{variant:"outline",className:`${g} ${r[h]}`,disabled:!0,children:(0,b.jsx)(d.Heart,{className:`${s[h]} animate-pulse`})}):(0,b.jsxs)(e.Button,{variant:"outline",className:`${g} ${r[h]} ${j?"bg-red-50 border-red-200 text-red-600 hover:bg-red-100":"hover:bg-red-50 hover:border-red-200 hover:text-red-600"}`,onClick:t,title:j?"Remove from favorites":"Add to favorites",children:[(0,b.jsx)(d.Heart,{className:`${s[h]} ${j?"fill-current":""}`}),i&&(0,b.jsx)("span",{className:"ml-2",children:j?"Favorited":"Favorite"})]})}a.s(["default",()=>g])},22436,56884,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(76472),e=a.i(60246),f=a.i(99570),g=a.i(68114);let h=c.forwardRef(({className:a,...c},d)=>(0,b.jsx)("div",{ref:d,className:(0,g.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",a),...c}));h.displayName="Avatar";let i=c.forwardRef(({className:a,...c},d)=>(0,b.jsx)("img",{ref:d,className:(0,g.cn)("aspect-square h-full w-full object-cover",a),...c}));i.displayName="AvatarImage";let j=c.forwardRef(({className:a,...c},d)=>(0,b.jsx)("div",{ref:d,className:(0,g.cn)("flex h-full w-full items-center justify-center rounded-full bg-gray-100 text-gray-600",a),...c}));j.displayName="AvatarFallback";var k=a.i(33508);let l=({open:a,onOpenChange:d,children:e})=>(0,b.jsx)(b.Fragment,{children:c.Children.map(e,b=>c.isValidElement(b)?c.cloneElement(b,{open:a,onOpenChange:d}):b)}),m=c.forwardRef(({className:a,onClick:d,open:e,onOpenChange:f,asChild:h=!1,children:i,...j},k)=>h&&c.isValidElement(i)?c.cloneElement(i,{ref:k,className:(0,g.cn)(a,i.props.className),onClick:a=>{i.props.onClick?.(a),d?.(a),f?.(!e)},...j}):(0,b.jsx)("button",{ref:k,className:a,onClick:a=>{d?.(a),f?.(!e)},...j,children:i}));m.displayName="DialogTrigger";let n=c.forwardRef(({className:a,children:c,open:d,onOpenChange:e,...f},g)=>d?(0,b.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[(0,b.jsx)("div",{className:"fixed inset-0 bg-black/80",onClick:()=>e?.(!1)}),(0,b.jsxs)("div",{ref:g,className:`relative z-50 grid w-full max-w-lg gap-4 border bg-background p-6 shadow-lg rounded-lg ${a}`,...f,children:[(0,b.jsxs)("button",{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100",onClick:()=>e?.(!1),children:[(0,b.jsx)(k.X,{className:"h-4 w-4"}),(0,b.jsx)("span",{className:"sr-only",children:"Close"})]}),c]})]}):null);n.displayName="DialogContent";let o=({className:a,...c})=>(0,b.jsx)("div",{className:`flex flex-col space-y-1.5 text-center sm:text-left ${a}`,...c});o.displayName="DialogHeader";let p=({className:a,...c})=>(0,b.jsx)("h2",{className:`text-lg font-semibold leading-none tracking-tight ${a}`,...c});p.displayName="DialogTitle";var q=a.i(63672);function r({listingId:a,likesCount:g,className:k=""}){let[r,s]=(0,c.useState)([]),[t,u]=(0,c.useState)(!1),[v,w]=(0,c.useState)(!1),x=async()=>{if(0!==g){u(!0);try{let{data:b,error:c}=await q.supabase.from("listing_likes").select(`
          user_id,
          created_at,
          users!listing_likes_user_id_fkey (
            id,
            full_name,
            email,
            avatar_url
          )
        `).eq("listing_id",a).order("created_at",{ascending:!1}).limit(20);if(c)throw c;let d=(b||[]).map(a=>a.users).filter(Boolean);s(d)}catch(a){console.error("Error fetching liked users:",a)}finally{u(!1)}}};return 0===g?(0,b.jsxs)("div",{className:`flex items-center gap-1 text-gray-500 ${k}`,children:[(0,b.jsx)(d.Heart,{className:"h-4 w-4"}),(0,b.jsx)("span",{className:"text-sm",children:"No likes yet"})]}):(0,b.jsxs)(l,{open:v,onOpenChange:a=>{w(a),a&&0===r.length&&x()},children:[(0,b.jsx)(m,{asChild:!0,children:(0,b.jsxs)(f.Button,{variant:"ghost",className:`flex items-center gap-1 text-gray-600 hover:text-red-600 ${k}`,children:[(0,b.jsx)(d.Heart,{className:"h-4 w-4"}),(0,b.jsx)("span",{className:"text-sm font-medium",children:g}),(0,b.jsx)("span",{className:"text-xs text-gray-500",children:"likes"})]})}),(0,b.jsxs)(n,{className:"max-w-md",children:[(0,b.jsx)(o,{children:(0,b.jsxs)(p,{className:"flex items-center gap-2",children:[(0,b.jsx)(d.Heart,{className:"h-5 w-5 text-red-500"}),"People who liked this listing"]})}),(0,b.jsx)("div",{className:"space-y-3",children:t?(0,b.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,b.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-red-600"})}):0===r.length?(0,b.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,b.jsx)(e.Users,{className:"h-12 w-12 mx-auto mb-2 opacity-50"}),(0,b.jsx)("p",{children:"No one has liked this listing yet"})]}):(0,b.jsxs)("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:[r.map(a=>(0,b.jsxs)("div",{className:"flex items-center gap-3 p-2 rounded-lg hover:bg-gray-50",children:[(0,b.jsxs)(h,{className:"h-10 w-10",children:[(0,b.jsx)(i,{src:a.avatar_url||"",alt:a.full_name||""}),(0,b.jsx)(j,{children:a.full_name?.charAt(0)?.toUpperCase()||a.email?.charAt(0)?.toUpperCase()||"U"})]}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsx)("p",{className:"font-medium text-sm truncate",children:a.full_name||"Anonymous User"}),(0,b.jsx)("p",{className:"text-xs text-gray-500 truncate",children:a.email||"No email"})]})]},a.id)),r.length<g&&(0,b.jsxs)("div",{className:"text-center py-2 text-sm text-gray-500",children:["And ",g-r.length," more..."]})]})})]})]})}a.s(["default",()=>r],22436);var s=a.i(77156);function t({listingId:a,viewsCount:d,className:e=""}){let[g,h]=(0,c.useState)([]),[i,j]=(0,c.useState)(!1),[k,r]=(0,c.useState)(!1),t=async()=>{if(0!==d){j(!0);try{let{data:b,error:c}=await q.supabase.from("listing_views").select(`
          id,
          user_id,
          ip_address,
          user_agent,
          viewed_at,
          users!listing_views_user_id_fkey (
            id,
            full_name,
            email,
            avatar_url
          )
        `).eq("listing_id",a).order("viewed_at",{ascending:!1}).limit(20);c?(console.error("Error fetching views:",c),h([])):h(b||[])}catch(a){console.error("Error fetching views:",a),h([])}finally{j(!1)}}};return 0===d?(0,b.jsxs)("div",{className:`flex items-center gap-1 text-gray-500 ${e}`,children:[(0,b.jsx)(s.Eye,{className:"h-4 w-4"}),(0,b.jsx)("span",{className:"text-sm",children:"No views yet"})]}):(0,b.jsxs)(l,{open:k,onOpenChange:a=>{r(a),a&&0===g.length&&t()},children:[(0,b.jsx)(m,{asChild:!0,children:(0,b.jsxs)(f.Button,{variant:"ghost",className:`flex items-center gap-1 text-gray-600 hover:text-blue-600 ${e}`,children:[(0,b.jsx)(s.Eye,{className:"h-4 w-4"}),(0,b.jsx)("span",{className:"text-sm font-medium",children:d}),(0,b.jsx)("span",{className:"text-xs text-gray-500",children:"views"})]})}),(0,b.jsxs)(n,{className:"max-w-md",children:[(0,b.jsx)(o,{children:(0,b.jsxs)(p,{className:"flex items-center gap-2",children:[(0,b.jsx)(s.Eye,{className:"h-5 w-5 text-blue-500"}),"Recent views"]})}),(0,b.jsx)("div",{className:"space-y-3",children:i?(0,b.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,b.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):0===g.length?(0,b.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,b.jsx)(s.Eye,{className:"h-12 w-12 mx-auto mb-2 opacity-50"}),(0,b.jsx)("p",{children:"No views recorded yet"})]}):(0,b.jsxs)("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:[g.map(a=>{let c,d;return(0,b.jsxs)("div",{className:"flex items-center gap-3 p-2 rounded-lg hover:bg-gray-50",children:[(0,b.jsx)("div",{className:"flex-shrink-0",children:a.users?(0,b.jsx)("div",{className:"h-8 w-8 rounded-full bg-blue-100 flex items-center justify-center",children:(0,b.jsx)("span",{className:"text-xs font-medium text-blue-600",children:a.users.full_name?.charAt(0)?.toUpperCase()||"U"})}):(0,b.jsx)("div",{className:"h-8 w-8 rounded-full bg-gray-100 flex items-center justify-center",children:(0,b.jsx)(s.Eye,{className:"h-4 w-4 text-gray-500"})})}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsx)("p",{className:"font-medium text-sm truncate",children:a.users?.full_name||"Anonymous Visitor"}),(0,b.jsxs)("p",{className:"text-xs text-gray-500",children:[(c=new Date(a.viewed_at),(d=Math.floor((new Date().getTime()-c.getTime())/36e5))<1?"Just now":d<24?`${d}h ago`:d<48?"Yesterday":c.toLocaleDateString()),a.ip_address&&` â€¢ ${a.ip_address}`]})]})]},a.id)}),g.length<d&&(0,b.jsxs)("div",{className:"text-center py-2 text-sm text-gray-500",children:["And ",d-g.length," more views..."]})]})})]})]})}a.s(["default",()=>t],56884)},53215,a=>{a.v(a=>Promise.resolve().then(()=>a(24507)))}];

//# sourceMappingURL=_6460bdf9._.js.map