{"version":3,"sources":["../../../../src/components/ui/input.tsx","../../../../src/components/ui/label.tsx","../../../../src/app/%5Blocale%5D/admin/site-settings/page.tsx"],"sourcesContent":["import * as React from \"react\"\n\nexport interface InputProps\n  extends React.InputHTMLAttributes<HTMLInputElement> {}\n\nconst Input = React.forwardRef<HTMLInputElement, InputProps>(\n  ({ className, type, ...props }, ref) => {\n    return (\n      <input\n        type={type}\n        className={`flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 ${className || ''}`}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nInput.displayName = \"Input\"\n\nexport { Input }\n","import * as React from \"react\"\n\nexport interface LabelProps\n  extends React.LabelHTMLAttributes<HTMLLabelElement> {}\n\nconst Label = React.forwardRef<HTMLLabelElement, LabelProps>(\n  ({ className, ...props }, ref) => {\n    return (\n      <label\n        ref={ref}\n        className={`text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 ${className || ''}`}\n        {...props}\n      />\n    )\n  }\n)\nLabel.displayName = \"Label\"\n\nexport { Label }\n","'use client'\n\nimport { useEffect, useState } from 'react'\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Button } from '@/components/ui/button'\nimport { Input } from '@/components/ui/input'\nimport { Label } from '@/components/ui/label'\nimport { MessageCircle } from 'lucide-react'\nimport { supabase } from '@/lib/auth'\n\nexport default function SiteSettingsPage() {\n  const [loading, setLoading] = useState(true)\n  const [saving, setSaving] = useState(false)\n  const [error, setError] = useState('')\n  const [success, setSuccess] = useState('')\n  const [formData, setFormData] = useState({\n    admin_phone: '',\n    whatsapp_phone: '',\n    support_email: '',\n    office_address: ''\n  })\n\n  useEffect(() => {\n    loadSettings()\n  }, [])\n\n  const loadSettings = async () => {\n    try {\n      const response = await fetch('/api/site-settings')\n      const data = await response.json()\n      if (response.ok && data?.settings) {\n        setFormData(data.settings)\n      }\n    } catch (err: any) {\n      setError(err.message || 'Failed to load settings')\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const handleSave = async () => {\n    setSaving(true)\n    setError('')\n    setSuccess('')\n    try {\n      const { data: { session } } = await supabase.auth.getSession()\n      if (!session?.access_token) {\n        setError('You must be logged in')\n        return\n      }\n\n      console.log('Saving settings with data:', formData)\n\n      const response = await fetch('/api/site-settings/admin', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${session.access_token}`,\n          'Accept': 'application/json'\n        },\n        body: JSON.stringify(formData)\n      })\n\n      console.log('Response status:', response.status)\n      console.log('Response headers:', response.headers)\n\n      const data = await response.json()\n      console.log('Response data:', data)\n\n      if (!response.ok) {\n        setError(data.error || `Failed to save settings (Status: ${response.status})`)\n        return\n      }\n\n      setSuccess('Settings saved successfully')\n    } catch (err: any) {\n      console.error('Save error:', err)\n      setError(err.message || 'Failed to save settings')\n    } finally {\n      setSaving(false)\n    }\n  }\n\n  if (loading) {\n    return (\n      <div className=\"container mx-auto py-8\">\n        <div className=\"text-center\">Loading site settings...</div>\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"container mx-auto py-8 space-y-6\">\n      <h1 className=\"text-3xl font-bold\">Site Settings</h1>\n\n      <Card>\n        <CardHeader>\n          <CardTitle>Default Contact Details</CardTitle>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          {error && (\n            <div className=\"bg-red-50 border border-red-200 rounded-lg p-3 text-sm text-red-700\">\n              {error}\n            </div>\n          )}\n          {success && (\n            <div className=\"bg-green-50 border border-green-200 rounded-lg p-3 text-sm text-green-700\">\n              {success}\n            </div>\n          )}\n\n          <div>\n            <Label htmlFor=\"admin_phone\">Admin Phone</Label>\n            <Input\n              id=\"admin_phone\"\n              value={formData.admin_phone}\n              onChange={(e: React.ChangeEvent<HTMLInputElement>) =>\n                setFormData({ ...formData, admin_phone: e.target.value })\n              }\n              placeholder={process.env.NEXT_PUBLIC_PLATFORM_PHONE || '+250 XXX XXX XXX'}\n            />\n          </div>\n\n          <div>\n            <Label htmlFor=\"whatsapp_phone\">WhatsApp Phone</Label>\n            <Input\n              id=\"whatsapp_phone\"\n              value={formData.whatsapp_phone}\n              onChange={(e: React.ChangeEvent<HTMLInputElement>) =>\n                setFormData({ ...formData, whatsapp_phone: e.target.value })\n              }\n              placeholder={process.env.NEXT_PUBLIC_PLATFORM_WHATSAPP || '+250 XXX XXX XXX'}\n            />\n          </div>\n\n          <div>\n            <Label htmlFor=\"support_email\">Support Email</Label>\n            <Input\n              id=\"support_email\"\n              value={formData.support_email}\n              onChange={(e: React.ChangeEvent<HTMLInputElement>) =>\n                setFormData({ ...formData, support_email: e.target.value })\n              }\n              placeholder={process.env.NEXT_PUBLIC_PLATFORM_EMAIL || 'contact@ikazeproperty.rw'}\n            />\n          </div>\n\n          <div>\n            <Label htmlFor=\"office_address\">Office Address</Label>\n            <Input\n              id=\"office_address\"\n              value={formData.office_address}\n              onChange={(e: React.ChangeEvent<HTMLInputElement>) =>\n                setFormData({ ...formData, office_address: e.target.value })\n              }\n              placeholder=\"KN 123 St, Kiyovu\"\n            />\n          </div>\n\n          <div className=\"border-t pt-4 mt-6\">\n            <h3 className=\"text-lg font-semibold mb-4 text-green-600\">WhatsApp Customer Service</h3>\n            <p className=\"text-sm text-gray-600 mb-4\">\n              Update your WhatsApp customer service number and test the connection\n            </p>\n            <div className=\"bg-gray-50 p-3 rounded-lg mb-4\">\n              <p className=\"text-sm font-medium text-gray-700\">Current WhatsApp Number:</p>\n              <p className=\"text-lg font-bold text-green-600\">{formData.whatsapp_phone || 'Not set'}</p>\n            </div>\n          </div>\n\n          <div className=\"flex justify-between items-center\">\n            <Button\n              onClick={handleSave}\n              disabled={saving}\n              className=\"bg-red-600 hover:bg-red-700\"\n            >\n              {saving ? 'Saving...' : 'Save Settings'}\n            </Button>\n            <Button\n              onClick={() => window.open(`https://wa.me/${formData.whatsapp_phone?.replace(/[^\\d]/g, '')}`, '_blank')}\n              variant=\"outline\"\n              className=\"text-green-600 border-green-600 hover:bg-green-50\"\n              disabled={!formData.whatsapp_phone}\n            >\n              <MessageCircle className=\"h-4 w-4 mr-2\" />\n              Test WhatsApp Connection\n            </Button>\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  )\n}\n"],"names":[],"mappings":"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"}