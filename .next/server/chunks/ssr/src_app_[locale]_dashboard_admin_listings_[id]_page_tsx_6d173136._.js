module.exports=[42942,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(38246),f=a.i(210),g=a.i(81010),h=a.i(48464),i=a.i(79161),j=a.i(83497),k=a.i(24569),l=a.i(81560),m=a.i(77156),n=a.i(14548),o=a.i(33508),p=a.i(16201),q=a.i(62722),r=a.i(41710),s=a.i(90166),t=a.i(46842),u=a.i(41675),v=a.i(24987),w=a.i(4720),x=a.i(99570),y=a.i(91119),z=a.i(66718),A=a.i(29246),B=a.i(86304),C=a.i(63672);function D(){let a=(0,d.useParams)(),D=(0,d.useRouter)(),E=a.id,[F,G]=(0,c.useState)(null),[H,I]=(0,c.useState)(!0),[J,K]=(0,c.useState)(!1),[L,M]=(0,c.useState)({}),[N,O]=(0,c.useState)([]);(0,c.useEffect)(()=>{P()},[E]);let P=async()=>{try{I(!0);let{data:a,error:b}=await C.supabase.from("listings").select(`
          *,
          seller:users!listings_seller_id_fkey(*)
        `).eq("id",E).single();if(b)throw b;G(a),M(a);let{data:c,error:d}=await C.supabase.from("inquiries").select(`
          *,
          buyer:users!inquiries_buyer_id_fkey(*)
        `).eq("listing_id",E).order("created_at",{ascending:!1});if(d)throw d;O(c||[])}catch(a){console.error("Error fetching listing details:",a)}finally{I(!1)}},Q=a=>{switch(a){case"house":return(0,b.jsx)(g.Home,{className:"h-5 w-5"});case"car":return(0,b.jsx)(h.Car,{className:"h-5 w-5"});case"land":return(0,b.jsx)(i.Trees,{className:"h-5 w-5"});default:return(0,b.jsx)(j.Package,{className:"h-5 w-5"})}},R=a=>{switch(a){case"active":return(0,b.jsx)(B.Badge,{className:"bg-green-100 text-green-800",children:"Active"});case"pending":return(0,b.jsx)(B.Badge,{className:"bg-yellow-100 text-yellow-800",children:"Pending"});case"sold":return(0,b.jsx)(B.Badge,{className:"bg-blue-100 text-blue-800",children:"Sold"});case"rejected":return(0,b.jsx)(B.Badge,{className:"bg-red-100 text-red-800",children:"Rejected"});default:return(0,b.jsx)(B.Badge,{className:"bg-gray-100 text-gray-800",children:"Unknown"})}},S=async()=>{try{let{error:a}=await C.supabase.from("listings").update(L).eq("id",E);if(a)throw a;G(L),K(!1),alert("Listing updated successfully!")}catch(a){console.error("Error updating listing:",a),alert("Error updating listing. Please try again.")}},T=async()=>{if(confirm("Are you sure you want to delete this listing? This action cannot be undone."))try{let{error:a}=await C.supabase.from("listings").delete().eq("id",E);if(a)throw a;D.push("/dashboard/admin/listings")}catch(a){console.error("Error deleting listing:",a),alert("Error deleting listing. Please try again.")}},U=async a=>{try{let{error:b}=await C.supabase.from("listings").update({status:a}).eq("id",E);if(b)throw b;G({...F,status:a}),M({...L,status:a})}catch(a){console.error("Error updating status:",a),alert("Error updating status. Please try again.")}};return H?(0,b.jsx)("div",{className:"p-6",children:(0,b.jsxs)("div",{className:"text-center py-12",children:[(0,b.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),(0,b.jsx)("p",{className:"text-gray-600 mt-2",children:"Loading listing details..."})]})}):F?(0,b.jsxs)("div",{className:"p-6",children:[(0,b.jsx)("div",{className:"mb-6",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,b.jsx)(e.default,{href:"/dashboard/admin/listings",children:(0,b.jsxs)(x.Button,{variant:"outline",size:"sm",children:[(0,b.jsx)(f.ArrowLeft,{className:"h-4 w-4 mr-2"}),"Back to Listings"]})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Listing Details"}),(0,b.jsx)("p",{className:"text-gray-600",children:"Manage listing information and inquiries"})]})]}),(0,b.jsx)("div",{className:"flex space-x-2",children:J?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(x.Button,{onClick:S,className:"bg-green-600 hover:bg-green-700",children:[(0,b.jsx)(n.Save,{className:"h-4 w-4 mr-2"}),"Save"]}),(0,b.jsxs)(x.Button,{onClick:()=>{K(!1),M(F)},variant:"outline",children:[(0,b.jsx)(o.X,{className:"h-4 w-4 mr-2"}),"Cancel"]})]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(x.Button,{onClick:()=>K(!0),variant:"outline",children:[(0,b.jsx)(k.Edit,{className:"h-4 w-4 mr-2"}),"Edit"]}),(0,b.jsxs)(x.Button,{onClick:T,variant:"outline",className:"text-red-600 hover:text-red-700",children:[(0,b.jsx)(l.Trash2,{className:"h-4 w-4 mr-2"}),"Delete"]})]})})]})}),(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,b.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[(0,b.jsxs)(y.Card,{children:[(0,b.jsx)(y.CardHeader,{children:(0,b.jsxs)(y.CardTitle,{className:"flex items-center",children:[Q(F.category),(0,b.jsx)("span",{className:"ml-2",children:"Listing Information"}),R(F.status)]})}),(0,b.jsx)(y.CardContent,{className:"space-y-4",children:J?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Title"}),(0,b.jsx)(z.Input,{value:L.title||"",onChange:a=>M({...L,title:a.target.value})})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),(0,b.jsx)(A.Textarea,{value:L.description||"",onChange:a=>M({...L,description:a.target.value}),rows:4})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Price"}),(0,b.jsx)(z.Input,{type:"number",value:L.price||"",onChange:a=>M({...L,price:parseFloat(a.target.value)})})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category"}),(0,b.jsxs)("select",{value:L.category||"",onChange:a=>M({...L,category:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,b.jsx)("option",{value:"house",children:"House"}),(0,b.jsx)("option",{value:"car",children:"Car"}),(0,b.jsx)("option",{value:"land",children:"Land"}),(0,b.jsx)("option",{value:"other",children:"Other"})]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Location"}),(0,b.jsx)(z.Input,{value:"string"==typeof L.location?L.location:JSON.stringify(L.location)||"",onChange:a=>M({...L,location:a.target.value})})]})]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:F.title}),(0,b.jsx)("p",{className:"text-gray-600 mb-4",children:F.description})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"flex items-center",children:[(0,b.jsx)(s.DollarSign,{className:"h-4 w-4 text-gray-400 mr-2"}),(0,b.jsx)("span",{className:"text-sm text-gray-600",children:"Price:"}),(0,b.jsxs)("span",{className:"ml-2 font-medium",children:["$",F.price?.toLocaleString()]})]}),(0,b.jsxs)("div",{className:"flex items-center",children:[Q(F.category),(0,b.jsx)("span",{className:"ml-2 text-sm text-gray-600",children:"Category:"}),(0,b.jsx)("span",{className:"ml-2 font-medium capitalize",children:F.category})]}),(0,b.jsxs)("div",{className:"flex items-center",children:[(0,b.jsx)(v.MapPin,{className:"h-4 w-4 text-gray-400 mr-2"}),(0,b.jsx)("span",{className:"text-sm text-gray-600",children:"Location:"}),(0,b.jsx)("span",{className:"ml-2 font-medium",children:"string"==typeof F.location?F.location:F.location&&`${F.location.village||""}, ${F.location.district||""}, ${F.location.province||""}`.replace(/^[,\s]+|[,\s]+$/g,"")||"Not specified"})]}),(0,b.jsxs)("div",{className:"flex items-center",children:[(0,b.jsx)(u.Calendar,{className:"h-4 w-4 text-gray-400 mr-2"}),(0,b.jsx)("span",{className:"text-sm text-gray-600",children:"Available until:"}),(0,b.jsx)("span",{className:"ml-2 font-medium",children:F.available_until?new Date(F.available_until).toLocaleDateString():"Not specified"})]})]})]})})]}),(0,b.jsxs)(y.Card,{children:[(0,b.jsx)(y.CardHeader,{children:(0,b.jsxs)(y.CardTitle,{children:["Inquiries (",N.length,")"]})}),(0,b.jsx)(y.CardContent,{children:0===N.length?(0,b.jsx)("p",{className:"text-gray-500 text-center py-4",children:"No inquiries yet"}):(0,b.jsx)("div",{className:"space-y-4",children:N.map(a=>(0,b.jsx)("div",{className:"border border-gray-200 rounded-lg p-4",children:(0,b.jsx)("div",{className:"flex items-start justify-between mb-2",children:(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsxs)("div",{className:"flex items-center mb-1",children:[(0,b.jsx)(t.User,{className:"h-4 w-4 text-gray-400 mr-2"}),(0,b.jsx)("span",{className:"font-medium text-gray-900",children:a.buyer?.full_name}),(0,b.jsxs)("span",{className:"ml-2 text-sm text-gray-600",children:["(",a.buyer?.email,")"]})]}),(0,b.jsx)("p",{className:"text-sm text-gray-600 mb-2",children:a.message}),(0,b.jsxs)("div",{className:"flex items-center space-x-4 text-sm text-gray-500",children:[(0,b.jsxs)("span",{className:"flex items-center",children:[(0,b.jsx)(u.Calendar,{className:"h-4 w-4 mr-1"}),new Date(a.created_at).toLocaleDateString()]}),R(a.status)]})]})})},a.id))})})]})]}),(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)(y.Card,{children:[(0,b.jsx)(y.CardHeader,{children:(0,b.jsx)(y.CardTitle,{children:"Status Management"})}),(0,b.jsxs)(y.CardContent,{className:"space-y-3",children:[(0,b.jsxs)(x.Button,{onClick:()=>U("active"),disabled:"active"===F.status,className:"w-full",variant:"active"===F.status?"default":"outline",children:[(0,b.jsx)(p.CheckCircle,{className:"h-4 w-4 mr-2"}),"Mark as Active"]}),(0,b.jsxs)(x.Button,{onClick:()=>U("pending"),disabled:"pending"===F.status,className:"w-full",variant:"pending"===F.status?"default":"outline",children:[(0,b.jsx)(r.Clock,{className:"h-4 w-4 mr-2"}),"Mark as Pending"]}),(0,b.jsxs)(x.Button,{onClick:()=>U("sold"),disabled:"sold"===F.status,className:"w-full",variant:"sold"===F.status?"default":"outline",children:[(0,b.jsx)(s.DollarSign,{className:"h-4 w-4 mr-2"}),"Mark as Sold"]}),(0,b.jsxs)(x.Button,{onClick:()=>U("rejected"),disabled:"rejected"===F.status,className:"w-full text-red-600 hover:text-red-700",variant:"rejected"===F.status?"default":"outline",children:[(0,b.jsx)(q.XCircle,{className:"h-4 w-4 mr-2"}),"Reject Listing"]})]})]}),(0,b.jsxs)(y.Card,{children:[(0,b.jsx)(y.CardHeader,{children:(0,b.jsx)(y.CardTitle,{children:"Seller Information"})}),(0,b.jsx)(y.CardContent,{children:(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"flex items-center",children:[(0,b.jsx)(t.User,{className:"h-4 w-4 text-gray-400 mr-2"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-medium text-gray-900",children:F.seller?.full_name}),(0,b.jsx)("p",{className:"text-sm text-gray-600",children:F.seller?.email})]})]}),(0,b.jsxs)("div",{className:"flex items-center",children:[(0,b.jsx)(u.Calendar,{className:"h-4 w-4 text-gray-400 mr-2"}),(0,b.jsxs)("span",{className:"text-sm text-gray-600",children:["Joined ",new Date(F.seller?.created_at).toLocaleDateString()]})]})]})})]}),(0,b.jsxs)(y.Card,{children:[(0,b.jsx)(y.CardHeader,{children:(0,b.jsx)(y.CardTitle,{children:"Quick Actions"})}),(0,b.jsxs)(y.CardContent,{className:"space-y-3",children:[(0,b.jsx)(e.default,{href:`/listings/${F.category}/${F.id}`,children:(0,b.jsxs)(x.Button,{variant:"outline",className:"w-full",children:[(0,b.jsx)(m.Eye,{className:"h-4 w-4 mr-2"}),"View Public Listing"]})}),(0,b.jsxs)(x.Button,{variant:"outline",className:"w-full",children:[(0,b.jsx)(w.FileText,{className:"h-4 w-4 mr-2"}),"Export Details"]})]})]})]})]})]}):(0,b.jsx)("div",{className:"p-6",children:(0,b.jsxs)("div",{className:"text-center py-12",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Listing Not Found"}),(0,b.jsx)("p",{className:"text-gray-600 mb-4",children:"The listing you're looking for doesn't exist."}),(0,b.jsx)(e.default,{href:"/dashboard/admin/listings",children:(0,b.jsx)(x.Button,{children:"Back to Listings"})})]})})}a.s(["default",()=>D])}];

//# sourceMappingURL=src_app_%5Blocale%5D_dashboard_admin_listings_%5Bid%5D_page_tsx_6d173136._.js.map