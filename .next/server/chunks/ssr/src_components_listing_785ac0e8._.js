module.exports=[22436,56884,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(76472),e=a.i(60246),f=a.i(99570),g=a.i(68114);let h=c.forwardRef(({className:a,...c},d)=>(0,b.jsx)("div",{ref:d,className:(0,g.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",a),...c}));h.displayName="Avatar";let i=c.forwardRef(({className:a,...c},d)=>(0,b.jsx)("img",{ref:d,className:(0,g.cn)("aspect-square h-full w-full object-cover",a),...c}));i.displayName="AvatarImage";let j=c.forwardRef(({className:a,...c},d)=>(0,b.jsx)("div",{ref:d,className:(0,g.cn)("flex h-full w-full items-center justify-center rounded-full bg-gray-100 text-gray-600",a),...c}));j.displayName="AvatarFallback";var k=a.i(33508);let l=({open:a,onOpenChange:d,children:e})=>(0,b.jsx)(b.Fragment,{children:c.Children.map(e,b=>c.isValidElement(b)?c.cloneElement(b,{open:a,onOpenChange:d}):b)}),m=c.forwardRef(({className:a,onClick:d,open:e,onOpenChange:f,asChild:h=!1,children:i,...j},k)=>h&&c.isValidElement(i)?c.cloneElement(i,{ref:k,className:(0,g.cn)(a,i.props.className),onClick:a=>{i.props.onClick?.(a),d?.(a),f?.(!e)},...j}):(0,b.jsx)("button",{ref:k,className:a,onClick:a=>{d?.(a),f?.(!e)},...j,children:i}));m.displayName="DialogTrigger";let n=c.forwardRef(({className:a,children:c,open:d,onOpenChange:e,...f},g)=>d?(0,b.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[(0,b.jsx)("div",{className:"fixed inset-0 bg-black/80",onClick:()=>e?.(!1)}),(0,b.jsxs)("div",{ref:g,className:`relative z-50 grid w-full max-w-lg gap-4 border bg-background p-6 shadow-lg rounded-lg ${a}`,...f,children:[(0,b.jsxs)("button",{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100",onClick:()=>e?.(!1),children:[(0,b.jsx)(k.X,{className:"h-4 w-4"}),(0,b.jsx)("span",{className:"sr-only",children:"Close"})]}),c]})]}):null);n.displayName="DialogContent";let o=({className:a,...c})=>(0,b.jsx)("div",{className:`flex flex-col space-y-1.5 text-center sm:text-left ${a}`,...c});o.displayName="DialogHeader";let p=({className:a,...c})=>(0,b.jsx)("h2",{className:`text-lg font-semibold leading-none tracking-tight ${a}`,...c});p.displayName="DialogTitle";var q=a.i(63672);function r({listingId:a,likesCount:g,className:k=""}){let[r,s]=(0,c.useState)([]),[t,u]=(0,c.useState)(!1),[v,w]=(0,c.useState)(!1),x=async()=>{if(0!==g){u(!0);try{let{data:b,error:c}=await q.supabase.from("listing_likes").select(`
          user_id,
          created_at,
          users!listing_likes_user_id_fkey (
            id,
            full_name,
            email,
            avatar_url
          )
        `).eq("listing_id",a).order("created_at",{ascending:!1}).limit(20);if(c)throw c;let d=(b||[]).map(a=>a.users).filter(Boolean);s(d)}catch(a){console.error("Error fetching liked users:",a)}finally{u(!1)}}};return 0===g?(0,b.jsxs)("div",{className:`flex items-center gap-1 text-gray-500 ${k}`,children:[(0,b.jsx)(d.Heart,{className:"h-4 w-4"}),(0,b.jsx)("span",{className:"text-sm",children:"No likes yet"})]}):(0,b.jsxs)(l,{open:v,onOpenChange:a=>{w(a),a&&0===r.length&&x()},children:[(0,b.jsx)(m,{asChild:!0,children:(0,b.jsxs)(f.Button,{variant:"ghost",className:`flex items-center gap-1 text-gray-600 hover:text-red-600 ${k}`,children:[(0,b.jsx)(d.Heart,{className:"h-4 w-4"}),(0,b.jsx)("span",{className:"text-sm font-medium",children:g}),(0,b.jsx)("span",{className:"text-xs text-gray-500",children:"likes"})]})}),(0,b.jsxs)(n,{className:"max-w-md",children:[(0,b.jsx)(o,{children:(0,b.jsxs)(p,{className:"flex items-center gap-2",children:[(0,b.jsx)(d.Heart,{className:"h-5 w-5 text-red-500"}),"People who liked this listing"]})}),(0,b.jsx)("div",{className:"space-y-3",children:t?(0,b.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,b.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-red-600"})}):0===r.length?(0,b.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,b.jsx)(e.Users,{className:"h-12 w-12 mx-auto mb-2 opacity-50"}),(0,b.jsx)("p",{children:"No one has liked this listing yet"})]}):(0,b.jsxs)("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:[r.map(a=>(0,b.jsxs)("div",{className:"flex items-center gap-3 p-2 rounded-lg hover:bg-gray-50",children:[(0,b.jsxs)(h,{className:"h-10 w-10",children:[(0,b.jsx)(i,{src:a.avatar_url||"",alt:a.full_name||""}),(0,b.jsx)(j,{children:a.full_name?.charAt(0)?.toUpperCase()||a.email?.charAt(0)?.toUpperCase()||"U"})]}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsx)("p",{className:"font-medium text-sm truncate",children:a.full_name||"Anonymous User"}),(0,b.jsx)("p",{className:"text-xs text-gray-500 truncate",children:a.email||"No email"})]})]},a.id)),r.length<g&&(0,b.jsxs)("div",{className:"text-center py-2 text-sm text-gray-500",children:["And ",g-r.length," more..."]})]})})]})]})}a.s(["default",()=>r],22436);var s=a.i(77156);function t({listingId:a,viewsCount:d,className:e=""}){let[g,h]=(0,c.useState)([]),[i,j]=(0,c.useState)(!1),[k,r]=(0,c.useState)(!1),t=async()=>{if(0!==d){j(!0);try{let{data:b,error:c}=await q.supabase.from("listing_views").select(`
          id,
          user_id,
          ip_address,
          user_agent,
          viewed_at,
          users!listing_views_user_id_fkey (
            id,
            full_name,
            email,
            avatar_url
          )
        `).eq("listing_id",a).order("viewed_at",{ascending:!1}).limit(20);c?(console.error("Error fetching views:",c),h([])):h(b||[])}catch(a){console.error("Error fetching views:",a),h([])}finally{j(!1)}}};return 0===d?(0,b.jsxs)("div",{className:`flex items-center gap-1 text-gray-500 ${e}`,children:[(0,b.jsx)(s.Eye,{className:"h-4 w-4"}),(0,b.jsx)("span",{className:"text-sm",children:"No views yet"})]}):(0,b.jsxs)(l,{open:k,onOpenChange:a=>{r(a),a&&0===g.length&&t()},children:[(0,b.jsx)(m,{asChild:!0,children:(0,b.jsxs)(f.Button,{variant:"ghost",className:`flex items-center gap-1 text-gray-600 hover:text-blue-600 ${e}`,children:[(0,b.jsx)(s.Eye,{className:"h-4 w-4"}),(0,b.jsx)("span",{className:"text-sm font-medium",children:d}),(0,b.jsx)("span",{className:"text-xs text-gray-500",children:"views"})]})}),(0,b.jsxs)(n,{className:"max-w-md",children:[(0,b.jsx)(o,{children:(0,b.jsxs)(p,{className:"flex items-center gap-2",children:[(0,b.jsx)(s.Eye,{className:"h-5 w-5 text-blue-500"}),"Recent views"]})}),(0,b.jsx)("div",{className:"space-y-3",children:i?(0,b.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,b.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):0===g.length?(0,b.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,b.jsx)(s.Eye,{className:"h-12 w-12 mx-auto mb-2 opacity-50"}),(0,b.jsx)("p",{children:"No views recorded yet"})]}):(0,b.jsxs)("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:[g.map(a=>{let c,d;return(0,b.jsxs)("div",{className:"flex items-center gap-3 p-2 rounded-lg hover:bg-gray-50",children:[(0,b.jsx)("div",{className:"flex-shrink-0",children:a.users?(0,b.jsx)("div",{className:"h-8 w-8 rounded-full bg-blue-100 flex items-center justify-center",children:(0,b.jsx)("span",{className:"text-xs font-medium text-blue-600",children:a.users.full_name?.charAt(0)?.toUpperCase()||"U"})}):(0,b.jsx)("div",{className:"h-8 w-8 rounded-full bg-gray-100 flex items-center justify-center",children:(0,b.jsx)(s.Eye,{className:"h-4 w-4 text-gray-500"})})}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsx)("p",{className:"font-medium text-sm truncate",children:a.users?.full_name||"Anonymous Visitor"}),(0,b.jsxs)("p",{className:"text-xs text-gray-500",children:[(c=new Date(a.viewed_at),(d=Math.floor((new Date().getTime()-c.getTime())/36e5))<1?"Just now":d<24?`${d}h ago`:d<48?"Yesterday":c.toLocaleDateString()),a.ip_address&&` • ${a.ip_address}`]})]})]},a.id)}),g.length<d&&(0,b.jsxs)("div",{className:"text-center py-2 text-sm text-gray-500",children:["And ",d-g.length," more views..."]})]})})]})]})}a.s(["default",()=>t],56884)},75098,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(33508),e=a.i(13749),f=a.i(50522),g=a.i(70106);let h=(0,g.default)("zoom-in",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]),i=(0,g.default)("zoom-out",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]),j=(0,g.default)("rotate-ccw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);function k({images:a,initialIndex:g=0,isOpen:k,onClose:l}){let[m,n]=(0,c.useState)(g),[o,p]=(0,c.useState)(1),[q,r]=(0,c.useState)({x:0,y:0}),[s,t]=(0,c.useState)(!1),[u,v]=(0,c.useState)({x:0,y:0}),[w,x]=(0,c.useState)(null),[y,z]=(0,c.useState)(0),A=(0,c.useRef)(null),B=(0,c.useRef)(null);(0,c.useEffect)(()=>{let b=b=>{"Escape"===b.key?l():"ArrowLeft"===b.key?n(b=>(b-1+a.length)%a.length):"ArrowRight"===b.key?n(b=>(b+1+a.length)%a.length):"+"===b.key||"="===b.key?C():"-"===b.key||"_"===b.key?D():"0"===b.key&&E()};if(k)return document.addEventListener("keydown",b),()=>{document.removeEventListener("keydown",b)}},[k,a.length,l]),(0,c.useEffect)(()=>{p(1),r({x:0,y:0})},[m]);let C=()=>{p(a=>Math.min(a+.25,3))},D=()=>{p(a=>Math.max(a-.25,.5))},E=()=>{p(1),r({x:0,y:0})},F=()=>{t(!1)},G=()=>{1===o?p(2):E()};if(!k)return null;let H=()=>{n(b=>(b-1+a.length)%a.length)},I=()=>{n(b=>(b+1+a.length)%a.length)};return(0,b.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-90",children:(0,b.jsxs)("div",{className:"relative w-full h-full flex flex-col",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center p-2 sm:p-4",children:[(0,b.jsx)("button",{onClick:l,title:"Close image viewer",className:"p-2 sm:p-3 text-white hover:bg-gray-800 rounded-full transition-colors touch-manipulation",children:(0,b.jsx)(d.X,{className:"h-5 w-5 sm:h-6 sm:w-6"})}),(0,b.jsxs)("div",{className:"flex items-center gap-1 sm:gap-2",children:[(0,b.jsx)("button",{onClick:D,title:"Zoom out",className:"p-1.5 sm:p-2 text-white hover:bg-gray-800 rounded-full transition-colors disabled:opacity-50 touch-manipulation",disabled:o<=.5,children:(0,b.jsx)(i,{className:"h-4 w-4 sm:h-5 sm:w-5"})}),(0,b.jsxs)("span",{className:"text-white text-xs sm:text-sm min-w-[2.5rem] sm:min-w-[3rem] text-center",children:[Math.round(100*o),"%"]}),(0,b.jsx)("button",{onClick:C,title:"Zoom in",className:"p-1.5 sm:p-2 text-white hover:bg-gray-800 rounded-full transition-colors disabled:opacity-50 touch-manipulation",disabled:o>=3,children:(0,b.jsx)(h,{className:"h-4 w-4 sm:h-5 sm:w-5"})}),(0,b.jsx)("button",{onClick:E,title:"Reset zoom",className:"p-1.5 sm:p-2 text-white hover:bg-gray-800 rounded-full transition-colors touch-manipulation hidden sm:block",children:(0,b.jsx)(j,{className:"h-4 w-4 sm:h-5 sm:w-5"})})]})]}),(0,b.jsx)("div",{ref:A,className:"flex-1 relative overflow-hidden flex items-center justify-center touch-none",onWheel:a=>{a.preventDefault(),a.deltaY<0?C():D()},onTouchStart:a=>{let b=a.touches;1===b.length?x({x:b[0].clientX,y:b[0].clientY,distance:0}):2===b.length&&x({x:0,y:0,distance:Math.hypot(b[1].clientX-b[0].clientX,b[1].clientY-b[0].clientY)})},onTouchMove:a=>{a.preventDefault();let b=a.touches;if(1===b.length&&w){if(o>1){let a=b[0].clientX-w.x,c=b[0].clientY-w.y;r(b=>({x:b.x+a,y:b.y+c})),x({...w,x:b[0].clientX,y:b[0].clientY})}}else if(2===b.length&&w&&w.distance>0){let a=Math.hypot(b[1].clientX-b[0].clientX,b[1].clientY-b[0].clientY);p(Math.min(Math.max(o*(a/w.distance),.5),3)),x({...w,distance:a})}},onTouchEnd:a=>{let b=new Date().getTime(),c=b-y;if(c<300&&c>0&&0===a.touches.length&&G(),z(b),w&&0===w.distance&&1===o){let b=a.changedTouches[0],c=b.clientX-w.x,d=b.clientY-w.y,e=Math.abs(c),f=Math.abs(d);e>50&&e>f&&(c>0?H():I())}x(null)},onMouseDown:a=>{o>1&&(t(!0),v({x:a.clientX-q.x,y:a.clientY-q.y}))},onMouseMove:a=>{s&&o>1&&r({x:a.clientX-u.x,y:a.clientY-u.y})},onMouseUp:F,onMouseLeave:F,children:(0,b.jsx)("div",{className:"relative",style:{"--scale":o,"--translate-x":`${q.x/o}px`,"--translate-y":`${q.y/o}px`,transform:"scale(var(--scale)) translate(var(--translate-x), var(--translate-y))",transition:s?"none":"transform 0.2s ease-out",cursor:o>1?s?"grabbing":"grab":"pointer"},onDoubleClick:G,children:(0,b.jsx)("img",{ref:B,src:a[m],alt:`Property image ${m+1}`,className:"max-w-full max-h-full object-contain select-none touch-none",draggable:!1})})}),a.length>1&&(0,b.jsxs)("div",{className:"flex justify-between items-center p-2 sm:p-4",children:[(0,b.jsx)("button",{onClick:H,title:"Previous image",className:"p-2 sm:p-3 bg-white bg-opacity-20 hover:bg-opacity-30 rounded-full transition-all touch-manipulation",disabled:0===m,children:(0,b.jsx)(e.ChevronLeft,{className:"h-4 w-4 sm:h-5 sm:w-5"})}),(0,b.jsxs)("div",{className:"text-white text-xs sm:text-sm",children:[m+1," / ",a.length]}),(0,b.jsx)("button",{onClick:I,title:"Next image",className:"p-2 sm:p-3 bg-white bg-opacity-20 hover:bg-opacity-30 rounded-full transition-all touch-manipulation",disabled:m===a.length-1,children:(0,b.jsx)(f.ChevronRight,{className:"h-4 w-4 sm:h-5 sm:w-5"})})]}),(0,b.jsx)("div",{className:"block sm:hidden text-center text-white text-xs opacity-75 p-2",children:(0,b.jsx)("p",{children:"Swipe to navigate • Pinch to zoom • Double-tap to zoom"})})]})})}a.s(["default",()=>k],75098)}];

//# sourceMappingURL=src_components_listing_785ac0e8._.js.map