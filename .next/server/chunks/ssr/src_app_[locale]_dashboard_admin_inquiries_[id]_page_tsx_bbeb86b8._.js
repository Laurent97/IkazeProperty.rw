module.exports=[96392,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(38246),f=a.i(210),g=a.i(63588),h=a.i(81010),i=a.i(48464),j=a.i(79161),k=a.i(83497),l=a.i(46842),m=a.i(41675),n=a.i(16201),o=a.i(62722);a.i(41710);var p=a.i(24569),q=a.i(14548);let r=(0,a.i(70106).default)("ban",[["path",{d:"M4.929 4.929 19.07 19.071",key:"196cmz"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);var s=a.i(99570),t=a.i(91119),u=a.i(29246),v=a.i(86304),w=a.i(11642),x=a.i(15044);function y(){let y=(0,d.useParams)();(0,d.useRouter)();let{user:z,isLoading:A}=(0,w.useAuth)(),[B,C]=(0,c.useState)(null),[D,E]=(0,c.useState)(!0),[F,G]=(0,c.useState)(!1),[H,I]=(0,c.useState)(""),[J,K]=(0,c.useState)(!1),[L,M]=(0,c.useState)(!1),N=y.id;(0,c.useEffect)(()=>{z&&!A&&O()},[z,A,N]);let O=async()=>{try{if(E(!0),!z)return;let{supabaseClient:b}=await a.A(53215),{data:{session:c}}=await b.auth.getSession();if(!c?.access_token)return;let d=await fetch("/api/inquiries?role=admin",{headers:{Authorization:`Bearer ${c.access_token}`}});if(!d.ok)throw Error("Failed to fetch inquiry");let e=((await d.json()).data||[]).find(a=>a.id===N);if(!e)throw Error("Inquiry not found");C(e),I(e.admin_notes||"")}catch(a){console.error("Error fetching inquiry:",a)}finally{E(!1)}},P=async b=>{try{G(!0);let{supabaseClient:c}=await a.A(53215),{data:{session:d}}=await c.auth.getSession();if(!d?.access_token)throw Error("No session token");let e=await fetch("/api/inquiries",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${d.access_token}`},body:JSON.stringify({inquiry_id:N,status:b,admin_notes:H})});if(!e.ok){let a=await e.json();throw Error(a.error||"Failed to update inquiry")}await O(),K(!1)}catch(a){console.error("Error updating inquiry:",a),alert("Error updating inquiry. Please try again.")}finally{G(!1)}},Q=async()=>{try{G(!0);let{supabaseClient:b}=await a.A(53215),{data:{session:c}}=await b.auth.getSession();if(!c?.access_token)throw Error("No session token");let d=await fetch("/api/inquiries",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${c.access_token}`},body:JSON.stringify({inquiry_id:N,status:B.status,admin_notes:H})});if(!d.ok){let a=await d.json();throw Error(a.error||"Failed to update admin notes")}await O(),K(!1)}catch(a){console.error("Error updating admin notes:",a),alert("Error updating admin notes. Please try again.")}finally{G(!1)}},R=a=>{switch(a){case"pending":return(0,b.jsx)(v.Badge,{className:"bg-yellow-100 text-yellow-800",children:"Pending"});case"approved":return(0,b.jsx)(v.Badge,{className:"bg-green-100 text-green-800",children:"Approved"});case"rejected":return(0,b.jsx)(v.Badge,{className:"bg-red-100 text-red-800",children:"Rejected"});case"connected":return(0,b.jsx)(v.Badge,{className:"bg-blue-100 text-blue-800",children:"Connected"});default:return(0,b.jsx)(v.Badge,{className:"bg-gray-100 text-gray-800",children:"Unknown"})}};return A||D?(0,b.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-red-600 mx-auto"}),(0,b.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading inquiry details..."})]})}):z?B?(0,b.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,b.jsx)("div",{className:"bg-white border-b border-gray-200",children:(0,b.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center",children:[(0,b.jsx)(e.default,{href:"/dashboard/admin/inquiries",children:(0,b.jsxs)(s.Button,{variant:"outline",className:"mr-4",children:[(0,b.jsx)(f.ArrowLeft,{className:"h-4 w-4 mr-2"}),"Back to Inquiries"]})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Inquiry Details"}),(0,b.jsx)("p",{className:"text-gray-600",children:"Review and manage this inquiry"})]})]}),(0,b.jsx)("div",{className:"flex items-center space-x-2",children:R(B.status)})]})})}),(0,b.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,b.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[(0,b.jsxs)(t.Card,{children:[(0,b.jsx)(t.CardHeader,{children:(0,b.jsxs)(t.CardTitle,{className:"flex items-center",children:[(a=>{switch(a){case"house":return(0,b.jsx)(h.Home,{className:"h-5 w-5"});case"car":return(0,b.jsx)(i.Car,{className:"h-5 w-5"});case"land":return(0,b.jsx)(j.Trees,{className:"h-5 w-5"});default:return(0,b.jsx)(k.Package,{className:"h-5 w-5"})}})(B.listings?.category),(0,b.jsx)("span",{className:"ml-2",children:"Listing Information"})]})}),(0,b.jsx)(t.CardContent,{children:(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:B.listings?.title||"N/A"}),(0,b.jsxs)("p",{className:"text-2xl font-bold text-red-600",children:["$",B.listings?.price?.toLocaleString()||"N/A"]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"Category"}),(0,b.jsx)("p",{className:"font-medium",children:B.listings?.category||"N/A"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"Listing ID"}),(0,b.jsx)("p",{className:"font-medium",children:B.listings?.id||"N/A"})]})]}),(0,b.jsx)(e.default,{href:`/listings/${B.listings?.category}/${B.listings?.id}`,children:(0,b.jsx)(s.Button,{variant:"outline",className:"w-full",children:"View Full Listing"})})]})})]}),(0,b.jsxs)(t.Card,{children:[(0,b.jsx)(t.CardHeader,{children:(0,b.jsxs)(t.CardTitle,{className:"flex items-center",children:[(0,b.jsx)(l.User,{className:"h-5 w-5 mr-2"}),"Buyer Information"]})}),(0,b.jsx)(t.CardContent,{children:(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"Name"}),(0,b.jsx)("p",{className:"font-medium",children:B.buyer?.full_name||"N/A"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"Email"}),(0,b.jsx)("p",{className:"font-medium",children:B.buyer?.email||"N/A"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"User ID"}),(0,b.jsx)("p",{className:"font-medium text-sm",children:B.buyer_id})]})]})})]}),(0,b.jsxs)(t.Card,{children:[(0,b.jsx)(t.CardHeader,{children:(0,b.jsxs)(t.CardTitle,{className:"flex items-center",children:[(0,b.jsx)(l.User,{className:"h-5 w-5 mr-2"}),"Seller Information"]})}),(0,b.jsx)(t.CardContent,{children:(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"Name"}),(0,b.jsx)("p",{className:"font-medium",children:B.seller?.full_name||"N/A"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"Email"}),(0,b.jsx)("p",{className:"font-medium",children:B.seller?.email||"N/A"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"User ID"}),(0,b.jsx)("p",{className:"font-medium text-sm",children:B.seller_id})]})]})})]}),(0,b.jsxs)(t.Card,{children:[(0,b.jsx)(t.CardHeader,{children:(0,b.jsxs)(t.CardTitle,{className:"flex items-center",children:[(0,b.jsx)(g.MessageSquare,{className:"h-5 w-5 mr-2"}),"Buyer's Message"]})}),(0,b.jsxs)(t.CardContent,{children:[(0,b.jsx)("div",{className:"bg-gray-50 rounded-lg p-4",children:(0,b.jsx)("p",{className:"text-gray-700 whitespace-pre-wrap",children:B.message||"No message provided"})}),(0,b.jsxs)("div",{className:"mt-4 flex items-center text-sm text-gray-600",children:[(0,b.jsx)(m.Calendar,{className:"h-4 w-4 mr-1"}),"Sent on ",new Date(B.created_at).toLocaleDateString()," at ",new Date(B.created_at).toLocaleTimeString()]})]})]})]}),(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)(t.Card,{children:[(0,b.jsx)(t.CardHeader,{children:(0,b.jsx)(t.CardTitle,{children:"Status Management"})}),(0,b.jsx)(t.CardContent,{children:(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("span",{className:"text-sm font-medium",children:"Current Status"}),R(B.status)]}),"pending"===B.status&&(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)(s.Button,{onClick:()=>P("approved"),disabled:F,className:"w-full bg-green-600 hover:bg-green-700",children:[(0,b.jsx)(n.CheckCircle,{className:"h-4 w-4 mr-2"}),"Approve Inquiry"]}),(0,b.jsxs)(s.Button,{onClick:()=>P("rejected"),disabled:F,variant:"outline",className:"w-full border-red-600 text-red-600 hover:bg-red-50",children:[(0,b.jsx)(o.XCircle,{className:"h-4 w-4 mr-2"}),"Reject Inquiry"]})]})]})})]}),(0,b.jsxs)(t.Card,{children:[(0,b.jsx)(t.CardHeader,{children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)(t.CardTitle,{children:"Admin Notes"}),(0,b.jsx)(s.Button,{size:"sm",variant:"outline",onClick:()=>K(!J),children:J?(0,b.jsx)(r,{className:"h-4 w-4"}):(0,b.jsx)(p.Edit,{className:"h-4 w-4"})})]})}),(0,b.jsx)(t.CardContent,{children:J?(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)(u.Textarea,{value:H,onChange:a=>I(a.target.value),placeholder:"Add your notes about this inquiry...",rows:6,className:"w-full"}),(0,b.jsxs)("div",{className:"flex space-x-2",children:[(0,b.jsxs)(s.Button,{onClick:Q,disabled:F,className:"flex-1",children:[(0,b.jsx)(q.Save,{className:"h-4 w-4 mr-2"}),"Save Notes"]}),(0,b.jsx)(s.Button,{onClick:()=>{K(!1),I(B.admin_notes||"")},variant:"outline",disabled:F,children:"Cancel"})]})]}):(0,b.jsx)("div",{children:H?(0,b.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:(0,b.jsx)("p",{className:"text-blue-800 whitespace-pre-wrap",children:H})}):(0,b.jsx)("p",{className:"text-gray-500 italic",children:"No admin notes yet. Click the edit button to add notes."})})})]}),(0,b.jsxs)(t.Card,{children:[(0,b.jsx)(t.CardHeader,{children:(0,b.jsx)(t.CardTitle,{children:"Live Chat"})}),(0,b.jsxs)(t.CardContent,{children:[(0,b.jsxs)(s.Button,{onClick:()=>M(!0),className:"w-full bg-blue-600 hover:bg-blue-700",disabled:!B?.buyer,children:[(0,b.jsx)(g.MessageSquare,{className:"h-4 w-4 mr-2"}),"Chat with Customer"]}),(0,b.jsxs)("p",{className:"text-xs text-gray-600 mt-2",children:["Start a real-time conversation with ",B?.buyer?.full_name||"the customer"]})]})]}),(0,b.jsxs)(t.Card,{children:[(0,b.jsx)(t.CardHeader,{children:(0,b.jsx)(t.CardTitle,{children:"Timeline"})}),(0,b.jsx)(t.CardContent,{children:(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,b.jsx)("div",{className:"flex-shrink-0",children:(0,b.jsx)("div",{className:"w-2 h-2 bg-blue-600 rounded-full mt-2"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium",children:"Inquiry Created"}),(0,b.jsxs)("p",{className:"text-xs text-gray-600",children:[new Date(B.created_at).toLocaleDateString()," at ",new Date(B.created_at).toLocaleTimeString()]})]})]}),B.updated_at&&(0,b.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,b.jsx)("div",{className:"flex-shrink-0",children:(0,b.jsx)("div",{className:"w-2 h-2 bg-green-600 rounded-full mt-2"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium",children:"Last Updated"}),(0,b.jsxs)("p",{className:"text-xs text-gray-600",children:[new Date(B.updated_at).toLocaleDateString()," at ",new Date(B.updated_at).toLocaleTimeString()]})]})]})]})})]})]})]})}),B&&(0,b.jsx)(x.default,{inquiryId:N,customerId:B.buyer_id,customerName:B.buyer?.full_name||"Customer",customerEmail:B.buyer?.email||"",isOpen:L,onToggle:()=>M(!L),userType:"admin"})]}):(0,b.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("p",{className:"text-gray-600",children:"Inquiry not found."}),(0,b.jsx)(e.default,{href:"/dashboard/admin/inquiries",children:(0,b.jsx)(s.Button,{className:"mt-4",children:"Back to Inquiries"})})]})}):(0,b.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("p",{className:"text-gray-600",children:"You must be logged in to view this page."}),(0,b.jsx)(e.default,{href:"/auth/login",children:(0,b.jsx)(s.Button,{className:"mt-4",children:"Log In"})})]})})}a.s(["default",()=>y],96392)}];

//# sourceMappingURL=src_app_%5Blocale%5D_dashboard_admin_inquiries_%5Bid%5D_page_tsx_bbeb86b8._.js.map