(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,86536,e=>{"use strict";let s=(0,e.i(75254).default)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);e.s(["Eye",()=>s],86536)},55436,e=>{"use strict";let s=(0,e.i(75254).default)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]);e.s(["Search",()=>s],55436)},93479,e=>{"use strict";var s=e.i(43476);let t=e.i(71645).forwardRef(({className:e,type:t,...a},l)=>(0,s.jsx)("input",{type:t,className:`flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 ${e||""}`,ref:l,...a}));t.displayName="Input",e.s(["Input",()=>t])},87130,e=>{"use strict";let s=(0,e.i(75254).default)("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]]);e.s(["Filter",()=>s],87130)},52200,e=>{"use strict";var s=e.i(43476),t=e.i(43432),a=e.i(63488),l=e.i(46897),i=e.i(75240);function r({className:e=""}){let{getPlatformInfo:r}=(0,i.usePaymentMethods)(),n=r();return(0,s.jsxs)("div",{className:`text-xs text-gray-600 space-y-1 ${e}`,children:[(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(t.Phone,{className:"h-3 w-3 mr-2 text-gray-500"}),(0,s.jsx)("span",{children:n.phone})]}),(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(a.Mail,{className:"h-3 w-3 mr-2 text-gray-500"}),(0,s.jsx)("span",{children:n.email})]}),(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(l.MapPin,{className:"h-3 w-3 mr-2 text-gray-500"}),(0,s.jsx)("span",{children:n.address})]})]})}e.s(["default",()=>r])},23066,e=>{"use strict";var s=e.i(43476),t=e.i(71645),a=e.i(90597),l=e.i(19455),i=e.i(86909);function r({listingId:e,className:r="",size:n="md",showText:d=!1}){let[o,c]=(0,t.useState)(!1),[m,x]=(0,t.useState)(!0),[h,u]=(0,t.useState)(null),[g,p]=(0,t.useState)(null),b={sm:"h-8 w-8",md:"h-10 w-10",lg:"h-12 w-12"},f={sm:"h-4 w-4",md:"h-5 w-5",lg:"h-6 w-6"};(0,t.useEffect)(()=>{(async()=>{try{let s=await (0,i.getCurrentUser)();if(!s)return void x(!1);u(s);let{data:t}=await i.supabase.from("listings").select("likes").eq("id",e).single();p(t);let{data:a,error:l}=await i.supabase.from("favorite_listings").select("*").eq("user_id",s.id).eq("listing_id",e).single();l&&"PGRST116"!==l.code?console.error("Error checking favorite status:",l):c(!!a)}catch(e){console.error("Error checking favorite status:",e)}finally{x(!1)}})()},[e]);let v=async()=>{if(!h)return void alert("Please login to favorite listings");try{if(o){let{error:s}=await i.supabase.from("favorite_listings").delete().eq("user_id",h.id).eq("listing_id",e);if(s)throw s;c(!1),await i.supabase.rpc("sql",{sql:`SELECT decrement_likes('${e}')`})}else{let{error:s}=await i.supabase.from("favorite_listings").insert({user_id:h.id,listing_id:e});if(s)throw s;c(!0),await i.supabase.rpc("sql",{sql:`SELECT increment_likes('${e}')`})}}catch(e){console.error("Error toggling favorite:",e),alert("Error updating favorites. Please try again.")}};return m?(0,s.jsx)(l.Button,{variant:"outline",className:`${r} ${b[n]}`,disabled:!0,children:(0,s.jsx)(a.Heart,{className:`${f[n]} animate-pulse`})}):(0,s.jsxs)(l.Button,{variant:"outline",className:`${r} ${b[n]} ${o?"bg-red-50 border-red-200 text-red-600 hover:bg-red-100":"hover:bg-red-50 hover:border-red-200 hover:text-red-600"}`,onClick:v,title:o?"Remove from favorites":"Add to favorites",children:[(0,s.jsx)(a.Heart,{className:`${f[n]} ${o?"fill-current":""}`}),d&&(0,s.jsx)("span",{className:"ml-2",children:o?"Favorited":"Favorite"})]})}e.s(["default",()=>r])},88503,e=>{"use strict";var s=e.i(43476),t=e.i(71645),a=e.i(22016),l=e.i(55436),i=e.i(87130),r=e.i(46897),n=e.i(75254);let d=(0,n.default)("bed",[["path",{d:"M2 4v16",key:"vw9hq8"}],["path",{d:"M2 8h18a2 2 0 0 1 2 2v10",key:"1dgv2r"}],["path",{d:"M2 17h20",key:"18nfp3"}],["path",{d:"M6 8v9",key:"1yriud"}]]),o=(0,n.default)("bath",[["path",{d:"M10 4 8 6",key:"1rru8s"}],["path",{d:"M17 19v2",key:"ts1sot"}],["path",{d:"M2 12h20",key:"9i4pu4"}],["path",{d:"M7 19v2",key:"12npes"}],["path",{d:"M9 5 7.621 3.621A2.121 2.121 0 0 0 4 5v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-5",key:"14ym8i"}]]),c=(0,n.default)("square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);var m=e.i(90597),x=e.i(86536),h=e.i(94351),u=e.i(19455),g=e.i(15288),p=e.i(52200),b=e.i(23066),f=e.i(87486),v=e.i(93479),j=e.i(90676);function y(){let[e,n]=(0,t.useState)(""),[y,N]=(0,t.useState)({min:"",max:""}),[w,_]=(0,t.useState)(""),[k,C]=(0,t.useState)(""),[S,E]=(0,t.useState)("all"),[F,M]=(0,t.useState)([]),[L,$]=(0,t.useState)(!0),[q,A]=(0,t.useState)("");(0,t.useEffect)(()=>{I()},[]);let I=async()=>{try{$(!0),A(""),console.log("Starting to fetch house listings...");let{data:e,error:s}=await j.supabaseClient.from("listings").select("*").eq("category","houses").eq("status","available").order("created_at",{ascending:!1});if(s){console.error("Error fetching basic listings:",s),A(`Failed to load listings: ${s.message}`);return}if(console.log(`Found ${e?.length||0} listings`),!e||0===e.length){M([]),$(!1);return}let t=e.map(e=>e.id),[{data:a,error:l},{data:i,error:r},{data:n,error:d}]=await Promise.all([j.supabaseClient.from("users").select("id, full_name, email, avatar_url, phone_number, verified").in("id",e.map(e=>e.seller_id)),j.supabaseClient.from("listing_media").select("id, listing_id, url, public_id, media_type, order_index, is_primary").in("listing_id",t).order("order_index"),j.supabaseClient.from("house_details").select("*").in("listing_id",t)]);l&&console.error("Error fetching sellers:",l),r&&console.error("Error fetching media:",r),d&&console.error("Error fetching house details:",d);let{data:o}=await j.supabaseClient.from("promoted_listings").select("listing_id, status, end_date").in("listing_id",t).eq("status","active").gt("end_date",new Date().toISOString()),c=e.map(e=>{let s=a?.find(s=>s.id===e.seller_id),t=i?.filter(s=>s.listing_id===e.id)||[],l=n?.find(s=>s.listing_id===e.id),r=o?.some(s=>s.listing_id===e.id);return{...e,seller:s?{id:s.id,full_name:s.full_name,email:s.email,avatar_url:s.avatar_url}:null,media:t.map(e=>({url:e.url,public_id:e.public_id,media_type:e.media_type,is_primary:e.is_primary,order_index:e.order_index})),house_details:l?{bedrooms:l.bedrooms,bathrooms:l.bathrooms,total_area:l.total_area,furnished:l.furnished}:void 0,promoted:r||e.promoted}});console.log("Successfully combined data for",c.length,"listings"),M(c)}catch(e){console.error("Error in fetchListings:",e),A(`Failed to load listings: ${e?.message||"Unknown error"}`)}finally{$(!1)}},P=e=>{if(!e)return"Location not specified";if("string"==typeof e)try{e=JSON.parse(e)}catch{return e}if("object"==typeof e){let s=e;return s?.district||s?.sector||s?.cell||s?.village||s?.city||s?.province||s?.address||"Location not specified"}return"Location not specified"},R=F.filter(s=>{let t=s.title.toLowerCase().includes(e.toLowerCase())||P(s.location).toLowerCase().includes(e.toLowerCase()),a=(!y.min||s.price>=parseInt(y.min))&&(!y.max||s.price<=parseInt(y.max)),l=!w||s.house_details?.bedrooms&&s.house_details.bedrooms>=parseInt(w),i=!k||s.house_details?.bathrooms&&s.house_details.bathrooms>=parseInt(k),r="all"===S||s.transaction_type===S;return t&&a&&l&&i&&r});return(0,s.jsxs)("div",{className:"min-h-screen bg-gray-50 no-overflow-x",children:[(0,s.jsx)("div",{className:"bg-white border-b border-gray-200",children:(0,s.jsx)("div",{className:"max-w-7xl mx-auto px-3 sm:px-4 lg:px-6 py-4 sm:py-6",children:(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900 flex items-center",children:[(0,s.jsx)(h.Home,{className:"h-6 w-6 sm:h-8 sm:w-8 mr-2 sm:mr-3 text-red-600"}),"Houses & Apartments"]}),(0,s.jsxs)("p",{className:"text-gray-600 mt-1 sm:mt-2 text-sm sm:text-base",children:["Find your perfect home from ",F.length," listings"]})]}),(0,s.jsx)(a.default,{href:"/create-listing?category=houses",children:(0,s.jsx)(u.Button,{className:"bg-red-600 hover:bg-red-700 w-full sm:w-auto touch-target",children:"List Property"})})]})})}),(0,s.jsx)("div",{className:"max-w-7xl mx-auto px-3 sm:px-4 lg:px-6 py-4 sm:py-8",children:(0,s.jsxs)("div",{className:"flex flex-col lg:flex-row gap-6 lg:gap-8",children:[(0,s.jsx)("div",{className:"lg:w-80",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 sm:p-6",children:[(0,s.jsxs)("div",{className:"flex items-center mb-4",children:[(0,s.jsx)(i.Filter,{className:"h-4 w-4 sm:h-5 sm:w-5 mr-2 text-gray-600"}),(0,s.jsx)("h2",{className:"text-base sm:text-lg font-semibold text-gray-900",children:"Filters"})]}),(0,s.jsxs)("div",{className:"mb-4 sm:mb-6",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Search"}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(l.Search,{className:"absolute left-3 top-2.5 sm:top-3 h-4 w-4 text-gray-400"}),(0,s.jsx)(v.Input,{type:"text",placeholder:"Search by title or location...",value:e,onChange:e=>n(e.target.value),className:"pl-10 text-sm"})]})]}),(0,s.jsxs)("div",{className:"mb-4 sm:mb-6",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Price Range (RWF)"}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(v.Input,{type:"number",placeholder:"Min",value:y.min,onChange:e=>N(s=>({...s,min:e.target.value})),className:"text-sm"}),(0,s.jsx)(v.Input,{type:"number",placeholder:"Max",value:y.max,onChange:e=>N(s=>({...s,max:e.target.value})),className:"text-sm"})]})]}),(0,s.jsxs)("div",{className:"mb-4 sm:mb-6",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Bedrooms"}),(0,s.jsxs)("select",{value:w,onChange:e=>_(e.target.value),className:"w-full h-10 rounded-md border border-input bg-background px-3 py-2 text-sm","aria-label":"Number of bedrooms",title:"Filter by number of bedrooms",children:[(0,s.jsx)("option",{value:"",children:"Any"}),(0,s.jsx)("option",{value:"1",children:"1+"}),(0,s.jsx)("option",{value:"2",children:"2+"}),(0,s.jsx)("option",{value:"3",children:"3+"}),(0,s.jsx)("option",{value:"4",children:"4+"}),(0,s.jsx)("option",{value:"5",children:"5+"})]})]}),(0,s.jsxs)("div",{className:"mb-4 sm:mb-6",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Bathrooms"}),(0,s.jsxs)("select",{value:k,onChange:e=>C(e.target.value),className:"w-full h-10 rounded-md border border-input bg-background px-3 py-2 text-sm","aria-label":"Number of bathrooms",title:"Filter by number of bathrooms",children:[(0,s.jsx)("option",{value:"",children:"Any"}),(0,s.jsx)("option",{value:"1",children:"1+"}),(0,s.jsx)("option",{value:"2",children:"2+"}),(0,s.jsx)("option",{value:"3",children:"3+"}),(0,s.jsx)("option",{value:"4",children:"4+"})]})]}),(0,s.jsxs)("div",{className:"mb-4 sm:mb-6",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Type"}),(0,s.jsxs)("select",{value:S,onChange:e=>E(e.target.value),className:"w-full h-10 rounded-md border border-input bg-background px-3 py-2 text-sm","aria-label":"Transaction type",title:"Filter by transaction type",children:[(0,s.jsx)("option",{value:"all",children:"All"}),(0,s.jsx)("option",{value:"sale",children:"For Sale"}),(0,s.jsx)("option",{value:"rent",children:"For Rent"})]})]})]})}),(0,s.jsxs)("div",{className:"flex-1",children:[L&&(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-red-600 mx-auto"}),(0,s.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading listings..."})]}),q&&!L&&(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)("div",{className:"text-red-600 text-6xl mb-4",children:"âš ï¸"}),(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Unable to load listings"}),(0,s.jsx)("p",{className:"text-gray-600 mb-4",children:q}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Common issues:"}),(0,s.jsxs)("ul",{className:"text-sm text-gray-500 list-disc list-inside",children:[(0,s.jsx)("li",{children:"Check your Supabase connection"}),(0,s.jsx)("li",{children:"Verify you have house listings in your database"}),(0,s.jsx)("li",{children:"Ensure RLS policies allow reading listings"})]})]}),(0,s.jsx)(u.Button,{onClick:I,className:"mt-4 bg-red-600 hover:bg-red-700",children:"Try Again"})]}),!L&&!q&&0===R.length&&(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)("div",{className:"text-gray-400 text-6xl mb-4",children:"ðŸ "}),(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No houses found"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Try adjusting your filters or search criteria"}),(0,s.jsx)(u.Button,{variant:"outline",className:"w-full border-red-600 text-red-600 hover:bg-red-50 touch-target",onClick:()=>{n(""),N({min:"",max:""}),_(""),C(""),E("all")},children:"Clear Filters"})]}),!L&&!q&&R.length>0&&(0,s.jsx)("div",{className:"grid grid-cols-1 xs:grid-cols-2 gap-4 sm:gap-6",children:R.map(e=>{let t,l;return(0,s.jsx)(g.Card,{className:"hover:shadow-lg transition-shadow group",children:(0,s.jsxs)(g.CardContent,{className:"p-0",children:[(0,s.jsx)("div",{className:"relative",children:e.media&&e.media.length>0?(0,s.jsxs)("div",{className:"relative",children:["video"===e.media[0].media_type?(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("video",{src:e.media[0].url,className:"w-full h-40 sm:h-48 object-cover",muted:!0,playsInline:!0}),(0,s.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-black bg-opacity-30",children:(0,s.jsx)("div",{className:"w-10 h-10 sm:w-12 sm:h-12 bg-white bg-opacity-90 rounded-full flex items-center justify-center",children:(0,s.jsx)("svg",{className:"w-4 h-4 sm:w-6 sm:h-6 text-gray-800 ml-1",fill:"currentColor",viewBox:"0 0 20 20",children:(0,s.jsx)("path",{d:"M6.3 2.841A1.5 1.5 0 004 4.11V15.89a1.5 1.5 0 002.3 1.269l9.344-5.89a1.5 1.5 0 000-2.538L6.3 2.84z"})})})})]}):(0,s.jsx)("img",{src:e.media[0].url,alt:e.title,className:"w-full h-40 sm:h-48 object-cover",onError:e=>{e.target.src="https://via.placeholder.com/400x300/cccccc/969696?text=House+Image"}}),e.media[0].is_primary&&(0,s.jsx)(f.Badge,{className:"absolute top-2 left-2 bg-red-600 text-white text-xs",children:"Primary"}),e.featured&&(0,s.jsx)("div",{className:"absolute top-2 left-2 bg-red-600 text-white px-2 py-1 rounded text-xs font-semibold",children:"FEATURED"}),e.promoted&&(0,s.jsx)("div",{className:"absolute top-2 right-2 bg-yellow-500 text-white px-2 py-1 rounded text-xs font-semibold",children:"PROMOTED"})]}):(0,s.jsx)("div",{className:"w-full h-40 sm:h-48 bg-gray-200 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"text-gray-400 text-3xl sm:text-4xl mb-2",children:"ðŸ“·"}),(0,s.jsx)("p",{className:"text-gray-500 text-xs sm:text-sm",children:"No media available"})]})})}),(0,s.jsxs)("div",{className:"p-4 sm:p-6",children:[(0,s.jsxs)("div",{className:"mb-3 sm:mb-4",children:[(0,s.jsx)("h3",{className:"text-base sm:text-lg font-semibold text-gray-900 mb-2 line-clamp-2",children:e.title}),(0,s.jsx)("div",{className:"text-lg sm:text-2xl font-bold text-red-600",children:(t=e.price,l=e.currency,new Intl.NumberFormat("en-RW",{style:"currency",currency:"RWF"===l?"RWF":"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(t))})]}),e.house_details&&(0,s.jsxs)("div",{className:"flex flex-wrap items-center gap-2 sm:gap-4 text-xs sm:text-sm text-gray-600 mb-3 sm:mb-4",children:[e.house_details.bedrooms&&(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(d,{className:"h-3 w-3 sm:h-4 sm:w-4"}),e.house_details.bedrooms," beds"]}),e.house_details.bathrooms&&(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(o,{className:"h-3 w-3 sm:h-4 sm:w-4"}),e.house_details.bathrooms," baths"]}),e.house_details.total_area&&(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(c,{className:"h-3 w-3 sm:h-4 sm:w-4"}),e.house_details.total_area,"mÂ²"]})]}),(0,s.jsxs)("div",{className:"flex items-center text-gray-500 text-xs sm:text-sm mb-3 sm:mb-4",children:[(0,s.jsx)(r.MapPin,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-1"}),P(e.location)]}),(0,s.jsx)(p.default,{className:"mb-3 sm:mb-4"}),(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 sm:gap-3 text-xs sm:text-sm text-gray-500",children:[(0,s.jsxs)("span",{className:"flex items-center gap-1",children:[(0,s.jsx)(x.Eye,{className:"h-3 w-3 sm:h-4 sm:w-4"}),e.views||0]}),(0,s.jsxs)("span",{className:"flex items-center gap-1",children:[(0,s.jsx)(m.Heart,{className:"h-3 w-3 sm:h-4 sm:w-4"}),e.likes||0]}),(0,s.jsx)("span",{className:"text-xs text-gray-400",children:new Date(e.created_at).toLocaleDateString("en-US",{month:"short",day:"numeric"})})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(b.default,{listingId:e.id,size:"sm",className:"flex-shrink-0"}),(0,s.jsx)(u.Button,{asChild:!0,size:"sm",className:"touch-target",children:(0,s.jsx)(a.default,{href:`/listings/houses/${e.id}`,children:"View Details"})})]})]})]})]})},e.id)})})]})]})})]})}e.s(["default",()=>y],88503)}]);