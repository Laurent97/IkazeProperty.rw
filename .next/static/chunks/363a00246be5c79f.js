(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,86536,e=>{"use strict";let s=(0,e.i(75254).default)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);e.s(["Eye",()=>s],86536)},55436,e=>{"use strict";let s=(0,e.i(75254).default)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]);e.s(["Search",()=>s],55436)},93479,e=>{"use strict";var s=e.i(43476);let t=e.i(71645).forwardRef(({className:e,type:t,...a},r)=>(0,s.jsx)("input",{type:t,className:`flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 ${e||""}`,ref:r,...a}));t.displayName="Input",e.s(["Input",()=>t])},87486,e=>{"use strict";var s=e.i(43476);let t=(0,e.i(25913).cva)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function a({className:e,variant:a,...r}){return(0,s.jsx)("div",{className:t({variant:a,className:e}),...r})}e.s(["Badge",()=>a])},52200,e=>{"use strict";var s=e.i(43476),t=e.i(43432),a=e.i(63488),r=e.i(46897),l=e.i(75240);function i({className:e=""}){let{getPlatformInfo:i}=(0,l.usePaymentMethods)(),n=i();return(0,s.jsxs)("div",{className:`text-xs text-gray-600 space-y-1 ${e}`,children:[(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(t.Phone,{className:"h-3 w-3 mr-2 text-gray-500"}),(0,s.jsx)("span",{children:n.phone})]}),(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(a.Mail,{className:"h-3 w-3 mr-2 text-gray-500"}),(0,s.jsx)("span",{children:n.email})]}),(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(r.MapPin,{className:"h-3 w-3 mr-2 text-gray-500"}),(0,s.jsx)("span",{children:n.address})]})]})}e.s(["default",()=>i])},87130,e=>{"use strict";let s=(0,e.i(75254).default)("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]]);e.s(["Filter",()=>s],87130)},88503,e=>{"use strict";var s=e.i(43476),t=e.i(71645),a=e.i(22016),r=e.i(55436),l=e.i(87130),i=e.i(46897),n=e.i(75254);let d=(0,n.default)("bed",[["path",{d:"M2 4v16",key:"vw9hq8"}],["path",{d:"M2 8h18a2 2 0 0 1 2 2v10",key:"1dgv2r"}],["path",{d:"M2 17h20",key:"18nfp3"}],["path",{d:"M6 8v9",key:"1yriud"}]]),o=(0,n.default)("bath",[["path",{d:"M10 4 8 6",key:"1rru8s"}],["path",{d:"M17 19v2",key:"ts1sot"}],["path",{d:"M2 12h20",key:"9i4pu4"}],["path",{d:"M7 19v2",key:"12npes"}],["path",{d:"M9 5 7.621 3.621A2.121 2.121 0 0 0 4 5v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-5",key:"14ym8i"}]]),c=(0,n.default)("square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);var m=e.i(90597),x=e.i(86536),h=e.i(94351),u=e.i(19455),g=e.i(15288),p=e.i(52200),b=e.i(87486),f=e.i(93479),y=e.i(90676);function v(){let[e,n]=(0,t.useState)(""),[v,j]=(0,t.useState)({min:"",max:""}),[N,w]=(0,t.useState)(""),[_,k]=(0,t.useState)(""),[C,S]=(0,t.useState)("all"),[F,M]=(0,t.useState)([]),[L,A]=(0,t.useState)(!0),[E,I]=(0,t.useState)("");(0,t.useEffect)(()=>{R()},[]);let R=async()=>{try{A(!0),I(""),console.log("Starting to fetch house listings...");let{data:e,error:s}=await y.supabaseClient.from("listings").select("*").eq("category","houses").eq("status","available").order("created_at",{ascending:!1});if(s){console.error("Error fetching basic listings:",s),I(`Failed to load listings: ${s.message}`);return}if(console.log(`Found ${e?.length||0} listings`),!e||0===e.length){M([]),A(!1);return}let t=e.map(e=>e.id),[{data:a,error:r},{data:l,error:i},{data:n,error:d}]=await Promise.all([y.supabaseClient.from("users").select("id, full_name, email, avatar_url, phone_number, verified").in("id",e.map(e=>e.seller_id)),y.supabaseClient.from("listing_media").select("id, listing_id, url, public_id, media_type, order_index, is_primary").in("listing_id",t).order("order_index"),y.supabaseClient.from("house_details").select("*").in("listing_id",t)]);r&&console.error("Error fetching sellers:",r),i&&console.error("Error fetching media:",i),d&&console.error("Error fetching house details:",d);let{data:o}=await y.supabaseClient.from("promoted_listings").select("listing_id, status, end_date").in("listing_id",t).eq("status","active").gt("end_date",new Date().toISOString()),c=e.map(e=>{let s=a?.find(s=>s.id===e.seller_id),t=l?.filter(s=>s.listing_id===e.id)||[],r=n?.find(s=>s.listing_id===e.id),i=o?.some(s=>s.listing_id===e.id);return{...e,seller:s?{id:s.id,full_name:s.full_name,email:s.email,avatar_url:s.avatar_url}:null,media:t.map(e=>({url:e.url,public_id:e.public_id,media_type:e.media_type,is_primary:e.is_primary,order_index:e.order_index})),house_details:r?{bedrooms:r.bedrooms,bathrooms:r.bathrooms,total_area:r.total_area,furnished:r.furnished}:void 0,promoted:i||e.promoted}});console.log("Successfully combined data for",c.length,"listings"),M(c)}catch(e){console.error("Error in fetchListings:",e),I(`Failed to load listings: ${e?.message||"Unknown error"}`)}finally{A(!1)}},B=e=>{if(!e)return"Location not specified";if("string"==typeof e)try{e=JSON.parse(e)}catch{return e}if("object"==typeof e){let s=e;return s?.district||s?.sector||s?.cell||s?.village||s?.city||s?.province||s?.address||"Location not specified"}return"Location not specified"},P=F.filter(s=>{let t=s.title.toLowerCase().includes(e.toLowerCase())||B(s.location).toLowerCase().includes(e.toLowerCase()),a=(!v.min||s.price>=parseInt(v.min))&&(!v.max||s.price<=parseInt(v.max)),r=!N||s.house_details?.bedrooms&&s.house_details.bedrooms>=parseInt(N),l=!_||s.house_details?.bathrooms&&s.house_details.bathrooms>=parseInt(_),i="all"===C||s.transaction_type===C;return t&&a&&r&&l&&i});return(0,s.jsxs)("div",{className:"min-h-screen bg-gray-50 no-overflow-x",children:[(0,s.jsx)("div",{className:"bg-white border-b border-gray-200",children:(0,s.jsx)("div",{className:"max-w-7xl mx-auto px-3 sm:px-4 lg:px-6 py-4 sm:py-6",children:(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900 flex items-center",children:[(0,s.jsx)(h.Home,{className:"h-6 w-6 sm:h-8 sm:w-8 mr-2 sm:mr-3 text-red-600"}),"Houses & Apartments"]}),(0,s.jsxs)("p",{className:"text-gray-600 mt-1 sm:mt-2 text-sm sm:text-base",children:["Find your perfect home from ",F.length," listings"]})]}),(0,s.jsx)(a.default,{href:"/create-listing?category=houses",children:(0,s.jsx)(u.Button,{className:"bg-red-600 hover:bg-red-700 w-full sm:w-auto touch-target",children:"List Property"})})]})})}),(0,s.jsx)("div",{className:"max-w-7xl mx-auto px-3 sm:px-4 lg:px-6 py-4 sm:py-8",children:(0,s.jsxs)("div",{className:"flex flex-col lg:flex-row gap-6 lg:gap-8",children:[(0,s.jsx)("div",{className:"lg:w-80",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 sm:p-6",children:[(0,s.jsxs)("div",{className:"flex items-center mb-4",children:[(0,s.jsx)(l.Filter,{className:"h-4 w-4 sm:h-5 sm:w-5 mr-2 text-gray-600"}),(0,s.jsx)("h2",{className:"text-base sm:text-lg font-semibold text-gray-900",children:"Filters"})]}),(0,s.jsxs)("div",{className:"mb-4 sm:mb-6",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Search"}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(r.Search,{className:"absolute left-3 top-2.5 sm:top-3 h-4 w-4 text-gray-400"}),(0,s.jsx)(f.Input,{type:"text",placeholder:"Search by title or location...",value:e,onChange:e=>n(e.target.value),className:"pl-10 text-sm"})]})]}),(0,s.jsxs)("div",{className:"mb-4 sm:mb-6",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Price Range (RWF)"}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(f.Input,{type:"number",placeholder:"Min",value:v.min,onChange:e=>j(s=>({...s,min:e.target.value})),className:"text-sm"}),(0,s.jsx)(f.Input,{type:"number",placeholder:"Max",value:v.max,onChange:e=>j(s=>({...s,max:e.target.value})),className:"text-sm"})]})]}),(0,s.jsxs)("div",{className:"mb-4 sm:mb-6",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Bedrooms"}),(0,s.jsxs)("select",{value:N,onChange:e=>w(e.target.value),className:"w-full h-10 rounded-md border border-input bg-background px-3 py-2 text-sm","aria-label":"Number of bedrooms",title:"Filter by number of bedrooms",children:[(0,s.jsx)("option",{value:"",children:"Any"}),(0,s.jsx)("option",{value:"1",children:"1+"}),(0,s.jsx)("option",{value:"2",children:"2+"}),(0,s.jsx)("option",{value:"3",children:"3+"}),(0,s.jsx)("option",{value:"4",children:"4+"}),(0,s.jsx)("option",{value:"5",children:"5+"})]})]}),(0,s.jsxs)("div",{className:"mb-4 sm:mb-6",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Bathrooms"}),(0,s.jsxs)("select",{value:_,onChange:e=>k(e.target.value),className:"w-full h-10 rounded-md border border-input bg-background px-3 py-2 text-sm","aria-label":"Number of bathrooms",title:"Filter by number of bathrooms",children:[(0,s.jsx)("option",{value:"",children:"Any"}),(0,s.jsx)("option",{value:"1",children:"1+"}),(0,s.jsx)("option",{value:"2",children:"2+"}),(0,s.jsx)("option",{value:"3",children:"3+"}),(0,s.jsx)("option",{value:"4",children:"4+"})]})]}),(0,s.jsxs)("div",{className:"mb-4 sm:mb-6",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Type"}),(0,s.jsxs)("select",{value:C,onChange:e=>S(e.target.value),className:"w-full h-10 rounded-md border border-input bg-background px-3 py-2 text-sm","aria-label":"Transaction type",title:"Filter by transaction type",children:[(0,s.jsx)("option",{value:"all",children:"All"}),(0,s.jsx)("option",{value:"sale",children:"For Sale"}),(0,s.jsx)("option",{value:"rent",children:"For Rent"})]})]})]})}),(0,s.jsxs)("div",{className:"flex-1",children:[L&&(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-red-600 mx-auto"}),(0,s.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading listings..."})]}),E&&!L&&(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)("div",{className:"text-red-600 text-6xl mb-4",children:"âš ï¸"}),(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Unable to load listings"}),(0,s.jsx)("p",{className:"text-gray-600 mb-4",children:E}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Common issues:"}),(0,s.jsxs)("ul",{className:"text-sm text-gray-500 list-disc list-inside",children:[(0,s.jsx)("li",{children:"Check your Supabase connection"}),(0,s.jsx)("li",{children:"Verify you have house listings in your database"}),(0,s.jsx)("li",{children:"Ensure RLS policies allow reading listings"})]})]}),(0,s.jsx)(u.Button,{onClick:R,className:"mt-4 bg-red-600 hover:bg-red-700",children:"Try Again"})]}),!L&&!E&&0===P.length&&(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)("div",{className:"text-gray-400 text-6xl mb-4",children:"ðŸ "}),(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No houses found"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Try adjusting your filters or search criteria"}),(0,s.jsx)(u.Button,{variant:"outline",className:"w-full border-red-600 text-red-600 hover:bg-red-50 touch-target",onClick:()=>{n(""),j({min:"",max:""}),w(""),k(""),S("all")},children:"Clear Filters"})]}),!L&&!E&&P.length>0&&(0,s.jsx)("div",{className:"grid grid-cols-1 xs:grid-cols-2 gap-4 sm:gap-6",children:P.map(e=>{let t,r;return(0,s.jsx)(g.Card,{className:"hover:shadow-lg transition-shadow group",children:(0,s.jsxs)(g.CardContent,{className:"p-0",children:[(0,s.jsx)("div",{className:"relative",children:e.media&&e.media.length>0?(0,s.jsxs)("div",{className:"relative",children:["video"===e.media[0].media_type?(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("video",{src:e.media[0].url,className:"w-full h-40 sm:h-48 object-cover",muted:!0,playsInline:!0}),(0,s.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-black bg-opacity-30",children:(0,s.jsx)("div",{className:"w-10 h-10 sm:w-12 sm:h-12 bg-white bg-opacity-90 rounded-full flex items-center justify-center",children:(0,s.jsx)("svg",{className:"w-4 h-4 sm:w-6 sm:h-6 text-gray-800 ml-1",fill:"currentColor",viewBox:"0 0 20 20",children:(0,s.jsx)("path",{d:"M6.3 2.841A1.5 1.5 0 004 4.11V15.89a1.5 1.5 0 002.3 1.269l9.344-5.89a1.5 1.5 0 000-2.538L6.3 2.84z"})})})})]}):(0,s.jsx)("img",{src:e.media[0].url,alt:e.title,className:"w-full h-40 sm:h-48 object-cover",onError:e=>{e.target.src="https://via.placeholder.com/400x300/cccccc/969696?text=House+Image"}}),e.media[0].is_primary&&(0,s.jsx)(b.Badge,{className:"absolute top-2 left-2 bg-red-600 text-white text-xs",children:"Primary"}),e.featured&&(0,s.jsx)("div",{className:"absolute top-2 left-2 bg-red-600 text-white px-2 py-1 rounded text-xs font-semibold",children:"FEATURED"}),e.promoted&&(0,s.jsx)("div",{className:"absolute top-2 right-2 bg-yellow-500 text-white px-2 py-1 rounded text-xs font-semibold",children:"PROMOTED"})]}):(0,s.jsx)("div",{className:"w-full h-40 sm:h-48 bg-gray-200 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"text-gray-400 text-3xl sm:text-4xl mb-2",children:"ðŸ“·"}),(0,s.jsx)("p",{className:"text-gray-500 text-xs sm:text-sm",children:"No media available"})]})})}),(0,s.jsxs)("div",{className:"p-4 sm:p-6",children:[(0,s.jsxs)("div",{className:"mb-3 sm:mb-4",children:[(0,s.jsx)("h3",{className:"text-base sm:text-lg font-semibold text-gray-900 mb-2 line-clamp-2",children:e.title}),(0,s.jsx)("div",{className:"text-lg sm:text-2xl font-bold text-red-600",children:(t=e.price,r=e.currency,new Intl.NumberFormat("en-RW",{style:"currency",currency:"RWF"===r?"RWF":"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(t))})]}),e.house_details&&(0,s.jsxs)("div",{className:"flex flex-wrap items-center gap-2 sm:gap-4 text-xs sm:text-sm text-gray-600 mb-3 sm:mb-4",children:[e.house_details.bedrooms&&(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(d,{className:"h-3 w-3 sm:h-4 sm:w-4"}),e.house_details.bedrooms," beds"]}),e.house_details.bathrooms&&(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(o,{className:"h-3 w-3 sm:h-4 sm:w-4"}),e.house_details.bathrooms," baths"]}),e.house_details.total_area&&(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(c,{className:"h-3 w-3 sm:h-4 sm:w-4"}),e.house_details.total_area,"mÂ²"]})]}),(0,s.jsxs)("div",{className:"flex items-center text-gray-500 text-xs sm:text-sm mb-3 sm:mb-4",children:[(0,s.jsx)(i.MapPin,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-1"}),B(e.location)]}),(0,s.jsx)(p.default,{className:"mb-3 sm:mb-4"}),(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 sm:gap-3 text-xs sm:text-sm text-gray-500",children:[(0,s.jsxs)("span",{className:"flex items-center gap-1",children:[(0,s.jsx)(x.Eye,{className:"h-3 w-3 sm:h-4 sm:w-4"}),e.views||0]}),(0,s.jsxs)("span",{className:"flex items-center gap-1",children:[(0,s.jsx)(m.Heart,{className:"h-3 w-3 sm:h-4 sm:w-4"}),e.likes||0]}),(0,s.jsx)("span",{className:"text-xs text-gray-400",children:new Date(e.created_at).toLocaleDateString("en-US",{month:"short",day:"numeric"})})]}),(0,s.jsx)(u.Button,{asChild:!0,size:"sm",className:"touch-target",children:(0,s.jsx)(a.default,{href:`/listings/houses/${e.id}`,children:"View Details"})})]})]})]})},e.id)})})]})]})})]})}e.s(["default",()=>v],88503)}]);