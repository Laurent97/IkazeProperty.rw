(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,86536,e=>{"use strict";let s=(0,e.i(75254).default)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);e.s(["Eye",()=>s],86536)},61911,e=>{"use strict";let s=(0,e.i(75254).default)("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]);e.s(["Users",()=>s],61911)},71689,e=>{"use strict";let s=(0,e.i(75254).default)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);e.s(["ArrowLeft",()=>s],71689)},86311,e=>{"use strict";let s=(0,e.i(75254).default)("message-square",[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]]);e.s(["MessageSquare",()=>s],86311)},52200,e=>{"use strict";var s=e.i(43476),a=e.i(43432),t=e.i(63488),r=e.i(46897),l=e.i(75240);function i({className:e=""}){let{getPlatformInfo:i}=(0,l.usePaymentMethods)(),n=i();return(0,s.jsxs)("div",{className:`text-xs text-gray-600 space-y-1 ${e}`,children:[(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(a.Phone,{className:"h-3 w-3 mr-2 text-gray-500"}),(0,s.jsx)("span",{children:n.phone})]}),(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(t.Mail,{className:"h-3 w-3 mr-2 text-gray-500"}),(0,s.jsx)("span",{children:n.email})]}),(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(r.MapPin,{className:"h-3 w-3 mr-2 text-gray-500"}),(0,s.jsx)("span",{children:n.address})]})]})}e.s(["default",()=>i])},23066,e=>{"use strict";var s=e.i(43476),a=e.i(71645),t=e.i(90597),r=e.i(19455),l=e.i(86909);function i({listingId:e,className:i="",size:n="md",showText:c=!1}){let[d,o]=(0,a.useState)(!1),[m,x]=(0,a.useState)(!0),[h,u]=(0,a.useState)(null),[f,g]=(0,a.useState)(null),p={sm:"h-8 w-8",md:"h-10 w-10",lg:"h-12 w-12"},v={sm:"h-4 w-4",md:"h-5 w-5",lg:"h-6 w-6"};(0,a.useEffect)(()=>{(async()=>{try{let s=await (0,l.getCurrentUser)();if(!s)return void x(!1);u(s);let{data:a}=await l.supabase.from("listings").select("likes").eq("id",e).single();g(a);let t=await fetch(`/api/favorites?listingId=${e}`);if(t.ok){let e=await t.json();o(e.isFavorited||!1)}else console.error("Error checking favorite status:",t.statusText),o(!1)}catch(e){console.error("Error checking favorite status:",e)}finally{x(!1)}})()},[e]);let y=async()=>{if(!h)return void alert("Please login to favorite listings");try{if(d){let s=await fetch(`/api/favorites?listingId=${e}`,{method:"DELETE"});if(s.ok)o(!1);else{let e=await s.json();if("Not authenticated"===e.error)alert("Please login to manage favorites");else throw Error("Failed to remove favorite")}}else{let s=await fetch("/api/favorites",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({listingId:e})});if(s.ok)o(!0);else{let e=await s.json();if("Not authenticated"===e.error)alert("Please login to add favorites");else throw Error("Failed to add favorite")}}}catch(e){console.error("Error toggling favorite:",e),alert("Error updating favorites. Please try again.")}};return m?(0,s.jsx)(r.Button,{variant:"outline",className:`${i} ${p[n]}`,disabled:!0,children:(0,s.jsx)(t.Heart,{className:`${v[n]} animate-pulse`})}):(0,s.jsxs)(r.Button,{variant:"outline",className:`${i} ${p[n]} ${d?"bg-red-50 border-red-200 text-red-600 hover:bg-red-100":"hover:bg-red-50 hover:border-red-200 hover:text-red-600"}`,onClick:y,title:d?"Remove from favorites":"Add to favorites",children:[(0,s.jsx)(t.Heart,{className:`${v[n]} ${d?"fill-current":""}`}),c&&(0,s.jsx)("span",{className:"ml-2",children:d?"Favorited":"Favorite"})]})}e.s(["default",()=>i])},41383,42347,e=>{"use strict";var s=e.i(43476),a=e.i(71645),t=e.i(90597),r=e.i(61911),l=e.i(19455),i=e.i(75157);let n=a.forwardRef(({className:e,...a},t)=>(0,s.jsx)("div",{ref:t,className:(0,i.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",e),...a}));n.displayName="Avatar";let c=a.forwardRef(({className:e,...a},t)=>(0,s.jsx)("img",{ref:t,className:(0,i.cn)("aspect-square h-full w-full object-cover",e),...a}));c.displayName="AvatarImage";let d=a.forwardRef(({className:e,...a},t)=>(0,s.jsx)("div",{ref:t,className:(0,i.cn)("flex h-full w-full items-center justify-center rounded-full bg-gray-100 text-gray-600",e),...a}));d.displayName="AvatarFallback";var o=e.i(37727);let m=({open:e,onOpenChange:t,children:r})=>(0,s.jsx)(s.Fragment,{children:a.Children.map(r,s=>a.isValidElement(s)?a.cloneElement(s,{open:e,onOpenChange:t}):s)}),x=a.forwardRef(({className:e,onClick:t,open:r,onOpenChange:l,asChild:n=!1,children:c,...d},o)=>n&&a.isValidElement(c)?a.cloneElement(c,{ref:o,className:(0,i.cn)(e,c.props.className),onClick:e=>{c.props.onClick?.(e),t?.(e),l?.(!r)},...d}):(0,s.jsx)("button",{ref:o,className:e,onClick:e=>{t?.(e),l?.(!r)},...d,children:c}));x.displayName="DialogTrigger";let h=a.forwardRef(({className:e,children:a,open:t,onOpenChange:r,...l},i)=>t?(0,s.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[(0,s.jsx)("div",{className:"fixed inset-0 bg-black/80",onClick:()=>r?.(!1)}),(0,s.jsxs)("div",{ref:i,className:`relative z-50 grid w-full max-w-lg gap-4 border bg-background p-6 shadow-lg rounded-lg ${e}`,...l,children:[(0,s.jsxs)("button",{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100",onClick:()=>r?.(!1),children:[(0,s.jsx)(o.X,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Close"})]}),a]})]}):null);h.displayName="DialogContent";let u=({className:e,...a})=>(0,s.jsx)("div",{className:`flex flex-col space-y-1.5 text-center sm:text-left ${e}`,...a});u.displayName="DialogHeader";let f=({className:e,...a})=>(0,s.jsx)("h2",{className:`text-lg font-semibold leading-none tracking-tight ${e}`,...a});f.displayName="DialogTitle";var g=e.i(86909);function p({listingId:e,likesCount:i,className:o=""}){let[p,v]=(0,a.useState)([]),[y,j]=(0,a.useState)(!1),[N,w]=(0,a.useState)(!1),b=async()=>{if(0!==i){j(!0);try{let{data:s,error:a}=await g.supabase.from("listing_likes").select(`
          user_id,
          created_at,
          users!listing_likes_user_id_fkey (
            id,
            full_name,
            email,
            avatar_url
          )
        `).eq("listing_id",e).order("created_at",{ascending:!1}).limit(20);if(a)throw a;let t=(s||[]).map(e=>e.users).filter(Boolean);v(t)}catch(e){console.error("Error fetching liked users:",e)}finally{j(!1)}}};return 0===i?(0,s.jsxs)("div",{className:`flex items-center gap-1 text-gray-500 ${o}`,children:[(0,s.jsx)(t.Heart,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"text-sm",children:"No likes yet"})]}):(0,s.jsxs)(m,{open:N,onOpenChange:e=>{w(e),e&&0===p.length&&b()},children:[(0,s.jsx)(x,{asChild:!0,children:(0,s.jsxs)(l.Button,{variant:"ghost",className:`flex items-center gap-1 text-gray-600 hover:text-red-600 ${o}`,children:[(0,s.jsx)(t.Heart,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"text-sm font-medium",children:i}),(0,s.jsx)("span",{className:"text-xs text-gray-500",children:"likes"})]})}),(0,s.jsxs)(h,{className:"max-w-md",children:[(0,s.jsx)(u,{children:(0,s.jsxs)(f,{className:"flex items-center gap-2",children:[(0,s.jsx)(t.Heart,{className:"h-5 w-5 text-red-500"}),"People who liked this listing"]})}),(0,s.jsx)("div",{className:"space-y-3",children:y?(0,s.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-red-600"})}):0===p.length?(0,s.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,s.jsx)(r.Users,{className:"h-12 w-12 mx-auto mb-2 opacity-50"}),(0,s.jsx)("p",{children:"No one has liked this listing yet"})]}):(0,s.jsxs)("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:[p.map(e=>(0,s.jsxs)("div",{className:"flex items-center gap-3 p-2 rounded-lg hover:bg-gray-50",children:[(0,s.jsxs)(n,{className:"h-10 w-10",children:[(0,s.jsx)(c,{src:e.avatar_url||"",alt:e.full_name||""}),(0,s.jsx)(d,{children:e.full_name?.charAt(0)?.toUpperCase()||e.email?.charAt(0)?.toUpperCase()||"U"})]}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("p",{className:"font-medium text-sm truncate",children:e.full_name||"Anonymous User"}),(0,s.jsx)("p",{className:"text-xs text-gray-500 truncate",children:e.email||"No email"})]})]},e.id)),p.length<i&&(0,s.jsxs)("div",{className:"text-center py-2 text-sm text-gray-500",children:["And ",i-p.length," more..."]})]})})]})]})}e.s(["default",()=>p],41383);var v=e.i(86536);function y({listingId:e,viewsCount:t,className:r=""}){let[i,n]=(0,a.useState)([]),[c,d]=(0,a.useState)(!1),[o,p]=(0,a.useState)(!1),y=async()=>{if(0!==t){d(!0);try{let{data:s,error:a}=await g.supabase.from("listing_views").select(`
          id,
          user_id,
          ip_address,
          user_agent,
          viewed_at,
          users!listing_views_user_id_fkey (
            id,
            full_name,
            email,
            avatar_url
          )
        `).eq("listing_id",e).order("viewed_at",{ascending:!1}).limit(20);a?(console.error("Error fetching views:",a),n([])):n(s||[])}catch(e){console.error("Error fetching views:",e),n([])}finally{d(!1)}}};return 0===t?(0,s.jsxs)("div",{className:`flex items-center gap-1 text-gray-500 ${r}`,children:[(0,s.jsx)(v.Eye,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"text-sm",children:"No views yet"})]}):(0,s.jsxs)(m,{open:o,onOpenChange:e=>{p(e),e&&0===i.length&&y()},children:[(0,s.jsx)(x,{asChild:!0,children:(0,s.jsxs)(l.Button,{variant:"ghost",className:`flex items-center gap-1 text-gray-600 hover:text-blue-600 ${r}`,children:[(0,s.jsx)(v.Eye,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"text-sm font-medium",children:t}),(0,s.jsx)("span",{className:"text-xs text-gray-500",children:"views"})]})}),(0,s.jsxs)(h,{className:"max-w-md",children:[(0,s.jsx)(u,{children:(0,s.jsxs)(f,{className:"flex items-center gap-2",children:[(0,s.jsx)(v.Eye,{className:"h-5 w-5 text-blue-500"}),"Recent views"]})}),(0,s.jsx)("div",{className:"space-y-3",children:c?(0,s.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):0===i.length?(0,s.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,s.jsx)(v.Eye,{className:"h-12 w-12 mx-auto mb-2 opacity-50"}),(0,s.jsx)("p",{children:"No views recorded yet"})]}):(0,s.jsxs)("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:[i.map(e=>{let a,t;return(0,s.jsxs)("div",{className:"flex items-center gap-3 p-2 rounded-lg hover:bg-gray-50",children:[(0,s.jsx)("div",{className:"flex-shrink-0",children:e.users?(0,s.jsx)("div",{className:"h-8 w-8 rounded-full bg-blue-100 flex items-center justify-center",children:(0,s.jsx)("span",{className:"text-xs font-medium text-blue-600",children:e.users.full_name?.charAt(0)?.toUpperCase()||"U"})}):(0,s.jsx)("div",{className:"h-8 w-8 rounded-full bg-gray-100 flex items-center justify-center",children:(0,s.jsx)(v.Eye,{className:"h-4 w-4 text-gray-500"})})}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("p",{className:"font-medium text-sm truncate",children:e.users?.full_name||"Anonymous Visitor"}),(0,s.jsxs)("p",{className:"text-xs text-gray-500",children:[(a=new Date(e.viewed_at),(t=Math.floor((new Date().getTime()-a.getTime())/36e5))<1?"Just now":t<24?`${t}h ago`:t<48?"Yesterday":a.toLocaleDateString()),e.ip_address&&` â€¢ ${e.ip_address}`]})]})]},e.id)}),i.length<t&&(0,s.jsxs)("div",{className:"text-center py-2 text-sm text-gray-500",children:["And ",t-i.length," more views..."]})]})})]})]})}e.s(["default",()=>y],42347)},9553,e=>{e.v(e=>Promise.resolve().then(()=>e(90676)))}]);