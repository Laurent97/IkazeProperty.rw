(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,86536,e=>{"use strict";let s=(0,e.i(75254).default)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);e.s(["Eye",()=>s],86536)},55436,e=>{"use strict";let s=(0,e.i(75254).default)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]);e.s(["Search",()=>s],55436)},87316,e=>{"use strict";let s=(0,e.i(75254).default)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);e.s(["Calendar",()=>s],87316)},52200,e=>{"use strict";var s=e.i(43476),t=e.i(43432),a=e.i(63488),l=e.i(46897),r=e.i(75240);function i({className:e=""}){let{getPlatformInfo:i}=(0,r.usePaymentMethods)(),n=i();return(0,s.jsxs)("div",{className:`text-xs text-gray-600 space-y-1 ${e}`,children:[(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(t.Phone,{className:"h-3 w-3 mr-2 text-gray-500"}),(0,s.jsx)("span",{children:n.phone})]}),(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(a.Mail,{className:"h-3 w-3 mr-2 text-gray-500"}),(0,s.jsx)("span",{children:n.email})]}),(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(l.MapPin,{className:"h-3 w-3 mr-2 text-gray-500"}),(0,s.jsx)("span",{children:n.address})]})]})}e.s(["default",()=>i])},87130,e=>{"use strict";let s=(0,e.i(75254).default)("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]]);e.s(["Filter",()=>s],87130)},39616,e=>{"use strict";let s=(0,e.i(75254).default)("settings",[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);e.s(["Settings",()=>s],39616)},10045,e=>{"use strict";var s=e.i(43476),t=e.i(71645),a=e.i(22016),l=e.i(55436),r=e.i(87130),i=e.i(46897),n=e.i(87316);let c=(0,e.i(75254).default)("fuel",[["path",{d:"M14 13h2a2 2 0 0 1 2 2v2a2 2 0 0 0 4 0v-6.998a2 2 0 0 0-.59-1.42L18 5",key:"1wtuz0"}],["path",{d:"M14 21V5a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v16",key:"e09ifn"}],["path",{d:"M2 21h13",key:"1x0fut"}],["path",{d:"M3 9h11",key:"1p7c0w"}]]);var o=e.i(39616),d=e.i(90597),m=e.i(86536),x=e.i(5125),h=e.i(19455),u=e.i(15288),g=e.i(52200);function p(){let[p,f]=(0,t.useState)(""),[y,j]=(0,t.useState)({min:"",max:""}),[b,v]=(0,t.useState)(""),[N,w]=(0,t.useState)(""),[_,C]=(0,t.useState)(""),[k,S]=(0,t.useState)("all"),[M,L]=(0,t.useState)([]),[A,F]=(0,t.useState)(!0),[T,E]=(0,t.useState)(""),P=async()=>{try{F(!0);let{supabaseClient:s}=await e.A(9553);console.log("Starting to fetch car listings...");let{data:t,error:a}=await s.from("listings").select("*").eq("category","cars").eq("status","available").order("created_at",{ascending:!1});if(a){console.error("Error fetching basic listings:",a),E(`Failed to load listings: ${a.message}`);return}if(console.log(`Found ${t?.length||0} listings`),!t||0===t.length){L([]),F(!1);return}let l=t.map(e=>e.id),[{data:r,error:i},{data:n,error:c},{data:o,error:d}]=await Promise.all([s.from("users").select("id, full_name, email, avatar_url, phone_number, verified").in("id",t.map(e=>e.seller_id)),s.from("listing_media").select("id, listing_id, url, media_type, order_index, is_primary").in("listing_id",l).order("order_index"),s.from("car_details").select("*").in("listing_id",l)]);i&&console.error("Error fetching sellers:",i),c&&console.error("Error fetching media:",c),d&&console.error("Error fetching car details:",d);let{data:m}=await s.from("promoted_listings").select("listing_id, status, end_date").in("listing_id",l).eq("status","active").gt("end_date",new Date().toISOString()),x=t.map(e=>{let s=r?.find(s=>s.id===e.seller_id),t=n?.filter(s=>s.listing_id===e.id)||[],a=o?.find(s=>s.listing_id===e.id),l=m?.some(s=>s.listing_id===e.id);return{...e,seller:s||null,media:t||[],car_details:a||void 0,promoted:l||e.promoted}});console.log("Successfully combined data for",x.length,"listings"),L(x)}catch(e){console.error("Error in fetchListings:",e),E(`Failed to load listings: ${e?.message||"Unknown error"}`)}finally{F(!1)}};(0,t.useEffect)(()=>{P()},[]);let D=e=>{if(!e)return"Location not specified";if("string"==typeof e)try{e=JSON.parse(e)}catch{return e}if("object"==typeof e)try{"string"==typeof e&&(e=JSON.parse(e));let s=e;return s?.district||s?.sector||s?.cell||s?.village||s?.city||s?.province||s?.address||"Location not specified"}catch(e){console.log("Error parsing location:",e)}return"Location not specified"},R=M.filter(e=>{let s=e.title.toLowerCase().includes(p.toLowerCase())||e.car_details?.make?.toLowerCase().includes(p.toLowerCase())||e.car_details?.model?.toLowerCase().includes(p.toLowerCase())||D(e.location).toLowerCase().includes(p.toLowerCase()),t=e.price||0,a=parseInt(y.min)||0,l=parseInt(y.max)||1/0,r=(!y.min||t>=a)&&(!y.max||t<=l),i=!b||(e.car_details?.year_manufacture||0)>=parseInt(b),n=!N||e.car_details?.fuel_type===N,c=!_||e.car_details?.transmission===_,o="all"===k||e.transaction_type===k;return s&&r&&i&&n&&c&&o});return(0,s.jsxs)("div",{className:"min-h-screen bg-gray-50 no-overflow-x",children:[(0,s.jsx)("div",{className:"bg-white border-b border-gray-200",children:(0,s.jsx)("div",{className:"max-w-7xl mx-auto px-3 sm:px-4 lg:px-6 py-4 sm:py-6",children:(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900 flex items-center",children:[(0,s.jsx)(x.Car,{className:"h-6 w-6 sm:h-8 sm:w-8 mr-2 sm:mr-3 text-red-600"}),"Cars & Vehicles"]}),(0,s.jsxs)("p",{className:"text-gray-600 mt-1 sm:mt-2 text-sm sm:text-base",children:["Find your perfect vehicle from ",M.length," listings"]})]}),(0,s.jsx)(a.default,{href:"/create-listing?category=cars",children:(0,s.jsx)(h.Button,{className:"bg-red-600 hover:bg-red-700 w-full sm:w-auto touch-target",children:"List Vehicle"})})]})})}),(0,s.jsx)("div",{className:"max-w-7xl mx-auto px-3 sm:px-4 lg:px-6 py-4 sm:py-8",children:(0,s.jsxs)("div",{className:"flex flex-col lg:flex-row gap-6 lg:gap-8",children:[(0,s.jsx)("div",{className:"lg:w-80",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 sm:p-6",children:[(0,s.jsxs)("div",{className:"flex items-center mb-4",children:[(0,s.jsx)(r.Filter,{className:"h-4 w-4 sm:h-5 sm:w-5 mr-2 text-gray-600"}),(0,s.jsx)("h2",{className:"text-base sm:text-lg font-semibold text-gray-900",children:"Filters"})]}),(0,s.jsxs)("div",{className:"mb-4 sm:mb-6",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Search"}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(l.Search,{className:"absolute left-3 top-2.5 sm:top-3 h-4 w-4 text-gray-400"}),(0,s.jsx)("input",{type:"text",value:p,onChange:e=>f(e.target.value),placeholder:"Search by make, model, or location...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 text-sm"})]})]}),(0,s.jsxs)("div",{className:"mb-4 sm:mb-6",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Transaction Type"}),(0,s.jsxs)("select",{value:k,onChange:e=>S(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 text-sm","aria-label":"Transaction type",children:[(0,s.jsx)("option",{value:"all",children:"All Types"}),(0,s.jsx)("option",{value:"rent",children:"For Rent"}),(0,s.jsx)("option",{value:"sale",children:"For Sale"})]})]}),(0,s.jsxs)("div",{className:"mb-4 sm:mb-6",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Price Range (RWF)"}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("input",{type:"number",value:y.min,onChange:e=>j({...y,min:e.target.value}),placeholder:"Min",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 text-sm"}),(0,s.jsx)("input",{type:"number",value:y.max,onChange:e=>j({...y,max:e.target.value}),placeholder:"Max",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 text-sm"})]})]}),(0,s.jsxs)("div",{className:"mb-4 sm:mb-6",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Minimum Year"}),(0,s.jsxs)("select",{value:b,onChange:e=>v(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 text-sm","aria-label":"Minimum year",children:[(0,s.jsx)("option",{value:"",children:"Any Year"}),(0,s.jsx)("option",{value:"2023",children:"2023+"}),(0,s.jsx)("option",{value:"2022",children:"2022+"}),(0,s.jsx)("option",{value:"2021",children:"2021+"}),(0,s.jsx)("option",{value:"2020",children:"2020+"}),(0,s.jsx)("option",{value:"2019",children:"2019+"}),(0,s.jsx)("option",{value:"2018",children:"2018+"}),(0,s.jsx)("option",{value:"2017",children:"2017+"})]})]}),(0,s.jsxs)("div",{className:"mb-4 sm:mb-6",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Fuel Type"}),(0,s.jsxs)("select",{value:N,onChange:e=>w(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 text-sm","aria-label":"Fuel type",children:[(0,s.jsx)("option",{value:"",children:"Any Fuel Type"}),(0,s.jsx)("option",{value:"Petrol",children:"Petrol"}),(0,s.jsx)("option",{value:"Diesel",children:"Diesel"}),(0,s.jsx)("option",{value:"Electric",children:"Electric"}),(0,s.jsx)("option",{value:"Hybrid",children:"Hybrid"})]})]}),(0,s.jsxs)("div",{className:"mb-4 sm:mb-6",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Transmission"}),(0,s.jsxs)("select",{value:_,onChange:e=>C(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 text-sm","aria-label":"Transmission type",children:[(0,s.jsx)("option",{value:"",children:"Any Transmission"}),(0,s.jsx)("option",{value:"Automatic",children:"Automatic"}),(0,s.jsx)("option",{value:"Manual",children:"Manual"})]})]}),(0,s.jsx)(h.Button,{variant:"outline",className:"w-full border-red-600 text-red-600 hover:bg-red-50 touch-target",onClick:()=>{f(""),j({min:"",max:""}),v(""),w(""),C(""),S("all")},children:"Clear Filters"})]})}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,s.jsxs)("p",{className:"text-gray-600",children:["Showing ",R.length," of ",M.length," vehicles"]}),(0,s.jsxs)("select",{className:"px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500","aria-label":"Sort options",children:[(0,s.jsx)("option",{children:"Sort by: Featured"}),(0,s.jsx)("option",{children:"Price: Low to High"}),(0,s.jsx)("option",{children:"Price: High to Low"}),(0,s.jsx)("option",{children:"Newest First"}),(0,s.jsx)("option",{children:"Most Viewed"})]})]}),A&&(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)(x.Car,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Loading listings..."}),(0,s.jsx)("p",{className:"text-gray-600",children:"Please wait while we fetch the latest vehicles"})]}),T&&!A&&(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)("div",{className:"text-red-600 text-6xl mb-4",children:"⚠️"}),(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Unable to load listings"}),(0,s.jsx)("p",{className:"text-gray-600 mb-4",children:T}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Common issues:"}),(0,s.jsxs)("ul",{className:"text-sm text-gray-500 list-disc list-inside",children:[(0,s.jsx)("li",{children:"Check your Supabase connection"}),(0,s.jsx)("li",{children:"Verify you have car listings in your database"}),(0,s.jsx)("li",{children:"Ensure RLS policies allow reading listings"})]})]}),(0,s.jsx)(h.Button,{onClick:P,className:"mt-4 bg-red-600 hover:bg-red-700",children:"Try Again"})]}),!A&&!T&&(0,s.jsx)("div",{className:"grid grid-cols-1 xs:grid-cols-2 gap-4 sm:gap-6",children:R.map(e=>(0,s.jsxs)(u.Card,{className:"hover:shadow-lg transition-shadow group",children:[(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("div",{className:"w-full h-40 sm:h-48 bg-gray-200 rounded-t-lg flex items-center justify-center",children:e.media&&e.media.length>0?(0,s.jsx)("img",{src:e.media.find(e=>e.is_primary)?.url||e.media[0].url,alt:e.title,className:"w-full h-full object-cover transition-transform group-hover:scale-105",onError:e=>{e.target.src="https://via.placeholder.com/400x300/cccccc/969696?text=Car+Image"}}):(0,s.jsx)("span",{className:"text-gray-500 text-sm sm:text-base",children:"Vehicle Image"})}),e.featured&&(0,s.jsx)("div",{className:"absolute top-2 left-2 bg-red-600 text-white px-2 py-1 rounded text-xs font-semibold",children:"FEATURED"}),e.promoted&&(0,s.jsx)("div",{className:"absolute top-2 right-2 bg-yellow-500 text-white px-2 py-1 rounded text-xs font-semibold",children:"PROMOTED"}),(0,s.jsx)("div",{className:"absolute bottom-2 left-2 bg-white/90 backdrop-blur-sm px-2 py-1 rounded text-xs font-semibold capitalize",children:e.car_details?.vehicle_type||"Vehicle"})]}),(0,s.jsxs)(u.CardContent,{className:"p-3 sm:p-4",children:[(0,s.jsx)("h3",{className:"font-semibold text-gray-900 mb-2 line-clamp-2 text-sm sm:text-base",children:e.title}),(0,s.jsx)("div",{className:"flex items-center justify-between mb-2 sm:mb-3",children:(0,s.jsxs)("span",{className:"text-lg sm:text-2xl font-bold text-red-600",children:[e.currency," ",e.price.toLocaleString(),(0,s.jsx)("span",{className:"text-xs sm:text-sm text-gray-500 font-normal",children:"rent"===e.transaction_type?"/month":""})]})}),(0,s.jsxs)("p",{className:"text-gray-600 text-xs sm:text-sm mb-3 flex items-center",children:[(0,s.jsx)(i.MapPin,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-1"}),D(e.location)]}),(0,s.jsx)(g.default,{className:"mb-3 sm:mb-4"}),(0,s.jsxs)("div",{className:"flex flex-wrap items-center gap-2 sm:gap-4 text-xs sm:text-sm text-gray-600 mb-3 sm:mb-4",children:[(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(n.Calendar,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-1"}),e.car_details?.year_manufacture||"N/A"]}),(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(c,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-1"}),e.car_details?.fuel_type||"N/A"]}),(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(o.Settings,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-1"}),e.car_details?.transmission||"N/A"]})]}),(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2 sm:space-x-3 text-xs sm:text-sm text-gray-500",children:[(0,s.jsxs)("span",{className:"flex items-center",children:[(0,s.jsx)(m.Eye,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-1"}),e.views||0]}),(0,s.jsxs)("span",{className:"flex items-center",children:[(0,s.jsx)(d.Heart,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-1"}),e.likes||0]}),(0,s.jsx)("span",{className:"text-xs text-gray-400",children:new Date(e.created_at).toLocaleDateString("en-US",{month:"short",day:"numeric"})})]}),(0,s.jsx)(a.default,{href:`/listings/cars/${e.id}`,children:(0,s.jsx)(h.Button,{size:"sm",className:"bg-red-600 hover:bg-red-700 touch-target",children:"View Details"})})]})]})]},e.id))}),!A&&!T&&0===R.length&&(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)(x.Car,{className:"h-12 w-12 sm:h-16 sm:w-16 text-gray-400 mx-auto mb-4"}),(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No vehicles found"}),(0,s.jsx)("p",{className:"text-gray-600 mb-4",children:"Try adjusting your filters or search criteria"}),(0,s.jsx)(h.Button,{variant:"outline",className:"w-full border-red-600 text-red-600 hover:bg-red-50 touch-target",onClick:()=>{f(""),j({min:"",max:""}),v(""),w(""),C(""),S("all")},children:"Clear All Filters"})]})]})]})})]})}e.s(["default",()=>p],10045)},9553,e=>{e.v(e=>Promise.resolve().then(()=>e(90676)))}]);