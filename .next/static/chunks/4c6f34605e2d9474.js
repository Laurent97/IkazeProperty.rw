(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,86536,e=>{"use strict";let s=(0,e.i(75254).default)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);e.s(["Eye",()=>s],86536)},55436,e=>{"use strict";let s=(0,e.i(75254).default)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]);e.s(["Search",()=>s],55436)},87130,e=>{"use strict";let s=(0,e.i(75254).default)("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]]);e.s(["Filter",()=>s],87130)},52200,e=>{"use strict";var s=e.i(43476),a=e.i(43432),t=e.i(63488),l=e.i(46897),r=e.i(75240);function i({className:e=""}){let{getPlatformInfo:i}=(0,r.usePaymentMethods)(),n=i();return(0,s.jsxs)("div",{className:`text-xs text-gray-600 space-y-1 ${e}`,children:[(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(a.Phone,{className:"h-3 w-3 mr-2 text-gray-500"}),(0,s.jsx)("span",{children:n.phone})]}),(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(t.Mail,{className:"h-3 w-3 mr-2 text-gray-500"}),(0,s.jsx)("span",{children:n.email})]}),(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(l.MapPin,{className:"h-3 w-3 mr-2 text-gray-500"}),(0,s.jsx)("span",{children:n.address})]})]})}e.s(["default",()=>i])},23066,e=>{"use strict";var s=e.i(43476),a=e.i(71645),t=e.i(90597),l=e.i(19455),r=e.i(86909);function i({listingId:e,className:i="",size:n="md",showText:d=!1}){let[c,o]=(0,a.useState)(!1),[m,x]=(0,a.useState)(!0),[u,h]=(0,a.useState)(null),[g,p]=(0,a.useState)(null),f={sm:"h-8 w-8",md:"h-10 w-10",lg:"h-12 w-12"},j={sm:"h-4 w-4",md:"h-5 w-5",lg:"h-6 w-6"};(0,a.useEffect)(()=>{(async()=>{try{let s=await (0,r.getCurrentUser)();if(!s)return void x(!1);h(s);let{data:a}=await r.supabase.from("listings").select("likes").eq("id",e).single();p(a);let{data:t,error:l}=await r.supabase.from("favorite_listings").select("*").eq("user_id",s.id).eq("listing_id",e).single();l&&"PGRST116"!==l.code?console.error("Error checking favorite status:",l):o(!!t)}catch(e){console.error("Error checking favorite status:",e)}finally{x(!1)}})()},[e]);let y=async()=>{if(!u)return void alert("Please login to favorite listings");try{if(c){let{error:s}=await r.supabase.from("favorite_listings").delete().eq("user_id",u.id).eq("listing_id",e);if(s)throw s;o(!1),await r.supabase.rpc("sql",{sql:`SELECT decrement_likes('${e}')`})}else{let{error:s}=await r.supabase.from("favorite_listings").insert({user_id:u.id,listing_id:e});if(s)throw s;o(!0),await r.supabase.rpc("sql",{sql:`SELECT increment_likes('${e}')`})}}catch(e){console.error("Error toggling favorite:",e),alert("Error updating favorites. Please try again.")}};return m?(0,s.jsx)(l.Button,{variant:"outline",className:`${i} ${f[n]}`,disabled:!0,children:(0,s.jsx)(t.Heart,{className:`${j[n]} animate-pulse`})}):(0,s.jsxs)(l.Button,{variant:"outline",className:`${i} ${f[n]} ${c?"bg-red-50 border-red-200 text-red-600 hover:bg-red-100":"hover:bg-red-50 hover:border-red-200 hover:text-red-600"}`,onClick:y,title:c?"Remove from favorites":"Add to favorites",children:[(0,s.jsx)(t.Heart,{className:`${j[n]} ${c?"fill-current":""}`}),d&&(0,s.jsx)("span",{className:"ml-2",children:c?"Favorited":"Favorite"})]})}e.s(["default",()=>i])},38605,e=>{"use strict";var s=e.i(43476),a=e.i(71645),t=e.i(22016),l=e.i(55436),r=e.i(87130),i=e.i(46897),n=e.i(1107);let d=(0,e.i(75254).default)("ruler",[["path",{d:"M21.3 15.3a2.4 2.4 0 0 1 0 3.4l-2.6 2.6a2.4 2.4 0 0 1-3.4 0L2.7 8.7a2.41 2.41 0 0 1 0-3.4l2.6-2.6a2.41 2.41 0 0 1 3.4 0Z",key:"icamh8"}],["path",{d:"m14.5 12.5 2-2",key:"inckbg"}],["path",{d:"m11.5 9.5 2-2",key:"fmmyf7"}],["path",{d:"m8.5 6.5 2-2",key:"vc6u1g"}],["path",{d:"m17.5 15.5 2-2",key:"wo5hmg"}]]);var c=e.i(90597),o=e.i(86536),m=e.i(19455),x=e.i(15288),u=e.i(52200),h=e.i(23066);function g(){let[g,p]=(0,a.useState)(""),[f,j]=(0,a.useState)({min:"",max:""}),[y,b]=(0,a.useState)({min:"",max:""}),[v,N]=(0,a.useState)(""),[w,_]=(0,a.useState)(""),[S,k]=(0,a.useState)([]),[C,E]=(0,a.useState)(!0),[L,$]=(0,a.useState)(""),F=async()=>{try{E(!0);let{supabaseClient:s}=await e.A(9553);console.log("Starting to fetch land listings...");let{data:a,error:t}=await s.from("listings").select("*").eq("category","land").eq("status","available").order("created_at",{ascending:!1}).limit(50);if(t){console.error("Error fetching basic listings:",t),$(`Failed to load listings: ${t.message}`);return}if(console.log(`Found ${a?.length||0} listings`),!a||0===a.length)return void k([]);let l=a.map(e=>e.id),[{data:r,error:i},{data:n,error:d},{data:c,error:o}]=await Promise.all([s.from("users").select("id, full_name, email, avatar_url, phone_number, verified").in("id",a.map(e=>e.seller_id)),s.from("listing_media").select("id, listing_id, url, public_id, media_type, order_index, is_primary").in("listing_id",l).order("order_index"),s.from("land_details").select("*").in("listing_id",l)]);i&&console.error("Error fetching sellers:",i),d&&console.error("Error fetching media:",d),o&&console.error("Error fetching land details:",o);let{data:m}=await s.from("listing_promotions").select("listing_id, status, expires_at").in("listing_id",l).eq("status","active").gt("expires_at",new Date().toISOString()),x=a.map(e=>{let s=r?.find(s=>s.id===e.seller_id),a=n?.filter(s=>s.listing_id===e.id)||[],t=c?.find(s=>s.listing_id===e.id),l=m?.some(s=>s.listing_id===e.id);return{...e,seller:s||null,media:a||[],land_details:t||void 0,promoted:l||e.promoted}});console.log("Successfully combined data for",x.length,"listings"),k(x)}catch(e){console.error("Error in fetchListings:",e),$(`Failed to load listings: ${e?.message||"Unknown error"}`)}finally{E(!1)}};(0,a.useEffect)(()=>{F()},[]);let P=e=>{if(!e)return"Location not specified";if("string"==typeof e)return e;if("object"==typeof e)try{"string"==typeof e&&(e=JSON.parse(e));let s=e;return s?.district||s?.sector||s?.cell||s?.village||s?.city||s?.province||s?.address||"Location not specified"}catch(e){console.log("Error parsing location:",e)}return"Location not specified"},T=S.filter(e=>{let s=e.title.toLowerCase().includes(g.toLowerCase())||P(e.location).toLowerCase().includes(g.toLowerCase()),a=e.price||0,t=parseInt(f.min)||0,l=parseInt(f.max)||1/0,r=(!f.min||a>=t)&&(!f.max||a<=l),i=e.land_details?.plot_size||0,n=parseInt(y.min)||0,d=parseInt(y.max)||1/0,c=(!y.min||i>=n)&&(!y.max||i<=d),o=!v||e.land_details?.plot_type===v,m=!w||e.land_details?.road_access===w;return s&&r&&c&&o&&m});return C?(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-red-600 mx-auto mb-4"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Loading land listings..."})]})}):L?(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"text-red-600 text-6xl mb-4",children:"⚠️"}),(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Unable to load listings"}),(0,s.jsx)("p",{className:"text-gray-600 mb-4",children:L}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Common issues:"}),(0,s.jsxs)("ul",{className:"text-sm text-gray-500 list-disc list-inside",children:[(0,s.jsx)("li",{children:"Check your Supabase connection"}),(0,s.jsx)("li",{children:"Verify you have land listings in your database"}),(0,s.jsx)("li",{children:"Ensure RLS policies allow reading listings"})]})]}),(0,s.jsx)(m.Button,{onClick:F,className:"mt-4 bg-red-600 hover:bg-red-700",children:"Try Again"})]})}):(0,s.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,s.jsx)("div",{className:"bg-white border-b border-gray-200",children:(0,s.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("h1",{className:"text-3xl font-bold text-gray-900 flex items-center",children:[(0,s.jsx)(n.Trees,{className:"h-8 w-8 mr-3 text-red-600"}),"Land & Plots"]}),(0,s.jsxs)("p",{className:"text-gray-600 mt-2",children:["Find the perfect plot from ",S.length," available listings"]})]}),(0,s.jsx)(t.default,{href:"/create-listing?category=land",children:(0,s.jsx)(m.Button,{className:"bg-red-600 hover:bg-red-700",children:"List Your Land"})})]})})}),(0,s.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:(0,s.jsxs)("div",{className:"flex flex-col lg:flex-row gap-8",children:[(0,s.jsx)("div",{className:"lg:w-80",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[(0,s.jsxs)("div",{className:"flex items-center mb-4",children:[(0,s.jsx)(r.Filter,{className:"h-5 w-5 mr-2 text-gray-600"}),(0,s.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Filters"})]}),(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Search"}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(l.Search,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),(0,s.jsx)("input",{type:"text",value:g,onChange:e=>p(e.target.value),placeholder:"Search by title or location...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500"})]})]}),(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Plot Type"}),(0,s.jsxs)("select",{value:v,onChange:e=>N(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500",children:[(0,s.jsx)("option",{value:"",children:"All Types"}),(0,s.jsx)("option",{value:"residential",children:"Residential"}),(0,s.jsx)("option",{value:"commercial",children:"Commercial"}),(0,s.jsx)("option",{value:"agricultural",children:"Agricultural"}),(0,s.jsx)("option",{value:"industrial",children:"Industrial"}),(0,s.jsx)("option",{value:"mixed_use",children:"Mixed Use"})]})]}),(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Price Range (RWF)"}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("input",{type:"number",value:f.min,onChange:e=>j({...f,min:e.target.value}),placeholder:"Min",min:"0",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500"}),(0,s.jsx)("input",{type:"number",value:f.max,onChange:e=>j({...f,max:e.target.value}),placeholder:"Max",min:"0",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500"})]})]}),(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Size Range (m²)"}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("input",{type:"number",value:y.min,onChange:e=>b({...y,min:e.target.value}),placeholder:"Min",min:"0",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500"}),(0,s.jsx)("input",{type:"number",value:y.max,onChange:e=>b({...y,max:e.target.value}),placeholder:"Max",min:"0",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500"})]})]}),(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Road Access"}),(0,s.jsxs)("select",{value:w,onChange:e=>_(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500",children:[(0,s.jsx)("option",{value:"",children:"Any Access"}),(0,s.jsx)("option",{value:"tarmac",children:"Tarmac"}),(0,s.jsx)("option",{value:"murram",children:"Murram"}),(0,s.jsx)("option",{value:"gravel",children:"Gravel"}),(0,s.jsx)("option",{value:"footpath",children:"Footpath"}),(0,s.jsx)("option",{value:"none",children:"None"})]})]}),(0,s.jsx)(m.Button,{variant:"outline",className:"w-full border-red-600 text-red-600 hover:bg-red-50",onClick:()=>{p(""),j({min:"",max:""}),b({min:"",max:""}),N(""),_("")},children:"Clear All Filters"})]})}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,s.jsxs)("p",{className:"text-gray-600",children:["Showing ",T.length," of ",S.length," plots"]}),(0,s.jsx)("div",{className:"text-sm text-gray-500",children:0===T.length?"No results found":"Sorted by: Newest"})]}),T.length>0?(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:T.map(e=>{var a,l,r;let g=(a=e.media)&&0!==a.length?a.find(e=>e.is_primary)||a[0]:null;return(0,s.jsxs)(x.Card,{className:"hover:shadow-lg transition-shadow group",children:[(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("div",{className:"w-full h-48 bg-gray-200 rounded-t-lg overflow-hidden",children:g?(0,s.jsx)("img",{src:g.url,alt:e.title,className:"w-full h-full object-cover transition-transform group-hover:scale-105",onError:e=>{e.target.src="https://via.placeholder.com/400x300/cccccc/969696?text=Land+Plot"}}):(0,s.jsx)("div",{className:"w-full h-full flex items-center justify-center bg-gradient-to-br from-gray-100 to-gray-200",children:(0,s.jsx)(n.Trees,{className:"h-16 w-16 text-gray-400"})})}),e.featured&&(0,s.jsx)("div",{className:"absolute top-2 left-2 bg-red-600 text-white px-2 py-1 rounded text-xs font-semibold",children:"FEATURED"}),e.promoted&&(0,s.jsx)("div",{className:"absolute top-2 right-2 bg-yellow-500 text-white px-2 py-1 rounded text-xs font-semibold",children:"PROMOTED"}),e.land_details?.plot_type&&(0,s.jsx)("div",{className:"absolute bottom-2 left-2 bg-white/90 backdrop-blur-sm px-2 py-1 rounded text-xs font-semibold capitalize",children:e.land_details.plot_type})]}),(0,s.jsxs)(x.CardContent,{className:"p-4",children:[(0,s.jsx)("h3",{className:"font-semibold text-gray-900 mb-2 line-clamp-2",children:e.title}),(0,s.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,s.jsxs)("span",{className:"text-2xl font-bold text-red-600",children:[e.currency," ",e.price?.toLocaleString()||"Price on request"]}),e.price_type&&"fixed"!==e.price_type&&(0,s.jsx)("span",{className:"text-sm text-gray-600 capitalize",children:e.price_type})]}),(0,s.jsxs)("p",{className:"text-gray-600 text-sm mb-3 flex items-center",children:[(0,s.jsx)(i.MapPin,{className:"h-4 w-4 mr-1 flex-shrink-0"}),(0,s.jsx)("span",{className:"truncate",children:P(e.location)})]}),(0,s.jsx)(u.default,{className:"mb-4"}),(0,s.jsxs)("div",{className:"flex items-center space-x-4 text-sm text-gray-600 mb-4",children:[(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(d,{className:"h-4 w-4 mr-1"}),(l=e.land_details?.plot_size,r=e.land_details?.size_unit,l?"m²"===r&&l>=1e4?`${(l/1e4).toFixed(1)} hectares`:`${l.toLocaleString()} ${r||"m²"}`:"Size not specified")]}),e.land_details?.road_access&&(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("span",{className:`w-2 h-2 rounded-full mr-1 ${"tarmac"===e.land_details.road_access?"bg-green-500":"murram"===e.land_details.road_access?"bg-yellow-500":"gravel"===e.land_details.road_access?"bg-amber-500":"bg-gray-500"}`}),(0,s.jsx)("span",{className:"capitalize",children:e.land_details.road_access})]})]}),(0,s.jsxs)("div",{className:"flex flex-wrap gap-2 mb-4",children:[e.land_details?.shape&&(0,s.jsx)("span",{className:"bg-gray-100 text-gray-800 text-xs px-2 py-1 rounded capitalize",children:e.land_details.shape}),e.land_details?.fenced&&(0,s.jsx)("span",{className:"bg-green-100 text-green-800 text-xs px-2 py-1 rounded",children:"Fenced"}),e.land_details?.surveyed&&(0,s.jsx)("span",{className:"bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded",children:"Surveyed"}),e.transaction_type&&(0,s.jsxs)("span",{className:"bg-amber-100 text-amber-800 text-xs px-2 py-1 rounded capitalize",children:["For ",e.transaction_type]})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between pt-4 border-t",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3 text-sm text-gray-500",children:[(0,s.jsxs)("span",{className:"flex items-center",children:[(0,s.jsx)(o.Eye,{className:"h-4 w-4 mr-1"}),e.views||0]}),(0,s.jsxs)("span",{className:"flex items-center",children:[(0,s.jsx)(c.Heart,{className:"h-4 w-4 mr-1"}),e.likes||0]}),(0,s.jsx)("span",{className:"text-xs text-gray-400",children:new Date(e.created_at).toLocaleDateString("en-US",{month:"short",day:"numeric"})})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(h.default,{listingId:e.id,size:"sm",className:"flex-shrink-0"}),(0,s.jsx)(t.default,{href:`/listings/land/${e.id}`,children:(0,s.jsx)(m.Button,{size:"sm",className:"bg-red-600 hover:bg-red-700",children:"View Details"})})]})]})]})]},e.id)})}):(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)(n.Trees,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:0===S.length?"No land listings yet":"No plots found matching your criteria"}),(0,s.jsx)("p",{className:"text-gray-600 mb-4",children:0===S.length?"Be the first to list your land property!":"Try adjusting your filters or search criteria"}),0===S.length?(0,s.jsx)(t.default,{href:"/create-listing?category=land",children:(0,s.jsx)(m.Button,{className:"bg-red-600 hover:bg-red-700",children:"List Your Land"})}):(0,s.jsx)(m.Button,{variant:"outline",className:"border-red-600 text-red-600 hover:bg-red-50",onClick:()=>{p(""),j({min:"",max:""}),b({min:"",max:""}),N(""),_("")},children:"Clear All Filters"})]})]})]})})]})}e.s(["default",()=>g],38605)},9553,e=>{e.v(e=>Promise.resolve().then(()=>e(90676)))}]);