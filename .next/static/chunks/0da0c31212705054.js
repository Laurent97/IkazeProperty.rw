(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,86536,e=>{"use strict";let s=(0,e.i(75254).default)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);e.s(["Eye",()=>s],86536)},73884,e=>{"use strict";let s=(0,e.i(75254).default)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);e.s(["XCircle",()=>s],73884)},12426,e=>{"use strict";let s=(0,e.i(75254).default)("dollar-sign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);e.s(["DollarSign",()=>s],12426)},69638,e=>{"use strict";let s=(0,e.i(75254).default)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);e.s(["CheckCircle",()=>s],69638)},3116,e=>{"use strict";let s=(0,e.i(75254).default)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);e.s(["Clock",()=>s],3116)},61911,e=>{"use strict";let s=(0,e.i(75254).default)("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]);e.s(["Users",()=>s],61911)},63209,e=>{"use strict";let s=(0,e.i(75254).default)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);e.s(["AlertCircle",()=>s],63209)},39616,e=>{"use strict";let s=(0,e.i(75254).default)("settings",[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);e.s(["Settings",()=>s],39616)},82448,e=>{"use strict";var s=e.i(43476),a=e.i(71645),t=e.i(22016),r=e.i(61911),l=e.i(94351),i=e.i(5125),c=e.i(1107),n=e.i(88844),d=e.i(86311),m=e.i(12426),x=e.i(25652),o=e.i(3116),h=e.i(69638),u=e.i(73884),g=e.i(63209),j=e.i(86536),y=e.i(39616),p=e.i(19455),f=e.i(15288),N=e.i(86909);function b(){let[e,b]=(0,a.useState)({totalUsers:0,totalListings:0,pendingInquiries:0,completedTransactions:0,totalRevenue:0}),[v,w]=(0,a.useState)([]),[C,k]=(0,a.useState)([]),[_,q]=(0,a.useState)([]),[S,T]=(0,a.useState)(!0);(0,a.useEffect)(()=>{B()},[]);let B=async()=>{try{let[e,s,a,t,r]=await Promise.all([N.supabase.from("users").select("id",{count:"exact"}),N.supabase.from("listings").select("id",{count:"exact"}),N.supabase.from("inquiries").select("id",{count:"exact",head:!0}).eq("status","pending"),N.supabase.from("transactions").select("id",{count:"exact",head:!0}).eq("status","completed"),N.supabase.from("transactions").select("commission_amount").eq("status","completed")]),l=r.data?.reduce((e,s)=>e+s.commission_amount,0)||0;b({totalUsers:e.count||0,totalListings:s.count||0,pendingInquiries:a.count||0,completedTransactions:t.count||0,totalRevenue:l});let{data:i}=await N.supabase.from("inquiries").select(`
          *,
          listings(title, category),
          buyer:users!inquiries_buyer_id_fkey(email, full_name),
          seller:users!inquiries_seller_id_fkey(email, full_name)
        `).eq("status","pending").order("created_at",{ascending:!1}).limit(5);w(i||[]);let{data:c}=await N.supabase.from("listings").select(`
          *,
          seller:users!listings_seller_id_fkey(email, full_name)
        `).order("created_at",{ascending:!1}).limit(5);k(c||[]);let{data:{session:n}}=await N.supabase.auth.getSession();if(n?.access_token){let e=await fetch("/api/visits/admin",{headers:{Authorization:`Bearer ${n.access_token}`}}),s=await e.json();e.ok&&q(s.visits||[])}}catch(e){console.error("Error fetching dashboard data:",e)}finally{T(!1)}},z=async(e,s)=>{try{await N.supabase.from("inquiries").update({status:s,admin_notes:"approved"===s?"Approved by admin":"Rejected by admin"}).eq("id",e),B()}catch(e){console.error("Error updating inquiry:",e)}},L=async e=>{try{let{data:{session:s}}=await N.supabase.auth.getSession();if(!s?.access_token)return;let a=await fetch("/api/visits/release",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s.access_token}`},body:JSON.stringify({visit_request_id:e})});if(!a.ok){let e=await a.json();throw Error(e.error||"Failed to release payout")}B()}catch(e){console.error("Error releasing payout:",e)}},R=e=>{switch(e){case"houses":return(0,s.jsx)(l.Home,{className:"h-4 w-4"});case"cars":return(0,s.jsx)(i.Car,{className:"h-4 w-4"});case"land":return(0,s.jsx)(c.Trees,{className:"h-4 w-4"});default:return(0,s.jsx)(n.Package,{className:"h-4 w-4"})}};return S?(0,s.jsx)("div",{className:"flex items-center justify-center h-96",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-red-600 mx-auto"}),(0,s.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading dashboard..."})]})}):(0,s.jsxs)("div",{className:"p-6",children:[(0,s.jsx)("div",{className:"bg-white border-b border-gray-200 -mx-6 px-6 py-6 mb-6",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Admin Dashboard"}),(0,s.jsx)("p",{className:"text-gray-600 mt-1",children:"Manage IkazeProperty.rw platform"})]}),(0,s.jsxs)("div",{className:"flex space-x-3",children:[(0,s.jsx)(t.default,{href:"/dashboard/admin/users",children:(0,s.jsxs)(p.Button,{variant:"outline",className:"border-gray-300 text-gray-700 hover:bg-gray-50",children:[(0,s.jsx)(r.Users,{className:"h-4 w-4 mr-2"}),"Users"]})}),(0,s.jsx)(t.default,{href:"/dashboard/admin/listings",children:(0,s.jsxs)(p.Button,{variant:"outline",className:"border-gray-300 text-gray-700 hover:bg-gray-50",children:[(0,s.jsx)(l.Home,{className:"h-4 w-4 mr-2"}),"Listings"]})}),(0,s.jsx)(t.default,{href:"/dashboard/admin/inquiries",children:(0,s.jsxs)(p.Button,{variant:"outline",className:"border-gray-300 text-gray-700 hover:bg-gray-50",children:[(0,s.jsx)(d.MessageSquare,{className:"h-4 w-4 mr-2"}),"Inquiries"]})}),(0,s.jsx)(t.default,{href:"/dashboard/admin/transactions",children:(0,s.jsxs)(p.Button,{variant:"outline",className:"border-gray-300 text-gray-700 hover:bg-gray-50",children:[(0,s.jsx)(m.DollarSign,{className:"h-4 w-4 mr-2"}),"Transactions"]})}),(0,s.jsx)(t.default,{href:"/dashboard/admin/settings",children:(0,s.jsxs)(p.Button,{variant:"outline",className:"border-gray-300 text-gray-700 hover:bg-gray-50",children:[(0,s.jsx)(y.Settings,{className:"h-4 w-4 mr-2"}),"Settings"]})})]})]})}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-6 mb-8",children:[(0,s.jsx)(f.Card,{children:(0,s.jsx)(f.CardContent,{className:"p-6",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:(0,s.jsx)(r.Users,{className:"h-4 w-4 text-blue-600"})}),(0,s.jsxs)("div",{className:"ml-4",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Total Users"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:e.totalUsers})]})]})})}),(0,s.jsx)(f.Card,{children:(0,s.jsx)(f.CardContent,{className:"p-6",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("div",{className:"w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center",children:(0,s.jsx)(l.Home,{className:"h-4 w-4 text-green-600"})}),(0,s.jsxs)("div",{className:"ml-4",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Total Listings"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:e.totalListings})]})]})})}),(0,s.jsx)(f.Card,{children:(0,s.jsx)(f.CardContent,{className:"p-6",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("div",{className:"w-8 h-8 bg-yellow-100 rounded-lg flex items-center justify-center",children:(0,s.jsx)(o.Clock,{className:"h-4 w-4 text-yellow-600"})}),(0,s.jsxs)("div",{className:"ml-4",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Pending Inquiries"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:e.pendingInquiries})]})]})})}),(0,s.jsx)(f.Card,{children:(0,s.jsx)(f.CardContent,{className:"p-6",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("div",{className:"w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center",children:(0,s.jsx)(h.CheckCircle,{className:"h-4 w-4 text-purple-600"})}),(0,s.jsxs)("div",{className:"ml-4",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Completed"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:e.completedTransactions})]})]})})}),(0,s.jsx)(f.Card,{children:(0,s.jsx)(f.CardContent,{className:"p-6",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("div",{className:"w-8 h-8 bg-red-100 rounded-lg flex items-center justify-center",children:(0,s.jsx)(m.DollarSign,{className:"h-4 w-4 text-red-600"})}),(0,s.jsxs)("div",{className:"ml-4",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Total Revenue"}),(0,s.jsxs)("p",{className:"text-2xl font-bold text-gray-900",children:["RWF ",e.totalRevenue.toLocaleString()]})]})]})})})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,s.jsxs)(f.Card,{children:[(0,s.jsx)(f.CardHeader,{children:(0,s.jsxs)(f.CardTitle,{className:"flex items-center",children:[(0,s.jsx)(g.AlertCircle,{className:"h-5 w-5 mr-2 text-yellow-600"}),"Pending Inquiries (",v.length,")"]})}),(0,s.jsx)(f.CardContent,{children:0===v.length?(0,s.jsx)("p",{className:"text-gray-500 text-center py-4",children:"No pending inquiries"}):(0,s.jsx)("div",{className:"space-y-4",children:v.map(e=>(0,s.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4",children:[(0,s.jsx)("div",{className:"flex items-start justify-between mb-2",children:(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("div",{className:"flex items-center mb-1",children:[R(e.listings.category),(0,s.jsx)("span",{className:"ml-2 font-medium text-gray-900",children:e.listings.title})]}),(0,s.jsxs)("p",{className:"text-sm text-gray-600 mb-2",children:[(0,s.jsx)("strong",{children:"Buyer:"})," ",e.buyer.full_name||e.buyer.email]}),(0,s.jsxs)("p",{className:"text-sm text-gray-600 mb-2",children:[(0,s.jsx)("strong",{children:"Seller:"})," ",e.seller.full_name||e.seller.email]}),(0,s.jsx)("p",{className:"text-sm text-gray-700",children:e.message}),(0,s.jsx)("p",{className:"text-xs text-gray-500 mt-2",children:new Date(e.created_at).toLocaleDateString()})]})}),(0,s.jsxs)("div",{className:"flex space-x-2 mt-3",children:[(0,s.jsxs)(p.Button,{size:"sm",onClick:()=>z(e.id,"approved"),className:"bg-green-600 hover:bg-green-700",children:[(0,s.jsx)(h.CheckCircle,{className:"h-4 w-4 mr-1"}),"Approve"]}),(0,s.jsxs)(p.Button,{size:"sm",variant:"outline",onClick:()=>z(e.id,"rejected"),className:"border-red-600 text-red-600 hover:bg-red-50",children:[(0,s.jsx)(u.XCircle,{className:"h-4 w-4 mr-1"}),"Reject"]}),(0,s.jsx)(t.default,{href:`/dashboard/admin/inquiries/${e.id}`,children:(0,s.jsxs)(p.Button,{size:"sm",variant:"outline",children:[(0,s.jsx)(j.Eye,{className:"h-4 w-4 mr-1"}),"View"]})})]})]},e.id))})})]}),(0,s.jsxs)(f.Card,{children:[(0,s.jsx)(f.CardHeader,{children:(0,s.jsxs)(f.CardTitle,{className:"flex items-center",children:[(0,s.jsx)(x.TrendingUp,{className:"h-5 w-5 mr-2 text-blue-600"}),"Recent Listings"]})}),(0,s.jsx)(f.CardContent,{children:0===C.length?(0,s.jsx)("p",{className:"text-gray-500 text-center py-4",children:"No listings yet"}):(0,s.jsx)("div",{className:"space-y-4",children:C.map(e=>(0,s.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("div",{className:"flex items-center mb-1",children:[R(e.category),(0,s.jsx)("span",{className:"ml-2 font-medium text-gray-900",children:e.title})]}),(0,s.jsxs)("p",{className:"text-sm text-gray-600 mb-1",children:[(0,s.jsx)("strong",{children:"Seller:"})," ",e.seller.full_name||e.seller.email]}),(0,s.jsxs)("p",{className:"text-lg font-bold text-red-600 mb-1",children:["RWF ",e.price.toLocaleString()]}),(0,s.jsx)("p",{className:"text-xs text-gray-500",children:new Date(e.created_at).toLocaleDateString()})]}),(0,s.jsx)("div",{className:"ml-4",children:(0,s.jsx)("span",{className:`px-2 py-1 text-xs rounded-full ${"available"===e.status?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:e.status})})]}),(0,s.jsxs)("div",{className:"flex space-x-2 mt-3",children:[(0,s.jsx)(t.default,{href:`/listings/${e.category}/${e.id}`,children:(0,s.jsxs)(p.Button,{size:"sm",variant:"outline",children:[(0,s.jsx)(j.Eye,{className:"h-4 w-4 mr-1"}),"View"]})}),(0,s.jsx)(t.default,{href:`/dashboard/admin/listings/${e.id}`,children:(0,s.jsx)(p.Button,{size:"sm",variant:"outline",children:"Manage"})})]})]},e.id))})})]})]}),(0,s.jsx)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 mt-8",children:(0,s.jsxs)(f.Card,{children:[(0,s.jsx)(f.CardHeader,{children:(0,s.jsxs)(f.CardTitle,{className:"flex items-center",children:[(0,s.jsx)(m.DollarSign,{className:"h-5 w-5 mr-2 text-green-600"}),"Visit Fee Requests (",_.length,")"]})}),(0,s.jsx)(f.CardContent,{children:0===_.length?(0,s.jsx)("p",{className:"text-gray-500 text-center py-4",children:"No visit requests"}):(0,s.jsx)("div",{className:"space-y-4",children:_.map(e=>(0,s.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4",children:[(0,s.jsx)("div",{className:"flex items-start justify-between",children:(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("div",{className:"flex items-center mb-1",children:[R(e.listings?.category),(0,s.jsx)("span",{className:"ml-2 font-medium text-gray-900",children:e.listings?.title||"Listing"})]}),(0,s.jsxs)("p",{className:"text-sm text-gray-600 mb-1",children:[(0,s.jsx)("strong",{children:"Buyer:"})," ",e.buyer?.full_name||e.buyer?.email]}),(0,s.jsxs)("p",{className:"text-sm text-gray-600 mb-1",children:[(0,s.jsx)("strong",{children:"Seller:"})," ",e.seller?.full_name||e.seller?.email]}),(0,s.jsxs)("p",{className:"text-sm text-gray-700",children:["Visit Fee: ",Number(e.visit_fee_amount||0).toLocaleString()," RWF"]}),(0,s.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["Status: ",e.status," â€¢ Payout: ",e.payout_status]})]})}),(0,s.jsx)("div",{className:"flex space-x-2 mt-3",children:(0,s.jsx)(p.Button,{size:"sm",onClick:()=>L(e.id),disabled:"paid"!==e.status||"released"===e.payout_status,className:"bg-green-600 hover:bg-green-700",children:"Release to Seller (70%)"})})]},e.id))})})]})})]})}e.s(["default",()=>b])}]);