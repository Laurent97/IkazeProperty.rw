(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,86536,e=>{"use strict";let t=(0,e.i(75254).default)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);e.s(["Eye",()=>t],86536)},61911,e=>{"use strict";let t=(0,e.i(75254).default)("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]);e.s(["Users",()=>t],61911)},71689,e=>{"use strict";let t=(0,e.i(75254).default)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);e.s(["ArrowLeft",()=>t],71689)},86311,e=>{"use strict";let t=(0,e.i(75254).default)("message-square",[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]]);e.s(["MessageSquare",()=>t],86311)},73375,e=>{"use strict";let t=(0,e.i(75254).default)("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);e.s(["ChevronLeft",()=>t],73375)},52200,e=>{"use strict";var t=e.i(43476),s=e.i(43432),a=e.i(63488),l=e.i(46897),i=e.i(75240);function r({className:e=""}){let{getPlatformInfo:r}=(0,i.usePaymentMethods)(),n=r();return(0,t.jsxs)("div",{className:`text-xs text-gray-600 space-y-1 ${e}`,children:[(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(s.Phone,{className:"h-3 w-3 mr-2 text-gray-500"}),(0,t.jsx)("span",{children:n.phone})]}),(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(a.Mail,{className:"h-3 w-3 mr-2 text-gray-500"}),(0,t.jsx)("span",{children:n.email})]}),(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(l.MapPin,{className:"h-3 w-3 mr-2 text-gray-500"}),(0,t.jsx)("span",{children:n.address})]})]})}e.s(["default",()=>r])},23066,e=>{"use strict";var t=e.i(43476),s=e.i(71645),a=e.i(90597),l=e.i(19455),i=e.i(86909);function r({listingId:e,className:r="",size:n="md",showText:c=!1}){let[o,d]=(0,s.useState)(!1),[m,h]=(0,s.useState)(!0),[x,u]=(0,s.useState)(null),[f,g]=(0,s.useState)(null),y={sm:"h-8 w-8",md:"h-10 w-10",lg:"h-12 w-12"},p={sm:"h-4 w-4",md:"h-5 w-5",lg:"h-6 w-6"};(0,s.useEffect)(()=>{(async()=>{try{let t=await (0,i.getCurrentUser)();if(!t)return void h(!1);u(t);let{data:s}=await i.supabase.from("listings").select("likes").eq("id",e).single();g(s);let a=await fetch(`/api/favorites?listingId=${e}`);if(a.ok){let e=await a.json();d(e.isFavorited||!1)}else console.error("Error checking favorite status:",a.statusText),d(!1)}catch(e){console.error("Error checking favorite status:",e)}finally{h(!1)}})()},[e]);let v=async()=>{if(!x)return void alert("Please login to favorite listings");try{if(o){let t=await fetch(`/api/favorites?listingId=${e}`,{method:"DELETE"});if(t.ok)d(!1);else{let e=await t.json();if("Not authenticated"===e.error)alert("Please login to manage favorites");else throw Error("Failed to remove favorite")}}else{let t=await fetch("/api/favorites",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({listingId:e})});if(t.ok)d(!0);else{let e=await t.json();if("Not authenticated"===e.error)alert("Please login to add favorites");else throw Error("Failed to add favorite")}}}catch(e){console.error("Error toggling favorite:",e),alert("Error updating favorites. Please try again.")}};return m?(0,t.jsx)(l.Button,{variant:"outline",className:`${r} ${y[n]}`,disabled:!0,children:(0,t.jsx)(a.Heart,{className:`${p[n]} animate-pulse`})}):(0,t.jsxs)(l.Button,{variant:"outline",className:`${r} ${y[n]} ${o?"bg-red-50 border-red-200 text-red-600 hover:bg-red-100":"hover:bg-red-50 hover:border-red-200 hover:text-red-600"}`,onClick:v,title:o?"Remove from favorites":"Add to favorites",children:[(0,t.jsx)(a.Heart,{className:`${p[n]} ${o?"fill-current":""}`}),c&&(0,t.jsx)("span",{className:"ml-2",children:o?"Favorited":"Favorite"})]})}e.s(["default",()=>r])},41383,42347,e=>{"use strict";var t=e.i(43476),s=e.i(71645),a=e.i(90597),l=e.i(61911),i=e.i(19455),r=e.i(75157);let n=s.forwardRef(({className:e,...s},a)=>(0,t.jsx)("div",{ref:a,className:(0,r.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",e),...s}));n.displayName="Avatar";let c=s.forwardRef(({className:e,...s},a)=>(0,t.jsx)("img",{ref:a,className:(0,r.cn)("aspect-square h-full w-full object-cover",e),...s}));c.displayName="AvatarImage";let o=s.forwardRef(({className:e,...s},a)=>(0,t.jsx)("div",{ref:a,className:(0,r.cn)("flex h-full w-full items-center justify-center rounded-full bg-gray-100 text-gray-600",e),...s}));o.displayName="AvatarFallback";var d=e.i(37727);let m=({open:e,onOpenChange:a,children:l})=>(0,t.jsx)(t.Fragment,{children:s.Children.map(l,t=>s.isValidElement(t)?s.cloneElement(t,{open:e,onOpenChange:a}):t)}),h=s.forwardRef(({className:e,onClick:a,open:l,onOpenChange:i,asChild:n=!1,children:c,...o},d)=>n&&s.isValidElement(c)?s.cloneElement(c,{ref:d,className:(0,r.cn)(e,c.props.className),onClick:e=>{c.props.onClick?.(e),a?.(e),i?.(!l)},...o}):(0,t.jsx)("button",{ref:d,className:e,onClick:e=>{a?.(e),i?.(!l)},...o,children:c}));h.displayName="DialogTrigger";let x=s.forwardRef(({className:e,children:s,open:a,onOpenChange:l,...i},r)=>a?(0,t.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[(0,t.jsx)("div",{className:"fixed inset-0 bg-black/80",onClick:()=>l?.(!1)}),(0,t.jsxs)("div",{ref:r,className:`relative z-50 grid w-full max-w-lg gap-4 border bg-background p-6 shadow-lg rounded-lg ${e}`,...i,children:[(0,t.jsxs)("button",{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100",onClick:()=>l?.(!1),children:[(0,t.jsx)(d.X,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"sr-only",children:"Close"})]}),s]})]}):null);x.displayName="DialogContent";let u=({className:e,...s})=>(0,t.jsx)("div",{className:`flex flex-col space-y-1.5 text-center sm:text-left ${e}`,...s});u.displayName="DialogHeader";let f=({className:e,...s})=>(0,t.jsx)("h2",{className:`text-lg font-semibold leading-none tracking-tight ${e}`,...s});f.displayName="DialogTitle";var g=e.i(86909);function y({listingId:e,likesCount:r,className:d=""}){let[y,p]=(0,s.useState)([]),[v,j]=(0,s.useState)(!1),[N,w]=(0,s.useState)(!1),b=async()=>{if(0!==r){j(!0);try{let{data:t,error:s}=await g.supabase.from("listing_likes").select(`
          user_id,
          created_at,
          users!listing_likes_user_id_fkey (
            id,
            full_name,
            email,
            avatar_url
          )
        `).eq("listing_id",e).order("created_at",{ascending:!1}).limit(20);if(s)throw s;let a=(t||[]).map(e=>e.users).filter(Boolean);p(a)}catch(e){console.error("Error fetching liked users:",e)}finally{j(!1)}}};return 0===r?(0,t.jsxs)("div",{className:`flex items-center gap-1 text-gray-500 ${d}`,children:[(0,t.jsx)(a.Heart,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"text-sm",children:"No likes yet"})]}):(0,t.jsxs)(m,{open:N,onOpenChange:e=>{w(e),e&&0===y.length&&b()},children:[(0,t.jsx)(h,{asChild:!0,children:(0,t.jsxs)(i.Button,{variant:"ghost",className:`flex items-center gap-1 text-gray-600 hover:text-red-600 ${d}`,children:[(0,t.jsx)(a.Heart,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"text-sm font-medium",children:r}),(0,t.jsx)("span",{className:"text-xs text-gray-500",children:"likes"})]})}),(0,t.jsxs)(x,{className:"max-w-md",children:[(0,t.jsx)(u,{children:(0,t.jsxs)(f,{className:"flex items-center gap-2",children:[(0,t.jsx)(a.Heart,{className:"h-5 w-5 text-red-500"}),"People who liked this listing"]})}),(0,t.jsx)("div",{className:"space-y-3",children:v?(0,t.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,t.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-red-600"})}):0===y.length?(0,t.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,t.jsx)(l.Users,{className:"h-12 w-12 mx-auto mb-2 opacity-50"}),(0,t.jsx)("p",{children:"No one has liked this listing yet"})]}):(0,t.jsxs)("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:[y.map(e=>(0,t.jsxs)("div",{className:"flex items-center gap-3 p-2 rounded-lg hover:bg-gray-50",children:[(0,t.jsxs)(n,{className:"h-10 w-10",children:[(0,t.jsx)(c,{src:e.avatar_url||"",alt:e.full_name||""}),(0,t.jsx)(o,{children:e.full_name?.charAt(0)?.toUpperCase()||e.email?.charAt(0)?.toUpperCase()||"U"})]}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("p",{className:"font-medium text-sm truncate",children:e.full_name||"Anonymous User"}),(0,t.jsx)("p",{className:"text-xs text-gray-500 truncate",children:e.email||"No email"})]})]},e.id)),y.length<r&&(0,t.jsxs)("div",{className:"text-center py-2 text-sm text-gray-500",children:["And ",r-y.length," more..."]})]})})]})]})}e.s(["default",()=>y],41383);var p=e.i(86536);function v({listingId:e,viewsCount:a,className:l=""}){let[r,n]=(0,s.useState)([]),[c,o]=(0,s.useState)(!1),[d,y]=(0,s.useState)(!1),v=async()=>{if(0!==a){o(!0);try{let{data:t,error:s}=await g.supabase.from("listing_views").select(`
          id,
          user_id,
          ip_address,
          user_agent,
          viewed_at,
          users!listing_views_user_id_fkey (
            id,
            full_name,
            email,
            avatar_url
          )
        `).eq("listing_id",e).order("viewed_at",{ascending:!1}).limit(20);s?(console.error("Error fetching views:",s),n([])):n(t||[])}catch(e){console.error("Error fetching views:",e),n([])}finally{o(!1)}}};return 0===a?(0,t.jsxs)("div",{className:`flex items-center gap-1 text-gray-500 ${l}`,children:[(0,t.jsx)(p.Eye,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"text-sm",children:"No views yet"})]}):(0,t.jsxs)(m,{open:d,onOpenChange:e=>{y(e),e&&0===r.length&&v()},children:[(0,t.jsx)(h,{asChild:!0,children:(0,t.jsxs)(i.Button,{variant:"ghost",className:`flex items-center gap-1 text-gray-600 hover:text-blue-600 ${l}`,children:[(0,t.jsx)(p.Eye,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"text-sm font-medium",children:a}),(0,t.jsx)("span",{className:"text-xs text-gray-500",children:"views"})]})}),(0,t.jsxs)(x,{className:"max-w-md",children:[(0,t.jsx)(u,{children:(0,t.jsxs)(f,{className:"flex items-center gap-2",children:[(0,t.jsx)(p.Eye,{className:"h-5 w-5 text-blue-500"}),"Recent views"]})}),(0,t.jsx)("div",{className:"space-y-3",children:c?(0,t.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,t.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):0===r.length?(0,t.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,t.jsx)(p.Eye,{className:"h-12 w-12 mx-auto mb-2 opacity-50"}),(0,t.jsx)("p",{children:"No views recorded yet"})]}):(0,t.jsxs)("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:[r.map(e=>{let s,a;return(0,t.jsxs)("div",{className:"flex items-center gap-3 p-2 rounded-lg hover:bg-gray-50",children:[(0,t.jsx)("div",{className:"flex-shrink-0",children:e.users?(0,t.jsx)("div",{className:"h-8 w-8 rounded-full bg-blue-100 flex items-center justify-center",children:(0,t.jsx)("span",{className:"text-xs font-medium text-blue-600",children:e.users.full_name?.charAt(0)?.toUpperCase()||"U"})}):(0,t.jsx)("div",{className:"h-8 w-8 rounded-full bg-gray-100 flex items-center justify-center",children:(0,t.jsx)(p.Eye,{className:"h-4 w-4 text-gray-500"})})}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("p",{className:"font-medium text-sm truncate",children:e.users?.full_name||"Anonymous Visitor"}),(0,t.jsxs)("p",{className:"text-xs text-gray-500",children:[(s=new Date(e.viewed_at),(a=Math.floor((new Date().getTime()-s.getTime())/36e5))<1?"Just now":a<24?`${a}h ago`:a<48?"Yesterday":s.toLocaleDateString()),e.ip_address&&` • ${e.ip_address}`]})]})]},e.id)}),r.length<a&&(0,t.jsxs)("div",{className:"text-center py-2 text-sm text-gray-500",children:["And ",a-r.length," more views..."]})]})})]})]})}e.s(["default",()=>v],42347)},74040,e=>{"use strict";var t=e.i(43476),s=e.i(71645),a=e.i(37727),l=e.i(73375),i=e.i(63059),r=e.i(75254);let n=(0,r.default)("zoom-in",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]),c=(0,r.default)("zoom-out",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]),o=(0,r.default)("rotate-ccw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);function d({images:e,initialIndex:r=0,isOpen:d,onClose:m}){let[h,x]=(0,s.useState)(r),[u,f]=(0,s.useState)(1),[g,y]=(0,s.useState)({x:0,y:0}),[p,v]=(0,s.useState)(!1),[j,N]=(0,s.useState)({x:0,y:0}),[w,b]=(0,s.useState)(null),[k,_]=(0,s.useState)(0),C=(0,s.useRef)(null),E=(0,s.useRef)(null);(0,s.useEffect)(()=>{let t=t=>{"Escape"===t.key?m():"ArrowLeft"===t.key?x(t=>(t-1+e.length)%e.length):"ArrowRight"===t.key?x(t=>(t+1+e.length)%e.length):"+"===t.key||"="===t.key?M():"-"===t.key||"_"===t.key?S():"0"===t.key&&$()};if(d)return document.addEventListener("keydown",t),()=>{document.removeEventListener("keydown",t)}},[d,e.length,m]),(0,s.useEffect)(()=>{f(1),y({x:0,y:0})},[h]);let M=()=>{f(e=>Math.min(e+.25,3))},S=()=>{f(e=>Math.max(e-.25,.5))},$=()=>{f(1),y({x:0,y:0})},A=()=>{v(!1)},T=()=>{1===u?f(2):$()};if(!d)return null;let P=()=>{x(t=>(t-1+e.length)%e.length)},D=()=>{x(t=>(t+1+e.length)%e.length)};return(0,t.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-90",children:(0,t.jsxs)("div",{className:"relative w-full h-full flex flex-col",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center p-2 sm:p-4",children:[(0,t.jsx)("button",{onClick:m,title:"Close image viewer",className:"p-2 sm:p-3 text-white hover:bg-gray-800 rounded-full transition-colors touch-manipulation",children:(0,t.jsx)(a.X,{className:"h-5 w-5 sm:h-6 sm:w-6"})}),(0,t.jsxs)("div",{className:"flex items-center gap-1 sm:gap-2",children:[(0,t.jsx)("button",{onClick:S,title:"Zoom out",className:"p-1.5 sm:p-2 text-white hover:bg-gray-800 rounded-full transition-colors disabled:opacity-50 touch-manipulation",disabled:u<=.5,children:(0,t.jsx)(c,{className:"h-4 w-4 sm:h-5 sm:w-5"})}),(0,t.jsxs)("span",{className:"text-white text-xs sm:text-sm min-w-[2.5rem] sm:min-w-[3rem] text-center",children:[Math.round(100*u),"%"]}),(0,t.jsx)("button",{onClick:M,title:"Zoom in",className:"p-1.5 sm:p-2 text-white hover:bg-gray-800 rounded-full transition-colors disabled:opacity-50 touch-manipulation",disabled:u>=3,children:(0,t.jsx)(n,{className:"h-4 w-4 sm:h-5 sm:w-5"})}),(0,t.jsx)("button",{onClick:$,title:"Reset zoom",className:"p-1.5 sm:p-2 text-white hover:bg-gray-800 rounded-full transition-colors touch-manipulation hidden sm:block",children:(0,t.jsx)(o,{className:"h-4 w-4 sm:h-5 sm:w-5"})})]})]}),(0,t.jsx)("div",{ref:C,className:"flex-1 relative overflow-hidden flex items-center justify-center touch-none",onWheel:e=>{e.preventDefault(),e.deltaY<0?M():S()},onTouchStart:e=>{let t=e.touches;1===t.length?b({x:t[0].clientX,y:t[0].clientY,distance:0}):2===t.length&&b({x:0,y:0,distance:Math.hypot(t[1].clientX-t[0].clientX,t[1].clientY-t[0].clientY)})},onTouchMove:e=>{e.preventDefault();let t=e.touches;if(1===t.length&&w){if(u>1){let e=t[0].clientX-w.x,s=t[0].clientY-w.y;y(t=>({x:t.x+e,y:t.y+s})),b({...w,x:t[0].clientX,y:t[0].clientY})}}else if(2===t.length&&w&&w.distance>0){let e=Math.hypot(t[1].clientX-t[0].clientX,t[1].clientY-t[0].clientY);f(Math.min(Math.max(u*(e/w.distance),.5),3)),b({...w,distance:e})}},onTouchEnd:e=>{let t=new Date().getTime(),s=t-k;if(s<300&&s>0&&0===e.touches.length&&T(),_(t),w&&0===w.distance&&1===u){let t=e.changedTouches[0],s=t.clientX-w.x,a=t.clientY-w.y,l=Math.abs(s),i=Math.abs(a);l>50&&l>i&&(s>0?P():D())}b(null)},onMouseDown:e=>{u>1&&(v(!0),N({x:e.clientX-g.x,y:e.clientY-g.y}))},onMouseMove:e=>{p&&u>1&&y({x:e.clientX-j.x,y:e.clientY-j.y})},onMouseUp:A,onMouseLeave:A,children:(0,t.jsx)("div",{className:"relative",style:{"--scale":u,"--translate-x":`${g.x/u}px`,"--translate-y":`${g.y/u}px`,transform:"scale(var(--scale)) translate(var(--translate-x), var(--translate-y))",transition:p?"none":"transform 0.2s ease-out",cursor:u>1?p?"grabbing":"grab":"pointer"},onDoubleClick:T,children:(0,t.jsx)("img",{ref:E,src:e[h],alt:`Property image ${h+1}`,className:"max-w-full max-h-full object-contain select-none touch-none",draggable:!1})})}),e.length>1&&(0,t.jsxs)("div",{className:"flex justify-between items-center p-2 sm:p-4",children:[(0,t.jsx)("button",{onClick:P,title:"Previous image",className:"p-2 sm:p-3 bg-white bg-opacity-20 hover:bg-opacity-30 rounded-full transition-all touch-manipulation",disabled:0===h,children:(0,t.jsx)(l.ChevronLeft,{className:"h-4 w-4 sm:h-5 sm:w-5"})}),(0,t.jsxs)("div",{className:"text-white text-xs sm:text-sm",children:[h+1," / ",e.length]}),(0,t.jsx)("button",{onClick:D,title:"Next image",className:"p-2 sm:p-3 bg-white bg-opacity-20 hover:bg-opacity-30 rounded-full transition-all touch-manipulation",disabled:h===e.length-1,children:(0,t.jsx)(i.ChevronRight,{className:"h-4 w-4 sm:h-5 sm:w-5"})})]}),(0,t.jsx)("div",{className:"block sm:hidden text-center text-white text-xs opacity-75 p-2",children:(0,t.jsx)("p",{children:"Swipe to navigate • Pinch to zoom • Double-tap to zoom"})})]})})}e.s(["default",()=>d],74040)},9553,e=>{e.v(e=>Promise.resolve().then(()=>e(90676)))}]);