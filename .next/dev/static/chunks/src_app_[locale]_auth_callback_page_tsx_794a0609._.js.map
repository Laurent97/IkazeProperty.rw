{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///D:/Apps/IkazeProperty.rw/src/app/%5Blocale%5D/auth/callback/page.tsx"],"sourcesContent":["'use client'\n\nimport { useEffect, useState } from 'react'\nimport { useRouter } from 'next/navigation'\nimport { supabase } from '@/lib/auth'\n\nexport default function AuthCallback() {\n  const router = useRouter()\n  const [loading, setLoading] = useState(true)\n  const [error, setError] = useState<string | null>(null)\n\n  useEffect(() => {\n    const handleAuthCallback = async () => {\n      try {\n        // Get the session from the URL hash\n        const { data, error } = await supabase.auth.getSession()\n        \n        if (error) {\n          console.error('Auth callback error:', error)\n          setError('Authentication failed. Please try again.')\n          setTimeout(() => {\n            router.push('/login')\n          }, 3000)\n          return\n        }\n\n        if (data.session) {\n          // User successfully signed in\n          console.log('User authenticated:', data.session.user)\n          \n          // Check if user profile exists, create if not\n          const { data: profile, error: profileError } = await supabase\n            .from('users')\n            .select('*')\n            .eq('id', data.session.user.id)\n            .single()\n\n          if (profileError && profileError.code === 'PGRST116') {\n            // Profile doesn't exist, create one\n            const { error: insertError } = await (supabase\n              .from('users') as any)\n              .insert({\n                email: data.session.user.email || '',\n                full_name: data.session.user.user_metadata?.full_name || data.session.user.user_metadata?.name || null,\n                avatar_url: data.session.user.user_metadata?.avatar_url || null,\n                role: 'user',\n                verified: true\n              })\n\n            if (insertError) {\n              console.error('Error creating profile:', insertError)\n            }\n          }\n\n          // Redirect to dashboard or home\n          router.push('/dashboard')\n        } else {\n          // No session found, redirect to login\n          router.push('/login')\n        }\n      } catch (err) {\n        console.error('Callback error:', err)\n        setError('An error occurred during authentication.')\n        setTimeout(() => {\n          router.push('/login')\n        }, 3000)\n      } finally {\n        setLoading(false)\n      }\n    }\n\n    handleAuthCallback()\n  }, [router])\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center bg-gray-50\">\n        <div className=\"text-center\">\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto\"></div>\n          <p className=\"mt-4 text-gray-600\">Completing sign in...</p>\n        </div>\n      </div>\n    )\n  }\n\n  if (error) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center bg-gray-50\">\n        <div className=\"text-center\">\n          <div className=\"text-red-600 mb-4\">\n            <svg className=\"w-16 h-16 mx-auto\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z\" />\n            </svg>\n          </div>\n          <p className=\"text-gray-600\">{error}</p>\n          <p className=\"text-sm text-gray-500 mt-2\">Redirecting to login page...</p>\n        </div>\n      </div>\n    )\n  }\n\n  return null\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;;;AAJA;;;;AAMe,SAAS;;IACtB,MAAM,SAAS,IAAA,kJAAS;IACxB,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,yKAAQ,EAAC;IACvC,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,yKAAQ,EAAgB;IAElD,IAAA,0KAAS;kCAAC;YACR,MAAM;6DAAqB;oBACzB,IAAI;wBACF,oCAAoC;wBACpC,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,iIAAQ,CAAC,IAAI,CAAC,UAAU;wBAEtD,IAAI,OAAO;4BACT,QAAQ,KAAK,CAAC,wBAAwB;4BACtC,SAAS;4BACT;6EAAW;oCACT,OAAO,IAAI,CAAC;gCACd;4EAAG;4BACH;wBACF;wBAEA,IAAI,KAAK,OAAO,EAAE;4BAChB,8BAA8B;4BAC9B,QAAQ,GAAG,CAAC,uBAAuB,KAAK,OAAO,CAAC,IAAI;4BAEpD,8CAA8C;4BAC9C,MAAM,EAAE,MAAM,OAAO,EAAE,OAAO,YAAY,EAAE,GAAG,MAAM,iIAAQ,CAC1D,IAAI,CAAC,SACL,MAAM,CAAC,KACP,EAAE,CAAC,MAAM,KAAK,OAAO,CAAC,IAAI,CAAC,EAAE,EAC7B,MAAM;4BAET,IAAI,gBAAgB,aAAa,IAAI,KAAK,YAAY;gCACpD,oCAAoC;gCACpC,MAAM,EAAE,OAAO,WAAW,EAAE,GAAG,MAAM,AAAC,iIAAQ,CAC3C,IAAI,CAAC,SACL,MAAM,CAAC;oCACN,OAAO,KAAK,OAAO,CAAC,IAAI,CAAC,KAAK,IAAI;oCAClC,WAAW,KAAK,OAAO,CAAC,IAAI,CAAC,aAAa,EAAE,aAAa,KAAK,OAAO,CAAC,IAAI,CAAC,aAAa,EAAE,QAAQ;oCAClG,YAAY,KAAK,OAAO,CAAC,IAAI,CAAC,aAAa,EAAE,cAAc;oCAC3D,MAAM;oCACN,UAAU;gCACZ;gCAEF,IAAI,aAAa;oCACf,QAAQ,KAAK,CAAC,2BAA2B;gCAC3C;4BACF;4BAEA,gCAAgC;4BAChC,OAAO,IAAI,CAAC;wBACd,OAAO;4BACL,sCAAsC;4BACtC,OAAO,IAAI,CAAC;wBACd;oBACF,EAAE,OAAO,KAAK;wBACZ,QAAQ,KAAK,CAAC,mBAAmB;wBACjC,SAAS;wBACT;yEAAW;gCACT,OAAO,IAAI,CAAC;4BACd;wEAAG;oBACL,SAAU;wBACR,WAAW;oBACb;gBACF;;YAEA;QACF;iCAAG;QAAC;KAAO;IAEX,IAAI,SAAS;QACX,qBACE,6LAAC;YAAI,WAAU;sBACb,cAAA,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBAAI,WAAU;;;;;;kCACf,6LAAC;wBAAE,WAAU;kCAAqB;;;;;;;;;;;;;;;;;IAI1C;IAEA,IAAI,OAAO;QACT,qBACE,6LAAC;YAAI,WAAU;sBACb,cAAA,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBAAI,WAAU;kCACb,cAAA,6LAAC;4BAAI,WAAU;4BAAoB,MAAK;4BAAO,QAAO;4BAAe,SAAQ;sCAC3E,cAAA,6LAAC;gCAAK,eAAc;gCAAQ,gBAAe;gCAAQ,aAAa;gCAAG,GAAE;;;;;;;;;;;;;;;;kCAGzE,6LAAC;wBAAE,WAAU;kCAAiB;;;;;;kCAC9B,6LAAC;wBAAE,WAAU;kCAA6B;;;;;;;;;;;;;;;;;IAIlD;IAEA,OAAO;AACT;GAhGwB;;QACP,kJAAS;;;KADF"}}]
}