{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///D:/Apps/IkazeProperty.rw/src/lib/supabase-client.ts"],"sourcesContent":["import { createClient } from '@supabase/supabase-js'\nimport { Database } from '@/types/database'\n\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL\nconst supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY\n\nif (!supabaseUrl || !supabaseAnonKey) {\n  throw new Error('Missing Supabase environment variables. Please check your .env.local file.')\n}\n\n// Create a single Supabase client for the entire app\nexport const supabaseClient = createClient<Database>(supabaseUrl, supabaseAnonKey, {\n  auth: {\n    persistSession: true,\n    autoRefreshToken: true,\n    detectSessionInUrl: true,\n  },\n  global: {\n    headers: {\n      'Accept': 'application/json',\n      'Content-Type': 'application/json',\n    }\n  }\n})\n\n// Export as default for backward compatibility\nexport default supabaseClient\n\n// Helper function to fetch listings with proper error handling\nexport async function fetchListingsWithDetails(filters: {\n  category?: string;\n  searchQuery?: string;\n  priceRange?: { min?: string; max?: string };\n  subcategory?: string;\n  condition?: string;\n  sortBy?: string;\n  limit?: number;\n}) {\n  try {\n    const {\n      category = 'other',\n      searchQuery = '',\n      priceRange = {},\n      subcategory = '',\n      condition = '',\n      sortBy = 'created_at',\n      limit = 50\n    } = filters\n\n    let query = supabaseClient\n      .from('listings')\n      .select(`\n        *,\n        seller:users!listings_seller_id_fkey(\n          id,\n          full_name,\n          email,\n          avatar_url\n        )\n      `)\n      .eq('status', 'available')\n      .eq('category', category)\n\n    // Apply text search\n    if (searchQuery.trim()) {\n      query = query.or(`title.ilike.%${searchQuery}%,description.ilike.%${searchQuery}%`)\n    }\n\n    // Apply price range\n    if (priceRange.min) {\n      const min = parseInt(priceRange.min) || 0\n      query = query.gte('price', min)\n    }\n    if (priceRange.max) {\n      const max = parseInt(priceRange.max) || 1000000000\n      query = query.lte('price', max)\n    }\n\n    // Apply sorting\n    switch (sortBy) {\n      case 'price':\n        query = query.order('price', { ascending: true })\n        break\n      case 'price_desc':\n        query = query.order('price', { ascending: false })\n        break\n      case 'views':\n        query = query.order('views', { ascending: false })\n        break\n      case 'likes':\n        query = query.order('likes', { ascending: false })\n        break\n      default:\n        query = query.order('created_at', { ascending: false })\n    }\n\n    query = query.limit(limit)\n\n    const { data: listings, error: listingsError } = await query\n\n    if (listingsError) {\n      console.error('Error fetching listings:', listingsError)\n      return { listings: [], error: listingsError }\n    }\n\n    if (!listings || listings.length === 0) {\n      return { listings: [] }\n    }\n\n    // Fetch additional data in parallel\n    const listingIds = (listings as any[]).map(l => l.id)\n    \n    const [mediaResult, detailsResult] = await Promise.all([\n      supabaseClient\n        .from('listing_media')\n        .select('*')\n        .in('listing_id', listingIds)\n        .order('order_index', { ascending: true }),\n      supabaseClient\n        .from('other_item_details')\n        .select('*')\n        .in('listing_id', listingIds)\n    ])\n\n    // Process the data\n    const listingsWithDetails = (listings as any[]).map(listing => {\n      const listingMedia = mediaResult.data?.filter((m: any) => m.listing_id === listing.id) || []\n      const listingDetails = detailsResult.data?.find((d: any) => d.listing_id === listing.id)\n\n      return {\n        ...listing,\n        media: listingMedia.map((media: any) => ({\n          url: media.url,\n          public_id: media.public_id,\n          media_type: media.media_type,\n          is_primary: media.is_primary,\n          order_index: media.order_index\n        })),\n        other_details: listingDetails ? {\n          subcategory: (listingDetails as any).subcategory,\n          brand: (listingDetails as any).brand,\n          model: (listingDetails as any).model,\n          condition: (listingDetails as any).condition,\n          warranty_available: (listingDetails as any).warranty_available,\n          warranty_period: (listingDetails as any).warranty_period,\n          reason_for_selling: (listingDetails as any).reason_for_selling,\n          original_purchase_date: (listingDetails as any).original_purchase_date,\n          age_of_item: (listingDetails as any).age_of_item\n        } : undefined\n      }\n    })\n\n    // Apply additional filters after fetching\n    let filteredListings = listingsWithDetails\n    \n    if (subcategory) {\n      filteredListings = filteredListings.filter(l => \n        l.other_details?.subcategory === subcategory\n      )\n    }\n    \n    if (condition) {\n      filteredListings = filteredListings.filter(l => \n        l.other_details?.condition === condition\n      )\n    }\n\n    return { listings: filteredListings }\n  } catch (error) {\n    console.error('Error in fetchListingsWithDetails:', error)\n    return { listings: [], error }\n  }\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 197, "column": 0}, "map": {"version":3,"sources":["file:///D:/Apps/IkazeProperty.rw/src/lib/auth.ts"],"sourcesContent":["import { createClient } from '@supabase/supabase-js'\nimport { Database } from '@/types/database'\nimport { supabaseClient } from '@/lib/supabase-client'\n\nlet _supabaseAdmin: ReturnType<typeof createClient<Database>> | null = null\nlet _supabaseAuth: ReturnType<typeof createClient<Database>> | null = null\n\nexport const getSupabaseAdmin = () => {\n  if (!_supabaseAdmin) {\n    const supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL\n    const supabaseServiceKey = process.env.SUPABASE_SERVICE_ROLE_KEY\n\n    if (!supabaseUrl || !supabaseServiceKey) {\n      throw new Error('Missing Supabase environment variables. Please check your .env.local file.')\n    }\n\n    _supabaseAdmin = createClient<Database>(supabaseUrl, supabaseServiceKey)\n  }\n  return _supabaseAdmin\n}\n\nexport const getSupabaseAuth = () => {\n  if (!_supabaseAuth) {\n    const supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL\n    const supabaseServiceKey = process.env.SUPABASE_SERVICE_ROLE_KEY\n\n    if (!supabaseUrl || !supabaseServiceKey) {\n      throw new Error('Missing Supabase environment variables. Please check your .env.local file.')\n    }\n\n    _supabaseAuth = createClient<Database>(supabaseUrl, supabaseServiceKey)\n  }\n  return _supabaseAuth\n}\n\nexport const supabase = supabaseClient\n\n// For backward compatibility, export the getter functions with the same names\nexport const supabaseAdmin = getSupabaseAdmin\nexport const supabaseAuth = getSupabaseAuth\n\nexport const signUp = async (email: string, password: string, fullName: string) => {\n  const response = await fetch('/api/auth/register', {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n    },\n    body: JSON.stringify({\n      email,\n      password,\n      fullName\n    })\n  })\n\n  const data = await response.json()\n\n  if (!response.ok) {\n    throw new Error(data.error || 'Registration failed')\n  }\n\n  return data\n}\n\nexport const signIn = async (email: string, password: string) => {\n  const { data, error } = await supabase.auth.signInWithPassword({\n    email,\n    password\n  })\n\n  if (error) throw error\n  return data\n}\n\nexport const signOut = async () => {\n  const { error } = await supabase.auth.signOut()\n  if (error) throw error\n}\n\nexport const getCurrentUser = async () => {\n  const { data: { user }, error } = await supabase.auth.getUser()\n  if (error) throw error\n  return user\n}\n\nexport const getUserProfile = async (userId: string) => {\n  const { data, error } = await supabase\n    .from('users')\n    .select('*')\n    .eq('id', userId)\n    .single()\n\n  if (error && error.code !== 'PGRST116') { // PGRST116 is the error code for \"no rows returned\"\n    throw error\n  }\n  return data\n}\n\nexport const updateUserProfile = async (userId: string, updates: any) => {\n  const authClient = supabaseAuth()\n  const { data, error } = await (authClient as any)\n    .from('users')\n    .update(updates)\n    .eq('id', userId)\n    .select()\n    .single()\n\n  if (error) throw error\n  return data\n}\n\nexport const resetPassword = async (email: string) => {\n  const { error } = await supabase.auth.resetPasswordForEmail(email)\n  if (error) throw error\n}\n\nexport const updatePassword = async (password: string) => {\n  const { error } = await supabase.auth.updateUser({\n    password\n  })\n\n  if (error) throw error\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAEA;;;AAEA,IAAI,iBAAmE;AACvE,IAAI,gBAAkE;AAE/D,MAAM,mBAAmB;IAC9B,IAAI,CAAC,gBAAgB;QACnB,MAAM;QACN,MAAM,qBAAqB,QAAQ,GAAG,CAAC,yBAAyB;QAEhE,IAAI,CAAC,eAAe,CAAC,oBAAoB;YACvC,MAAM,IAAI,MAAM;QAClB;QAEA,iBAAiB,IAAA,gMAAY,EAAW,aAAa;IACvD;IACA,OAAO;AACT;AAEO,MAAM,kBAAkB;IAC7B,IAAI,CAAC,eAAe;QAClB,MAAM;QACN,MAAM,qBAAqB,QAAQ,GAAG,CAAC,yBAAyB;QAEhE,IAAI,CAAC,eAAe,CAAC,oBAAoB;YACvC,MAAM,IAAI,MAAM;QAClB;QAEA,gBAAgB,IAAA,gMAAY,EAAW,aAAa;IACtD;IACA,OAAO;AACT;AAEO,MAAM,WAAW,oJAAc;AAG/B,MAAM,gBAAgB;AACtB,MAAM,eAAe;AAErB,MAAM,SAAS,OAAO,OAAe,UAAkB;IAC5D,MAAM,WAAW,MAAM,MAAM,sBAAsB;QACjD,QAAQ;QACR,SAAS;YACP,gBAAgB;QAClB;QACA,MAAM,KAAK,SAAS,CAAC;YACnB;YACA;YACA;QACF;IACF;IAEA,MAAM,OAAO,MAAM,SAAS,IAAI;IAEhC,IAAI,CAAC,SAAS,EAAE,EAAE;QAChB,MAAM,IAAI,MAAM,KAAK,KAAK,IAAI;IAChC;IAEA,OAAO;AACT;AAEO,MAAM,SAAS,OAAO,OAAe;IAC1C,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,SAAS,IAAI,CAAC,kBAAkB,CAAC;QAC7D;QACA;IACF;IAEA,IAAI,OAAO,MAAM;IACjB,OAAO;AACT;AAEO,MAAM,UAAU;IACrB,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,SAAS,IAAI,CAAC,OAAO;IAC7C,IAAI,OAAO,MAAM;AACnB;AAEO,MAAM,iBAAiB;IAC5B,MAAM,EAAE,MAAM,EAAE,IAAI,EAAE,EAAE,KAAK,EAAE,GAAG,MAAM,SAAS,IAAI,CAAC,OAAO;IAC7D,IAAI,OAAO,MAAM;IACjB,OAAO;AACT;AAEO,MAAM,iBAAiB,OAAO;IACnC,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,SAC3B,IAAI,CAAC,SACL,MAAM,CAAC,KACP,EAAE,CAAC,MAAM,QACT,MAAM;IAET,IAAI,SAAS,MAAM,IAAI,KAAK,YAAY;QACtC,MAAM;IACR;IACA,OAAO;AACT;AAEO,MAAM,oBAAoB,OAAO,QAAgB;IACtD,MAAM,aAAa;IACnB,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,AAAC,WAC5B,IAAI,CAAC,SACL,MAAM,CAAC,SACP,EAAE,CAAC,MAAM,QACT,MAAM,GACN,MAAM;IAET,IAAI,OAAO,MAAM;IACjB,OAAO;AACT;AAEO,MAAM,gBAAgB,OAAO;IAClC,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,SAAS,IAAI,CAAC,qBAAqB,CAAC;IAC5D,IAAI,OAAO,MAAM;AACnB;AAEO,MAAM,iBAAiB,OAAO;IACnC,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,SAAS,IAAI,CAAC,UAAU,CAAC;QAC/C;IACF;IAEA,IAAI,OAAO,MAAM;AACnB"}},
    {"offset": {"line": 318, "column": 0}, "map": {"version":3,"sources":["file:///D:/Apps/IkazeProperty.rw/src/app/api/favorites/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server'\nimport { getSupabaseAdmin } from '@/lib/auth'\nimport { getCurrentUser } from '@/lib/auth'\n\nexport async function POST(request: NextRequest) {\n  try {\n    const user = await getCurrentUser()\n    if (!user) {\n      return NextResponse.json({ \n        error: 'Not authenticated' \n      }, { status: 401 })\n    }\n\n    const { listingId } = await request.json()\n    \n    if (!listingId) {\n      return NextResponse.json({ error: 'Listing ID is required' }, { status: 400 })\n    }\n\n    const supabase = getSupabaseAdmin()\n\n    // Check if already favorited\n    const { data: existing } = await supabase\n      .from('favorite_listings')\n      .select('*')\n      .eq('user_id', user.id)\n      .eq('listing_id', listingId)\n      .single()\n\n    if (existing) {\n      return NextResponse.json({ error: 'Already favorited' }, { status: 409 })\n    }\n\n    // Add to favorites\n    const { error } = await supabase\n      .from('favorite_listings')\n      .insert({\n        user_id: user.id,\n        listing_id: listingId\n      } as any)\n\n    if (error) {\n      console.error('Error adding favorite:', error)\n      return NextResponse.json({ error: 'Failed to add favorite' }, { status: 500 })\n    }\n\n    return NextResponse.json({ success: true, favorited: true })\n  } catch (error: any) {\n    console.error('Error in POST favorite:', error)\n    \n    // Handle authentication errors gracefully\n    if (error.message?.includes('AuthSessionMissing') || error.status === 400) {\n      return NextResponse.json({ \n        error: 'Not authenticated' \n      }, { status: 401 })\n    }\n    \n    return NextResponse.json({ error: 'Internal server error' }, { status: 500 })\n  }\n}\n\nexport async function DELETE(request: NextRequest) {\n  try {\n    const user = await getCurrentUser()\n    if (!user) {\n      return NextResponse.json({ \n        error: 'Not authenticated' \n      }, { status: 401 })\n    }\n\n    const { searchParams } = new URL(request.url)\n    const listingId = searchParams.get('listingId')\n\n    if (!listingId) {\n      return NextResponse.json({ error: 'Listing ID is required' }, { status: 400 })\n    }\n\n    const supabase = getSupabaseAdmin()\n\n    // Remove from favorites\n    const { error } = await supabase\n      .from('favorite_listings')\n      .delete()\n      .eq('user_id', user.id)\n      .eq('listing_id', listingId)\n\n    if (error) {\n      console.error('Error removing favorite:', error)\n      return NextResponse.json({ error: 'Failed to remove favorite' }, { status: 500 })\n    }\n\n    return NextResponse.json({ success: true, favorited: false })\n  } catch (error: any) {\n    console.error('Error in DELETE favorite:', error)\n    \n    // Handle authentication errors gracefully\n    if (error.message?.includes('AuthSessionMissing') || error.status === 400) {\n      return NextResponse.json({ \n        error: 'Not authenticated' \n      }, { status: 401 })\n    }\n    \n    return NextResponse.json({ error: 'Internal server error' }, { status: 500 })\n  }\n}\n\nexport async function GET(request: NextRequest) {\n  try {\n    const user = await getCurrentUser()\n    if (!user) {\n      return NextResponse.json({ \n        success: true, \n        isFavorited: false,\n        favorites: [],\n        error: 'Not authenticated' \n      }, { status: 200 })\n    }\n\n    const { searchParams } = new URL(request.url)\n    const listingId = searchParams.get('listingId')\n\n    const supabase = getSupabaseAdmin()\n\n    if (listingId) {\n      // Check if specific listing is favorited (existing functionality)\n      const { data, error } = await supabase\n        .from('favorite_listings')\n        .select('*')\n        .eq('user_id', user.id)\n        .eq('listing_id', listingId)\n        .single()\n\n      if (error && error.code !== 'PGRST116') {\n        console.error('Error checking favorite status:', error)\n        return NextResponse.json({ error: 'Failed to check favorite status' }, { status: 500 })\n      }\n\n      return NextResponse.json({ \n        success: true, \n        isFavorited: !!data \n      })\n    } else {\n      // Get all favorites with full listing data\n      const { data, error } = await supabase\n        .from('favorite_listings')\n        .select(`\n          listings (\n            id,\n            title,\n            price,\n            currency,\n            category,\n            status,\n            location,\n            views,\n            likes,\n            featured,\n            created_at,\n            listing_media (\n              id,\n              url,\n              media_type,\n              is_primary,\n              order_index\n            )\n          )\n        `)\n        .eq('user_id', user.id)\n        .order('created_at', { ascending: false })\n\n      if (error) {\n        console.error('Error fetching favorites:', error)\n        return NextResponse.json({ error: 'Failed to fetch favorites' }, { status: 500 })\n      }\n\n      const favorites = (data as any[] || []).map(fav => fav.listings).filter(Boolean)\n      return NextResponse.json({ \n        success: true, \n        favorites \n      })\n    }\n  } catch (error: any) {\n    console.error('Error in GET favorites:', error)\n    \n    // Handle authentication errors gracefully\n    if (error.message?.includes('AuthSessionMissing') || error.status === 400) {\n      return NextResponse.json({ \n        success: true, \n        isFavorited: false,\n        favorites: [],\n        error: 'Not authenticated' \n      }, { status: 200 })\n    }\n    \n    return NextResponse.json({ error: 'Internal server error' }, { status: 500 })\n  }\n}\n"],"names":[],"mappings":"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"}}]
}