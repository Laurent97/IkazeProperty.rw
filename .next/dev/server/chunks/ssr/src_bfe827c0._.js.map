{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///D:/Apps/IkazeProperty.rw/src/components/ui/input.tsx"],"sourcesContent":["import * as React from \"react\"\n\nexport interface InputProps\n  extends React.InputHTMLAttributes<HTMLInputElement> {}\n\nconst Input = React.forwardRef<HTMLInputElement, InputProps>(\n  ({ className, type, ...props }, ref) => {\n    return (\n      <input\n        type={type}\n        className={`flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 ${className || ''}`}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nInput.displayName = \"Input\"\n\nexport { Input }\n"],"names":[],"mappings":";;;;;AAAA;;;AAKA,MAAM,sBAAQ,mNAAgB,CAC5B,CAAC,EAAE,SAAS,EAAE,IAAI,EAAE,GAAG,OAAO,EAAE;IAC9B,qBACE,8OAAC;QACC,MAAM;QACN,WAAW,CAAC,6VAA6V,EAAE,aAAa,IAAI;QAC5X,KAAK;QACJ,GAAG,KAAK;;;;;;AAGf;AAEF,MAAM,WAAW,GAAG"}},
    {"offset": {"line": 30, "column": 0}, "map": {"version":3,"sources":["file:///D:/Apps/IkazeProperty.rw/src/components/chat/InquiryChat.tsx"],"sourcesContent":["'use client'\n\nimport { useState, useRef, useEffect } from 'react'\nimport { MessageCircle, Send, X, User, Shield } from 'lucide-react'\nimport { Button } from '@/components/ui/button'\nimport { Input } from '@/components/ui/input'\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Badge } from '@/components/ui/badge'\nimport { useAuth } from '@/contexts/AuthContext'\n\ninterface Message {\n  id: string\n  text: string\n  sender: 'admin' | 'customer'\n  timestamp: Date | string | null | undefined\n  senderName?: string\n}\n\ninterface InquiryChatProps {\n  inquiryId: string\n  customerId: string\n  customerName: string\n  customerEmail: string\n  isOpen?: boolean\n  onToggle?: () => void\n  userType?: 'admin' | 'customer'\n}\n\nexport default function InquiryChat({ \n  inquiryId, \n  customerId, \n  customerName, \n  customerEmail, \n  isOpen: controlledIsOpen, \n  onToggle,\n  userType = 'customer'\n}: InquiryChatProps) {\n  const { user } = useAuth()\n  const [isInternalOpen, setIsInternalOpen] = useState(false)\n  const [messages, setMessages] = useState<Message[]>([])\n  const [inputText, setInputText] = useState('')\n  const [isLoading, setIsLoading] = useState(false)\n  const [isTyping, setIsTyping] = useState(false)\n  const messagesEndRef = useRef<HTMLDivElement>(null)\n\n  const isControlled = controlledIsOpen !== undefined\n  const isOpen = isControlled ? controlledIsOpen : isInternalOpen\n  const toggleChat = isControlled ? onToggle : () => setIsInternalOpen(!isInternalOpen)\n\n  const scrollToBottom = () => {\n    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' })\n  }\n\n  useEffect(() => {\n    scrollToBottom()\n  }, [messages])\n\n  useEffect(() => {\n    if (isOpen && inquiryId) {\n      loadMessages()\n    }\n  }, [isOpen, inquiryId])\n\n  const loadMessages = async () => {\n    try {\n      setIsLoading(true)\n      \n      // Get session token for API call\n      const { supabaseClient } = await import('@/lib/supabase-client')\n      const { data: { session } } = await supabaseClient.auth.getSession()\n      \n      if (!session?.access_token) {\n        console.error('No session token found')\n        return\n      }\n\n      // Load chat messages for this inquiry\n      const response = await fetch(`/api/inquiries/${inquiryId}/chat`, {\n        headers: {\n          'Authorization': `Bearer ${session.access_token}`\n        }\n      })\n\n      if (response.ok) {\n        const result = await response.json()\n        // Map database fields to component interface\n        const mappedMessages = (result.data || []).map((msg: any) => ({\n          ...msg,\n          sender: msg.sender_type, // Map sender_type to sender\n          text: msg.message, // Map message field to text\n          timestamp: msg.created_at // Map created_at to timestamp\n        }))\n        setMessages(mappedMessages)\n      } else {\n        const errorData = await response.json()\n        console.error('Chat API error:', errorData)\n        // Show user-friendly error message\n        if (response.status === 503) {\n          console.error('Chat table not set up. Please contact administrator.')\n        }\n      }\n    } catch (error) {\n      console.error('Error loading messages:', error)\n    } finally {\n      setIsLoading(false)\n    }\n  }\n\n  const sendMessage = async () => {\n    if (!inputText.trim() || !user) return\n\n    // Use the userType prop to determine sender type\n    const senderType = userType\n\n    const newMessage: Message = {\n      id: Date.now().toString(),\n      text: inputText.trim(),\n      sender: senderType,\n      timestamp: new Date(),\n      senderName: user.email\n    }\n\n    try {\n      setIsTyping(true)\n      setInputText('')\n\n      // Get session token for API call\n      const { supabaseClient } = await import('@/lib/supabase-client')\n      const { data: { session } } = await supabaseClient.auth.getSession()\n      \n      if (!session?.access_token) {\n        throw new Error('No session token')\n      }\n\n      // Send message via API\n      const response = await fetch(`/api/inquiries/${inquiryId}/chat`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${session.access_token}`\n        },\n        body: JSON.stringify({\n          message: newMessage.text,\n          sender: senderType\n        })\n      })\n\n      if (response.ok) {\n        const result = await response.json()\n        // Use the server response with proper field mapping\n        const serverMessage = {\n          ...result.data,\n          sender: result.data.sender_type, // Map sender_type to sender\n          text: result.data.message, // Map message field to text\n          timestamp: result.data.created_at // Map created_at to timestamp\n        }\n        setMessages(prev => [...prev, serverMessage])\n      } else {\n        const errorData = await response.json()\n        console.error('Send message API error:', errorData)\n        throw new Error(errorData.error || 'Failed to send message')\n      }\n    } catch (error) {\n      console.error('Error sending message:', error)\n      // Revert the input if sending failed\n      setInputText(newMessage.text)\n      // Show error message to user\n      alert('Failed to send message. Please try again.')\n    } finally {\n      setIsTyping(false)\n    }\n  }\n\n  const handleKeyPress = (e: React.KeyboardEvent) => {\n    if (e.key === 'Enter' && !e.shiftKey) {\n      e.preventDefault()\n      sendMessage()\n    }\n  }\n\n  const formatTime = (date: Date | string | null | undefined) => {\n    try {\n      // Handle null, undefined, or empty values\n      if (!date) {\n        return 'Unknown time'\n      }\n      \n      const dateObj = typeof date === 'string' ? new Date(date) : date\n      \n      // Check if the date is valid\n      if (isNaN(dateObj.getTime())) {\n        return 'Invalid time'\n      }\n      \n      return dateObj.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })\n    } catch (error) {\n      console.error('Error formatting time:', error, 'Input:', date)\n      return 'Invalid time'\n    }\n  }\n\n  const formatDate = (date: Date | string | null | undefined) => {\n    try {\n      // Handle null, undefined, or empty values\n      if (!date) {\n        return 'Unknown date'\n      }\n      \n      const today = new Date()\n      const messageDate = typeof date === 'string' ? new Date(date) : date\n      \n      // Check if the date is valid\n      if (isNaN(messageDate.getTime())) {\n        return 'Invalid date'\n      }\n      \n      if (messageDate.toDateString() === today.toDateString()) {\n        return 'Today'\n      }\n      \n      const yesterday = new Date(today)\n      yesterday.setDate(yesterday.getDate() - 1)\n      \n      if (messageDate.toDateString() === yesterday.toDateString()) {\n        return 'Yesterday'\n      }\n      \n      return messageDate.toLocaleDateString()\n    } catch (error) {\n      console.error('Error formatting date:', error, 'Input:', date)\n      return 'Invalid date'\n    }\n  }\n\n  const groupMessagesByDate = (messages: Message[]) => {\n    const groups: { [date: string]: Message[] } = {}\n    \n    messages.forEach(message => {\n      try {\n        // Skip messages with invalid timestamps\n        if (!message.timestamp) {\n          if (!groups['Unknown Date']) {\n            groups['Unknown Date'] = []\n          }\n          groups['Unknown Date'].push(message)\n          return\n        }\n        \n        // Handle both string and Date timestamps\n        const date = new Date(message.timestamp).toDateString()\n        if (!groups[date]) {\n          groups[date] = []\n        }\n        groups[date].push(message)\n      } catch (error) {\n        console.error('Error grouping message by date:', error, message)\n        // Put invalid dates in a separate group\n        if (!groups['Invalid Date']) {\n          groups['Invalid Date'] = []\n        }\n        groups['Invalid Date'].push(message)\n      }\n    })\n    \n    return groups\n  }\n\n  if (!isOpen) {\n    return null\n  }\n\n  const messageGroups = groupMessagesByDate(messages)\n\n  return (\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50\">\n      <Card className=\"w-full max-w-2xl h-[600px] flex flex-col\">\n        <CardHeader className=\"flex-shrink-0 border-b\">\n          <div className=\"flex items-center justify-between\">\n            <div className=\"flex items-center space-x-3\">\n              <div className=\"flex items-center space-x-2\">\n                <MessageCircle className=\"h-5 w-5 text-blue-600\" />\n                <CardTitle className=\"text-lg\">Inquiry Chat</CardTitle>\n              </div>\n              <Badge variant=\"outline\" className=\"text-xs\">\n                {customerName}\n              </Badge>\n            </div>\n            <Button variant=\"ghost\" size=\"sm\" onClick={toggleChat}>\n              <X className=\"h-4 w-4\" />\n            </Button>\n          </div>\n          <div className=\"text-sm text-gray-600\">\n            <p>Customer: {customerName} ({customerEmail})</p>\n            <p>Inquiry ID: {inquiryId}</p>\n          </div>\n        </CardHeader>\n\n        <CardContent className=\"flex-1 flex flex-col p-0 overflow-hidden\">\n          {/* Messages Area */}\n          <div className=\"flex-1 overflow-y-auto p-4 space-y-4\">\n            {isLoading ? (\n              <div className=\"flex items-center justify-center h-full\">\n                <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n              </div>\n            ) : messages.length === 0 ? (\n              <div className=\"text-center text-gray-500 mt-8\">\n                <MessageCircle className=\"h-12 w-12 mx-auto mb-4 text-gray-400\" />\n                <p>No messages yet. Start the conversation!</p>\n              </div>\n            ) : (\n              Object.entries(messageGroups).map(([date, dateMessages]) => (\n                <div key={date} className=\"space-y-3\">\n                  <div className=\"flex items-center justify-center\">\n                    <div className=\"bg-gray-100 rounded-full px-3 py-1\">\n                      <span className=\"text-xs text-gray-600 font-medium\">\n                        {formatDate(new Date(date))}\n                      </span>\n                    </div>\n                  </div>\n                  \n                  {dateMessages.map((message) => (\n                    <div\n                      key={message.id}\n                      className={`flex ${message.sender === 'admin' ? 'justify-end' : 'justify-start'}`}\n                    >\n                      <div className={`max-w-[70%] ${message.sender === 'admin' ? 'order-2' : 'order-1'}`}>\n                        <div className=\"flex items-center space-x-2 mb-1\">\n                          {message.sender === 'admin' ? (\n                            <div className=\"flex items-center space-x-1 text-xs text-blue-600 font-medium\">\n                              <Shield className=\"h-3 w-3\" />\n                              <span>Admin</span>\n                            </div>\n                          ) : (\n                            <div className=\"flex items-center space-x-1 text-xs text-green-600 font-medium\">\n                              <User className=\"h-3 w-3\" />\n                              <span>{message.senderName || 'Customer'}</span>\n                            </div>\n                          )}\n                          <span className=\"text-xs text-gray-400\">\n                            {formatTime(message.timestamp)}\n                          </span>\n                        </div>\n                        <div\n                          className={`rounded-lg px-4 py-2 ${\n                            message.sender === 'admin'\n                              ? 'bg-blue-600 text-white border border-blue-700'\n                              : 'bg-gray-100 text-gray-900 border border-gray-300'\n                          }`}\n                        >\n                          <p className=\"text-sm whitespace-pre-wrap\">{message.text}</p>\n                        </div>\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              ))\n            )}\n            <div ref={messagesEndRef} />\n          </div>\n\n          {/* Message Input */}\n          <div className=\"border-t p-4\">\n            <div className=\"flex space-x-2\">\n              <Input\n                value={inputText}\n                onChange={(e) => setInputText(e.target.value)}\n                onKeyPress={handleKeyPress}\n                placeholder=\"Type your message...\"\n                disabled={isTyping || !user}\n                className=\"flex-1\"\n              />\n              <Button\n                onClick={sendMessage}\n                disabled={!inputText.trim() || isTyping || !user}\n                size=\"sm\"\n                className=\"bg-blue-600 hover:bg-blue-700\"\n              >\n                <Send className=\"h-4 w-4\" />\n              </Button>\n            </div>\n            {!user && (\n              <p className=\"text-xs text-red-600 mt-2\">You must be logged in to send messages</p>\n            )}\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  )\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AARA;;;;;;;;;AA4Be,SAAS,YAAY,EAClC,SAAS,EACT,UAAU,EACV,YAAY,EACZ,aAAa,EACb,QAAQ,gBAAgB,EACxB,QAAQ,EACR,WAAW,UAAU,EACJ;IACjB,MAAM,EAAE,IAAI,EAAE,GAAG,IAAA,0IAAO;IACxB,MAAM,CAAC,gBAAgB,kBAAkB,GAAG,IAAA,iNAAQ,EAAC;IACrD,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,iNAAQ,EAAY,EAAE;IACtD,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,iNAAQ,EAAC;IAC3C,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,iNAAQ,EAAC;IAC3C,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,iNAAQ,EAAC;IACzC,MAAM,iBAAiB,IAAA,+MAAM,EAAiB;IAE9C,MAAM,eAAe,qBAAqB;IAC1C,MAAM,SAAS,eAAe,mBAAmB;IACjD,MAAM,aAAa,eAAe,WAAW,IAAM,kBAAkB,CAAC;IAEtE,MAAM,iBAAiB;QACrB,eAAe,OAAO,EAAE,eAAe;YAAE,UAAU;QAAS;IAC9D;IAEA,IAAA,kNAAS,EAAC;QACR;IACF,GAAG;QAAC;KAAS;IAEb,IAAA,kNAAS,EAAC;QACR,IAAI,UAAU,WAAW;YACvB;QACF;IACF,GAAG;QAAC;QAAQ;KAAU;IAEtB,MAAM,eAAe;QACnB,IAAI;YACF,aAAa;YAEb,iCAAiC;YACjC,MAAM,EAAE,cAAc,EAAE,GAAG;YAC3B,MAAM,EAAE,MAAM,EAAE,OAAO,EAAE,EAAE,GAAG,MAAM,eAAe,IAAI,CAAC,UAAU;YAElE,IAAI,CAAC,SAAS,cAAc;gBAC1B,QAAQ,KAAK,CAAC;gBACd;YACF;YAEA,sCAAsC;YACtC,MAAM,WAAW,MAAM,MAAM,CAAC,eAAe,EAAE,UAAU,KAAK,CAAC,EAAE;gBAC/D,SAAS;oBACP,iBAAiB,CAAC,OAAO,EAAE,QAAQ,YAAY,EAAE;gBACnD;YACF;YAEA,IAAI,SAAS,EAAE,EAAE;gBACf,MAAM,SAAS,MAAM,SAAS,IAAI;gBAClC,6CAA6C;gBAC7C,MAAM,iBAAiB,CAAC,OAAO,IAAI,IAAI,EAAE,EAAE,GAAG,CAAC,CAAC,MAAa,CAAC;wBAC5D,GAAG,GAAG;wBACN,QAAQ,IAAI,WAAW;wBACvB,MAAM,IAAI,OAAO;wBACjB,WAAW,IAAI,UAAU,CAAC,8BAA8B;oBAC1D,CAAC;gBACD,YAAY;YACd,OAAO;gBACL,MAAM,YAAY,MAAM,SAAS,IAAI;gBACrC,QAAQ,KAAK,CAAC,mBAAmB;gBACjC,mCAAmC;gBACnC,IAAI,SAAS,MAAM,KAAK,KAAK;oBAC3B,QAAQ,KAAK,CAAC;gBAChB;YACF;QACF,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,2BAA2B;QAC3C,SAAU;YACR,aAAa;QACf;IACF;IAEA,MAAM,cAAc;QAClB,IAAI,CAAC,UAAU,IAAI,MAAM,CAAC,MAAM;QAEhC,iDAAiD;QACjD,MAAM,aAAa;QAEnB,MAAM,aAAsB;YAC1B,IAAI,KAAK,GAAG,GAAG,QAAQ;YACvB,MAAM,UAAU,IAAI;YACpB,QAAQ;YACR,WAAW,IAAI;YACf,YAAY,KAAK,KAAK;QACxB;QAEA,IAAI;YACF,YAAY;YACZ,aAAa;YAEb,iCAAiC;YACjC,MAAM,EAAE,cAAc,EAAE,GAAG;YAC3B,MAAM,EAAE,MAAM,EAAE,OAAO,EAAE,EAAE,GAAG,MAAM,eAAe,IAAI,CAAC,UAAU;YAElE,IAAI,CAAC,SAAS,cAAc;gBAC1B,MAAM,IAAI,MAAM;YAClB;YAEA,uBAAuB;YACvB,MAAM,WAAW,MAAM,MAAM,CAAC,eAAe,EAAE,UAAU,KAAK,CAAC,EAAE;gBAC/D,QAAQ;gBACR,SAAS;oBACP,gBAAgB;oBAChB,iBAAiB,CAAC,OAAO,EAAE,QAAQ,YAAY,EAAE;gBACnD;gBACA,MAAM,KAAK,SAAS,CAAC;oBACnB,SAAS,WAAW,IAAI;oBACxB,QAAQ;gBACV;YACF;YAEA,IAAI,SAAS,EAAE,EAAE;gBACf,MAAM,SAAS,MAAM,SAAS,IAAI;gBAClC,oDAAoD;gBACpD,MAAM,gBAAgB;oBACpB,GAAG,OAAO,IAAI;oBACd,QAAQ,OAAO,IAAI,CAAC,WAAW;oBAC/B,MAAM,OAAO,IAAI,CAAC,OAAO;oBACzB,WAAW,OAAO,IAAI,CAAC,UAAU,CAAC,8BAA8B;gBAClE;gBACA,YAAY,CAAA,OAAQ;2BAAI;wBAAM;qBAAc;YAC9C,OAAO;gBACL,MAAM,YAAY,MAAM,SAAS,IAAI;gBACrC,QAAQ,KAAK,CAAC,2BAA2B;gBACzC,MAAM,IAAI,MAAM,UAAU,KAAK,IAAI;YACrC;QACF,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,0BAA0B;YACxC,qCAAqC;YACrC,aAAa,WAAW,IAAI;YAC5B,6BAA6B;YAC7B,MAAM;QACR,SAAU;YACR,YAAY;QACd;IACF;IAEA,MAAM,iBAAiB,CAAC;QACtB,IAAI,EAAE,GAAG,KAAK,WAAW,CAAC,EAAE,QAAQ,EAAE;YACpC,EAAE,cAAc;YAChB;QACF;IACF;IAEA,MAAM,aAAa,CAAC;QAClB,IAAI;YACF,0CAA0C;YAC1C,IAAI,CAAC,MAAM;gBACT,OAAO;YACT;YAEA,MAAM,UAAU,OAAO,SAAS,WAAW,IAAI,KAAK,QAAQ;YAE5D,6BAA6B;YAC7B,IAAI,MAAM,QAAQ,OAAO,KAAK;gBAC5B,OAAO;YACT;YAEA,OAAO,QAAQ,kBAAkB,CAAC,EAAE,EAAE;gBAAE,MAAM;gBAAW,QAAQ;YAAU;QAC7E,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,0BAA0B,OAAO,UAAU;YACzD,OAAO;QACT;IACF;IAEA,MAAM,aAAa,CAAC;QAClB,IAAI;YACF,0CAA0C;YAC1C,IAAI,CAAC,MAAM;gBACT,OAAO;YACT;YAEA,MAAM,QAAQ,IAAI;YAClB,MAAM,cAAc,OAAO,SAAS,WAAW,IAAI,KAAK,QAAQ;YAEhE,6BAA6B;YAC7B,IAAI,MAAM,YAAY,OAAO,KAAK;gBAChC,OAAO;YACT;YAEA,IAAI,YAAY,YAAY,OAAO,MAAM,YAAY,IAAI;gBACvD,OAAO;YACT;YAEA,MAAM,YAAY,IAAI,KAAK;YAC3B,UAAU,OAAO,CAAC,UAAU,OAAO,KAAK;YAExC,IAAI,YAAY,YAAY,OAAO,UAAU,YAAY,IAAI;gBAC3D,OAAO;YACT;YAEA,OAAO,YAAY,kBAAkB;QACvC,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,0BAA0B,OAAO,UAAU;YACzD,OAAO;QACT;IACF;IAEA,MAAM,sBAAsB,CAAC;QAC3B,MAAM,SAAwC,CAAC;QAE/C,SAAS,OAAO,CAAC,CAAA;YACf,IAAI;gBACF,wCAAwC;gBACxC,IAAI,CAAC,QAAQ,SAAS,EAAE;oBACtB,IAAI,CAAC,MAAM,CAAC,eAAe,EAAE;wBAC3B,MAAM,CAAC,eAAe,GAAG,EAAE;oBAC7B;oBACA,MAAM,CAAC,eAAe,CAAC,IAAI,CAAC;oBAC5B;gBACF;gBAEA,yCAAyC;gBACzC,MAAM,OAAO,IAAI,KAAK,QAAQ,SAAS,EAAE,YAAY;gBACrD,IAAI,CAAC,MAAM,CAAC,KAAK,EAAE;oBACjB,MAAM,CAAC,KAAK,GAAG,EAAE;gBACnB;gBACA,MAAM,CAAC,KAAK,CAAC,IAAI,CAAC;YACpB,EAAE,OAAO,OAAO;gBACd,QAAQ,KAAK,CAAC,mCAAmC,OAAO;gBACxD,wCAAwC;gBACxC,IAAI,CAAC,MAAM,CAAC,eAAe,EAAE;oBAC3B,MAAM,CAAC,eAAe,GAAG,EAAE;gBAC7B;gBACA,MAAM,CAAC,eAAe,CAAC,IAAI,CAAC;YAC9B;QACF;QAEA,OAAO;IACT;IAEA,IAAI,CAAC,QAAQ;QACX,OAAO;IACT;IAEA,MAAM,gBAAgB,oBAAoB;IAE1C,qBACE,8OAAC;QAAI,WAAU;kBACb,cAAA,8OAAC,wIAAI;YAAC,WAAU;;8BACd,8OAAC,8IAAU;oBAAC,WAAU;;sCACpB,8OAAC;4BAAI,WAAU;;8CACb,8OAAC;oCAAI,WAAU;;sDACb,8OAAC;4CAAI,WAAU;;8DACb,8OAAC,yOAAa;oDAAC,WAAU;;;;;;8DACzB,8OAAC,6IAAS;oDAAC,WAAU;8DAAU;;;;;;;;;;;;sDAEjC,8OAAC,0IAAK;4CAAC,SAAQ;4CAAU,WAAU;sDAChC;;;;;;;;;;;;8CAGL,8OAAC,4IAAM;oCAAC,SAAQ;oCAAQ,MAAK;oCAAK,SAAS;8CACzC,cAAA,8OAAC,iMAAC;wCAAC,WAAU;;;;;;;;;;;;;;;;;sCAGjB,8OAAC;4BAAI,WAAU;;8CACb,8OAAC;;wCAAE;wCAAW;wCAAa;wCAAG;wCAAc;;;;;;;8CAC5C,8OAAC;;wCAAE;wCAAa;;;;;;;;;;;;;;;;;;;8BAIpB,8OAAC,+IAAW;oBAAC,WAAU;;sCAErB,8OAAC;4BAAI,WAAU;;gCACZ,0BACC,8OAAC;oCAAI,WAAU;8CACb,cAAA,8OAAC;wCAAI,WAAU;;;;;;;;;;2CAEf,SAAS,MAAM,KAAK,kBACtB,8OAAC;oCAAI,WAAU;;sDACb,8OAAC,yOAAa;4CAAC,WAAU;;;;;;sDACzB,8OAAC;sDAAE;;;;;;;;;;;2CAGL,OAAO,OAAO,CAAC,eAAe,GAAG,CAAC,CAAC,CAAC,MAAM,aAAa,iBACrD,8OAAC;wCAAe,WAAU;;0DACxB,8OAAC;gDAAI,WAAU;0DACb,cAAA,8OAAC;oDAAI,WAAU;8DACb,cAAA,8OAAC;wDAAK,WAAU;kEACb,WAAW,IAAI,KAAK;;;;;;;;;;;;;;;;4CAK1B,aAAa,GAAG,CAAC,CAAC,wBACjB,8OAAC;oDAEC,WAAW,CAAC,KAAK,EAAE,QAAQ,MAAM,KAAK,UAAU,gBAAgB,iBAAiB;8DAEjF,cAAA,8OAAC;wDAAI,WAAW,CAAC,YAAY,EAAE,QAAQ,MAAM,KAAK,UAAU,YAAY,WAAW;;0EACjF,8OAAC;gEAAI,WAAU;;oEACZ,QAAQ,MAAM,KAAK,wBAClB,8OAAC;wEAAI,WAAU;;0FACb,8OAAC,gNAAM;gFAAC,WAAU;;;;;;0FAClB,8OAAC;0FAAK;;;;;;;;;;;6FAGR,8OAAC;wEAAI,WAAU;;0FACb,8OAAC,0MAAI;gFAAC,WAAU;;;;;;0FAChB,8OAAC;0FAAM,QAAQ,UAAU,IAAI;;;;;;;;;;;;kFAGjC,8OAAC;wEAAK,WAAU;kFACb,WAAW,QAAQ,SAAS;;;;;;;;;;;;0EAGjC,8OAAC;gEACC,WAAW,CAAC,qBAAqB,EAC/B,QAAQ,MAAM,KAAK,UACf,kDACA,oDACJ;0EAEF,cAAA,8OAAC;oEAAE,WAAU;8EAA+B,QAAQ,IAAI;;;;;;;;;;;;;;;;;mDA3BvD,QAAQ,EAAE;;;;;;uCAXX;;;;;8CA8Cd,8OAAC;oCAAI,KAAK;;;;;;;;;;;;sCAIZ,8OAAC;4BAAI,WAAU;;8CACb,8OAAC;oCAAI,WAAU;;sDACb,8OAAC,0IAAK;4CACJ,OAAO;4CACP,UAAU,CAAC,IAAM,aAAa,EAAE,MAAM,CAAC,KAAK;4CAC5C,YAAY;4CACZ,aAAY;4CACZ,UAAU,YAAY,CAAC;4CACvB,WAAU;;;;;;sDAEZ,8OAAC,4IAAM;4CACL,SAAS;4CACT,UAAU,CAAC,UAAU,IAAI,MAAM,YAAY,CAAC;4CAC5C,MAAK;4CACL,WAAU;sDAEV,cAAA,8OAAC,0MAAI;gDAAC,WAAU;;;;;;;;;;;;;;;;;gCAGnB,CAAC,sBACA,8OAAC;oCAAE,WAAU;8CAA4B;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAOvD"}},
    {"offset": {"line": 637, "column": 0}, "map": {"version":3,"sources":["file:///D:/Apps/IkazeProperty.rw/src/app/%5Blocale%5D/dashboard/user/page.tsx"],"sourcesContent":["'use client'\n\nimport { useState, useEffect } from 'react'\nimport Link from 'next/link'\nimport { \n  Home, \n  Car, \n  Trees, \n  Package, \n  MessageSquare, \n  DollarSign, \n  Heart,\n  Eye,\n  Plus,\n  TrendingUp,\n  Clock,\n  CheckCircle,\n  AlertCircle\n} from 'lucide-react'\nimport { Button } from '@/components/ui/button'\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card'\nimport { supabase } from '@/lib/auth'\nimport { getCurrentUser } from '@/lib/auth'\nimport InquiryChat from '@/components/chat/InquiryChat'\n\nexport default function UserDashboard() {\n  const [user, setUser] = useState<any>(null)\n  const [stats, setStats] = useState({\n    myListings: 0,\n    myInquiries: 0,\n    myFavorites: 0,\n    completedTransactions: 0,\n    totalSpent: 0,\n    totalEarned: 0\n  })\n  const [myListings, setMyListings] = useState([])\n  const [myInquiries, setMyInquiries] = useState([])\n  const [loading, setLoading] = useState(true)\n  const [chatStates, setChatStates] = useState<{ [key: string]: boolean }>({})\n\n  useEffect(() => {\n    fetchUserData()\n  }, [])\n\n  const fetchUserData = async () => {\n    try {\n      // Get current user\n      const currentUser = await getCurrentUser()\n      if (!currentUser) {\n        console.log('No user authenticated, redirecting to login')\n        window.location.href = '/auth/login'\n        return\n      }\n\n      // Get user profile with error handling\n      try {\n        const { data: userProfile } = await supabase\n          .from('users')\n          .select('*')\n          .eq('id', currentUser.id)\n          .single()\n        \n        setUser(userProfile)\n      } catch (profileError) {\n        console.log('User profile not found, using current user data')\n        setUser({\n          id: currentUser.id,\n          email: currentUser.email,\n          full_name: currentUser.user_metadata?.full_name || 'User'\n        })\n      }\n\n      // Fetch user's listings with error handling\n      try {\n        const { data: listings } = await supabase\n          .from('listings')\n          .select('*')\n          .eq('seller_id', currentUser.id)\n          .order('created_at', { ascending: false })\n          .limit(5)\n\n        setMyListings(listings || [])\n      } catch (listingsError) {\n        console.log('Error fetching listings:', listingsError)\n        setMyListings([])\n      }\n\n      // Fetch user's inquiries with error handling\n      try {\n        const { data: inquiries } = await supabase\n          .from('inquiries')\n          .select(`\n            *,\n            listings(id, title, category, price),\n            seller:users!inquiries_seller_id_fkey(email, full_name)\n          `)\n          .eq('buyer_id', currentUser.id)\n          .order('created_at', { ascending: false })\n          .limit(5)\n\n        setMyInquiries(inquiries || [])\n      } catch (inquiriesError) {\n        console.log('Error fetching inquiries:', inquiriesError)\n        setMyInquiries([])\n      }\n\n      // Calculate stats\n      const [\n        listingsCount,\n        inquiriesCount,\n        favoritesCount,\n        transactionsAsBuyer,\n        transactionsAsSeller\n      ] = await Promise.all([\n        supabase.from('listings').select('id', { count: 'exact', head: true }).eq('seller_id', currentUser.id),\n        supabase.from('inquiries').select('id', { count: 'exact', head: true }).eq('buyer_id', currentUser.id),\n        supabase.from('favorite_listings').select('id', { count: 'exact', head: true }).eq('user_id', currentUser.id),\n        supabase.from('transactions').select('amount').eq('buyer_id', currentUser.id).eq('status', 'completed'),\n        supabase.from('transactions').select('amount, commission_amount').eq('seller_id', currentUser.id).eq('status', 'completed')\n      ])\n\n      const totalSpent = transactionsAsBuyer.data?.reduce((sum: number, t: any) => sum + t.amount, 0) || 0\n      const totalEarned = transactionsAsSeller.data?.reduce((sum: number, t: any) => sum + (t.amount - t.commission_amount), 0) || 0\n\n      setStats({\n        myListings: listingsCount.count || 0,\n        myInquiries: inquiriesCount.count || 0,\n        myFavorites: favoritesCount.count || 0,\n        completedTransactions: (transactionsAsBuyer.count || 0) + (transactionsAsSeller.count || 0),\n        totalSpent,\n        totalEarned\n      })\n    } catch (error) {\n      console.error('Error fetching user data:', error)\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const getCategoryIcon = (category: string) => {\n    switch (category) {\n      case 'houses': return <Home className=\"h-4 w-4\" />\n      case 'cars': return <Car className=\"h-4 w-4\" />\n      case 'land': return <Trees className=\"h-4 w-4\" />\n      case 'other': return <Package className=\"h-4 w-4\" />\n      default: return <Package className=\"h-4 w-4\" />\n    }\n  }\n\n  const getStatusColor = (status: string) => {\n    switch (status) {\n      case 'pending': return 'bg-yellow-100 text-yellow-800'\n      case 'approved': return 'bg-green-100 text-green-800'\n      case 'rejected': return 'bg-red-100 text-red-800'\n      case 'connected': return 'bg-blue-100 text-blue-800'\n      default: return 'bg-gray-100 text-gray-800'\n    }\n  }\n\n  const toggleChat = (inquiryId: string) => {\n    setChatStates(prev => ({\n      ...prev,\n      [inquiryId]: !prev[inquiryId]\n    }))\n  }\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center h-96\">\n        <div className=\"text-center\">\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-red-600 mx-auto\"></div>\n          <p className=\"mt-4 text-gray-600\">Loading dashboard...</p>\n        </div>\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"p-6\">\n      {/* Header */}\n      <div className=\"bg-white border-b border-gray-200 -mx-6 px-6 py-6 mb-6\">\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <h1 className=\"text-3xl font-bold text-gray-900\">\n              Welcome back, {user?.full_name || 'User'}!\n            </h1>\n            <p className=\"text-gray-600 mt-1\">Manage your listings and inquiries</p>\n          </div>\n          <Link href=\"/create-listing\">\n            <Button className=\"bg-red-600 hover:bg-red-700\">\n              <Plus className=\"h-4 w-4 mr-2\" />\n              New Listing\n            </Button>\n          </Link>\n        </div>\n      </div>\n\n      {/* Stats Grid */}\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8\">\n          <Card>\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center\">\n                <div className=\"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center\">\n                  <Home className=\"h-4 w-4 text-blue-600\" />\n                </div>\n                <div className=\"ml-4\">\n                  <p className=\"text-sm font-medium text-gray-600\">My Listings</p>\n                  <p className=\"text-2xl font-bold text-gray-900\">{stats.myListings}</p>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center\">\n                <div className=\"w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center\">\n                  <MessageSquare className=\"h-4 w-4 text-green-600\" />\n                </div>\n                <div className=\"ml-4\">\n                  <p className=\"text-sm font-medium text-gray-600\">My Inquiries</p>\n                  <p className=\"text-2xl font-bold text-gray-900\">{stats.myInquiries}</p>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center\">\n                <div className=\"w-8 h-8 bg-red-100 rounded-lg flex items-center justify-center\">\n                  <Heart className=\"h-4 w-4 text-red-600\" />\n                </div>\n                <div className=\"ml-4\">\n                  <p className=\"text-sm font-medium text-gray-600\">Favorites</p>\n                  <p className=\"text-2xl font-bold text-gray-900\">{stats.myFavorites}</p>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center\">\n                <div className=\"w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center\">\n                  <CheckCircle className=\"h-4 w-4 text-purple-600\" />\n                </div>\n                <div className=\"ml-4\">\n                  <p className=\"text-sm font-medium text-gray-600\">Transactions</p>\n                  <p className=\"text-2xl font-bold text-gray-900\">{stats.completedTransactions}</p>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center\">\n                <div className=\"w-8 h-8 bg-yellow-100 rounded-lg flex items-center justify-center\">\n                  <TrendingUp className=\"h-4 w-4 text-yellow-600\" />\n                </div>\n                <div className=\"ml-4\">\n                  <p className=\"text-sm font-medium text-gray-600\">Total Spent</p>\n                  <p className=\"text-2xl font-bold text-gray-900\">\n                    RWF {stats.totalSpent.toLocaleString()}\n                  </p>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center\">\n                <div className=\"w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center\">\n                  <DollarSign className=\"h-4 w-4 text-green-600\" />\n                </div>\n                <div className=\"ml-4\">\n                  <p className=\"text-sm font-medium text-gray-600\">Total Earned</p>\n                  <p className=\"text-2xl font-bold text-gray-900\">\n                    RWF {stats.totalEarned.toLocaleString()}\n                  </p>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n\n        <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-8\">\n          {/* My Listings */}\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"flex items-center justify-between\">\n                <div className=\"flex items-center\">\n                  <Home className=\"h-5 w-5 mr-2 text-blue-600\" />\n                  My Listings\n                </div>\n                <Link href=\"/dashboard/my-listings\">\n                  <Button size=\"sm\" variant=\"outline\">\n                    View All\n                  </Button>\n                </Link>\n              </CardTitle>\n            </CardHeader>\n            <CardContent>\n              {myListings.length === 0 ? (\n                <div className=\"text-center py-8\">\n                  <Home className=\"h-12 w-12 text-gray-400 mx-auto mb-4\" />\n                  <h3 className=\"text-lg font-medium text-gray-900 mb-2\">No listings yet</h3>\n                  <p className=\"text-gray-600 mb-4\">Start by creating your first listing</p>\n                  <Link href=\"/create-listing\">\n                    <Button className=\"bg-red-600 hover:bg-red-700\">\n                      <Plus className=\"h-4 w-4 mr-2\" />\n                      Create Listing\n                    </Button>\n                  </Link>\n                </div>\n              ) : (\n                <div className=\"space-y-4\">\n                  {myListings.map((listing: any) => (\n                    <div key={listing.id} className=\"border border-gray-200 rounded-lg p-4\">\n                      <div className=\"flex items-start justify-between\">\n                        <div className=\"flex-1\">\n                          <div className=\"flex items-center mb-1\">\n                            {getCategoryIcon(listing.category)}\n                            <span className=\"ml-2 font-medium text-gray-900\">\n                              {listing.title}\n                            </span>\n                          </div>\n                          <p className=\"text-lg font-bold text-red-600 mb-1\">\n                            RWF {listing.price.toLocaleString()}\n                          </p>\n                          <div className=\"flex items-center space-x-4 text-sm text-gray-600\">\n                            <span className=\"flex items-center\">\n                              <Eye className=\"h-4 w-4 mr-1\" />\n                              {listing.views || 0}\n                            </span>\n                            <span className=\"flex items-center\">\n                              <Heart className=\"h-4 w-4 mr-1\" />\n                              {listing.likes || 0}\n                            </span>\n                          </div>\n                          <p className=\"text-xs text-gray-500 mt-2\">\n                            {new Date(listing.created_at).toLocaleDateString()}\n                          </p>\n                        </div>\n                        <div className=\"ml-4\">\n                          <span className={`px-2 py-1 text-xs rounded-full ${\n                            listing.status === 'available' \n                              ? 'bg-green-100 text-green-800'\n                              : 'bg-gray-100 text-gray-800'\n                          }`}>\n                            {listing.status}\n                          </span>\n                        </div>\n                      </div>\n                      <div className=\"flex space-x-2 mt-3\">\n                        <Link href={`/listings/${listing.category}/${listing.id}`}>\n                          <Button size=\"sm\" variant=\"outline\">\n                            <Eye className=\"h-4 w-4 mr-1\" />\n                            View\n                          </Button>\n                        </Link>\n                        <Link href={`/dashboard/my-listings/${listing.id}/edit`}>\n                          <Button size=\"sm\" variant=\"outline\">\n                            Edit\n                          </Button>\n                        </Link>\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              )}\n            </CardContent>\n          </Card>\n\n          {/* My Inquiries */}\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"flex items-center justify-between\">\n                <div className=\"flex items-center\">\n                  <MessageSquare className=\"h-5 w-5 mr-2 text-green-600\" />\n                  My Inquiries\n                </div>\n                <Link href=\"/dashboard/my-inquiries\">\n                  <Button size=\"sm\" variant=\"outline\">\n                    View All\n                  </Button>\n                </Link>\n              </CardTitle>\n            </CardHeader>\n            <CardContent>\n              {myInquiries.length === 0 ? (\n                <div className=\"text-center py-8\">\n                  <MessageSquare className=\"h-12 w-12 text-gray-400 mx-auto mb-4\" />\n                  <h3 className=\"text-lg font-medium text-gray-900 mb-2\">No inquiries yet</h3>\n                  <p className=\"text-gray-600 mb-4\">Browse listings and make inquiries</p>\n                  <Link href=\"/listings\">\n                    <Button variant=\"outline\" className=\"border-red-600 text-red-600 hover:bg-red-50\">\n                      Browse Listings\n                    </Button>\n                  </Link>\n                </div>\n              ) : (\n                <div className=\"space-y-4\">\n                  {myInquiries.map((inquiry: any) => (\n                    <div key={inquiry.id} className=\"border border-gray-200 rounded-lg p-4\">\n                      <div className=\"flex items-start justify-between\">\n                        <div className=\"flex-1\">\n                          <div className=\"flex items-center mb-1\">\n                            {getCategoryIcon(inquiry.listings.category)}\n                            <span className=\"ml-2 font-medium text-gray-900\">\n                              {inquiry.listings.title}\n                            </span>\n                          </div>\n                          <p className=\"text-sm text-gray-600 mb-1\">\n                            <strong>Seller:</strong> {inquiry.seller.full_name || inquiry.seller.email}\n                          </p>\n                          <p className=\"text-sm text-gray-700 mb-2\">{inquiry.message}</p>\n                          <p className=\"text-xs text-gray-500\">\n                            {new Date(inquiry.created_at).toLocaleDateString()}\n                          </p>\n                        </div>\n                        <div className=\"ml-4\">\n                          <span className={`px-2 py-1 text-xs rounded-full ${getStatusColor(inquiry.status)}`}>\n                            {inquiry.status}\n                          </span>\n                        </div>\n                      </div>\n                      <div className=\"flex space-x-2 mt-3\">\n                        {inquiry.listings && inquiry.listings.id ? (\n                          <Link href={`/listings/${inquiry.listings.category}/${inquiry.listings.id}`}>\n                            <Button size=\"sm\" variant=\"outline\">\n                              <Eye className=\"h-4 w-4 mr-1\" />\n                              View Listing\n                            </Button>\n                          </Link>\n                        ) : (\n                          <Button size=\"sm\" variant=\"outline\" disabled>\n                            <Eye className=\"h-4 w-4 mr-1\" />\n                            View Listing\n                          </Button>\n                        )}\n                        {inquiry.status === 'approved' && (\n                          <Button \n                            size=\"sm\" \n                            className=\"bg-green-600 hover:bg-green-700\"\n                            onClick={() => toggleChat(inquiry.id)}\n                          >\n                            <MessageSquare className=\"h-4 w-4 mr-1\" />\n                            Contact Seller\n                          </Button>\n                        )}\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              )}\n            </CardContent>\n          </Card>\n        </div>\n        \n        {/* Chat Components */}\n        {myInquiries.map((inquiry: any) => (\n          <InquiryChat\n            key={inquiry.id}\n            inquiryId={inquiry.id}\n            customerId={inquiry.buyer_id}\n            customerName={user?.full_name || 'User'}\n            customerEmail={user?.email || ''}\n            isOpen={chatStates[inquiry.id] || false}\n            onToggle={() => toggleChat(inquiry.id)}\n            userType=\"customer\"\n          />\n        ))}\n    </div>\n  )\n}\n"],"names":[],"mappings":"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"}}]
}