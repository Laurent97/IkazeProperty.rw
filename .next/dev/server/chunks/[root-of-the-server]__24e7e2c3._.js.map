{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///D:/Apps/IkazeProperty.rw/src/app/api/auth/create-profile/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server'\nimport { createClient } from '@supabase/supabase-js'\nimport { Database } from '@/types/database'\n\nexport async function POST(request: NextRequest) {\n  try {\n    const { id, email, full_name, role } = await request.json()\n\n    if (!id || !email) {\n      return NextResponse.json(\n        { error: 'Missing required fields' },\n        { status: 400 }\n      )\n    }\n\n    // Create admin client with service role key to bypass RLS\n    const supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL!\n    const supabaseServiceKey = process.env.SUPABASE_SERVICE_ROLE_KEY!\n    \n    const adminClient = createClient<Database>(supabaseUrl, supabaseServiceKey, {\n      auth: {\n        autoRefreshToken: false,\n        persistSession: false\n      }\n    })\n    \n    // Create user profile in database using service role (bypasses RLS)\n    const { error: profileError } = await (adminClient as any)\n      .from('users')\n      .insert({\n        id,\n        email,\n        full_name,\n        role: role || 'user'\n      })\n\n    if (profileError) {\n      console.error('Profile creation error:', profileError)\n      return NextResponse.json(\n        { error: profileError.message },\n        { status: 500 }\n      )\n    }\n\n    return NextResponse.json({\n      success: true,\n      message: 'Profile created successfully'\n    })\n\n  } catch (error) {\n    console.error('Profile creation error:', error)\n    return NextResponse.json(\n      { error: 'Internal server error' },\n      { status: 500 }\n    )\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAGO,eAAe,KAAK,OAAoB;IAC7C,IAAI;QACF,MAAM,EAAE,EAAE,EAAE,KAAK,EAAE,SAAS,EAAE,IAAI,EAAE,GAAG,MAAM,QAAQ,IAAI;QAEzD,IAAI,CAAC,MAAM,CAAC,OAAO;YACjB,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAA0B,GACnC;gBAAE,QAAQ;YAAI;QAElB;QAEA,0DAA0D;QAC1D,MAAM;QACN,MAAM,qBAAqB,QAAQ,GAAG,CAAC,yBAAyB;QAEhE,MAAM,cAAc,IAAA,gMAAY,EAAW,aAAa,oBAAoB;YAC1E,MAAM;gBACJ,kBAAkB;gBAClB,gBAAgB;YAClB;QACF;QAEA,oEAAoE;QACpE,MAAM,EAAE,OAAO,YAAY,EAAE,GAAG,MAAM,AAAC,YACpC,IAAI,CAAC,SACL,MAAM,CAAC;YACN;YACA;YACA;YACA,MAAM,QAAQ;QAChB;QAEF,IAAI,cAAc;YAChB,QAAQ,KAAK,CAAC,2BAA2B;YACzC,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO,aAAa,OAAO;YAAC,GAC9B;gBAAE,QAAQ;YAAI;QAElB;QAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;YACvB,SAAS;YACT,SAAS;QACX;IAEF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,2BAA2B;QACzC,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAAwB,GACjC;YAAE,QAAQ;QAAI;IAElB;AACF"}}]
}